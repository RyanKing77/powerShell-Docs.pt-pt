---
title: Importar um módulo do PowerShell | Documentos da Microsoft
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 697791b3-2135-4a39-b9d7-8566ed67acf2
caps.latest.revision: 13
ms.openlocfilehash: bb5d036e5658c365a4fafa2cac05c0bba9f87019
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 02/03/2019
ms.locfileid: "56845452"
---
# <a name="importing-a-powershell-module"></a><span data-ttu-id="d0739-102">Importing a PowerShell Module (Importar um Módulo do PowerShell)</span><span class="sxs-lookup"><span data-stu-id="d0739-102">Importing a PowerShell Module</span></span>

<span data-ttu-id="d0739-103">Uma vez o tiver instalado um módulo num sistema, provavelmente desejará importar o módulo.</span><span class="sxs-lookup"><span data-stu-id="d0739-103">Once your have installed a module on a system, you will likely want to import the module.</span></span> <span data-ttu-id="d0739-104">A importação é o processo que carrega o módulo na memória do Active Directory, para que um usuário pode acessar esse módulo na sua sessão do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d0739-104">Importing is the process that loads the module into active memory, so that a user can access that module in their PowerShell session.</span></span> <span data-ttu-id="d0739-105">No PowerShell 2.0, pode importar um módulo do PowerShell instalado recentemente com uma chamada para [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="d0739-105">In PowerShell 2.0, you can import a newly-installed PowerShell module with a call to [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet.</span></span> <span data-ttu-id="d0739-106">No PowerShell 3.0, o PowerShell é capaz de importar implicitamente um módulo quando uma das funções ou cmdlets no módulo é chamada por um utilizador.</span><span class="sxs-lookup"><span data-stu-id="d0739-106">In PowerShell 3.0, PowerShell is able to implicitly import a module when one of the functions or cmdlets in the module is called by a user.</span></span> <span data-ttu-id="d0739-107">Tenha em atenção que as duas versões partem do princípio de que instale o módulo num local em que o PowerShell é capaz de encontrá-lo. Para obter mais informações, consulte [instalar um módulo do PowerShell](./installing-a-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="d0739-107">Note that both versions assume that you install your module in a location where PowerShell is able to find it; for more information, see [Installing a PowerShell Module](./installing-a-powershell-module.md).</span></span> <span data-ttu-id="d0739-108">Pode utilizar um manifesto de módulo para restringir que partes do seu módulo são exportadas, e pode usar parâmetros do `Import-Module` chamada para restringir que partes são importados.</span><span class="sxs-lookup"><span data-stu-id="d0739-108">You can use a module manifest to restrict what parts of your module are exported, and you can use parameters of the `Import-Module` call to restrict what parts are imported.</span></span>

## <a name="importing-a-snap-in-powershell-10"></a><span data-ttu-id="d0739-109">Importação de um Snap-In (PowerShell 1.0)</span><span class="sxs-lookup"><span data-stu-id="d0739-109">Importing a Snap-In (PowerShell 1.0)</span></span>

<span data-ttu-id="d0739-110">Módulos não existia no PowerShell 1.0: em vez disso, tinha que registar e utilizar o snap-ins. No entanto, não é recomendado que utilize essa tecnologia neste momento, como módulos são geralmente mais fáceis de instalar e importar.</span><span class="sxs-lookup"><span data-stu-id="d0739-110">Modules did not exist in PowerShell 1.0: instead, you had to register and use snap-ins. However, it is not recommended that you use this technology at this point, as modules are generally easier to install and import.</span></span> <span data-ttu-id="d0739-111">Para obter mais informações, consulte [como criar um Snap-in do PowerShell Windows](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span><span class="sxs-lookup"><span data-stu-id="d0739-111">For more information, see [How to Create a Windows PowerShell Snap-in](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span></span>

## <a name="importing-a-module-with-import-module-powershell-20"></a><span data-ttu-id="d0739-112">Importar um módulo com Import-Module (PowerShell 2.0)</span><span class="sxs-lookup"><span data-stu-id="d0739-112">Importing a Module with Import-Module (PowerShell 2.0)</span></span>

<span data-ttu-id="d0739-113">PowerShell 2.0 usa o adequadamente nomeados [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet para importar módulos.</span><span class="sxs-lookup"><span data-stu-id="d0739-113">PowerShell 2.0 uses the appropriately-named [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to import modules.</span></span> <span data-ttu-id="d0739-114">Quando este cmdlet é executado, o Windows PowerShell procura o módulo especificado em diretórios especificados no `PSModulePath` variável.</span><span class="sxs-lookup"><span data-stu-id="d0739-114">When this cmdlet is run, Windows PowerShell searches for the specified module within the directories specified in the `PSModulePath` variable.</span></span> <span data-ttu-id="d0739-115">Quando é encontrado no diretório especificado, o Windows PowerShell procura ficheiros pela seguinte ordem: os ficheiros de manifesto de módulo (. psd1), ficheiros de módulo (. psm1), ficheiros de módulo binário (. dll) do script.</span><span class="sxs-lookup"><span data-stu-id="d0739-115">When the specified directory is found, Windows PowerShell searches for files in the following order: module manifest files (.psd1), script module files (.psm1), binary module files (.dll).</span></span> <span data-ttu-id="d0739-116">Para obter mais informações sobre como adicionar diretórios para a pesquisa, consulte [modificar o caminho de instalação PSModulePath](./modifying-the-psmodulepath-installation-path.md).</span><span class="sxs-lookup"><span data-stu-id="d0739-116">For more information about adding directories to the search, see [Modifying the PSModulePath Installation Path](./modifying-the-psmodulepath-installation-path.md).</span></span> <span data-ttu-id="d0739-117">O código a seguir descreve como importar um módulo:</span><span class="sxs-lookup"><span data-stu-id="d0739-117">The following code describes how to import a module:</span></span>

```powershell
Import-Module myModule
```

<span data-ttu-id="d0739-118">Supondo que myModule encontrava-se no `PSModulePath`, PowerShell carrega myModule na memória do Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d0739-118">Assuming that myModule was located in the `PSModulePath`, PowerShell would load myModule into active memory.</span></span> <span data-ttu-id="d0739-119">Se myModule não foi localizado num `PSModulePath` caminho, pode ainda explicitamente dizer ao PowerShell onde encontrá-lo:</span><span class="sxs-lookup"><span data-stu-id="d0739-119">If myModule was not located on a `PSModulePath` path, you could still explicitly tell PowerShell where to find it:</span></span>

```powershell
Import-Module -Name C:\myRandomDirectory\myModule -Verbose
```

<span data-ttu-id="d0739-120">Também pode utilizar o opção - verboso parâmetro para identificar o que está a ser exportado fora o módulo e o que está a ser importado para a memória do Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d0739-120">You can also use the -verbose parameter to identify what is being exported out of the module, and what is being imported into active memory.</span></span> <span data-ttu-id="d0739-121">Exportações e importações de restringem o que é exposto ao utilizador: a diferença é que controla a visibilidade.</span><span class="sxs-lookup"><span data-stu-id="d0739-121">Both exports and imports restrict what is exposed to the user: the difference is who is controlling the visibility.</span></span> <span data-ttu-id="d0739-122">Essencialmente, exportações são controladas por código dentro do módulo.</span><span class="sxs-lookup"><span data-stu-id="d0739-122">Essentially, exports are controlled by code within the module.</span></span> <span data-ttu-id="d0739-123">Por outro lado, imports são controladas mediante a `Import-Module` chamar.</span><span class="sxs-lookup"><span data-stu-id="d0739-123">In contrast, imports are controlled by the `Import-Module` call.</span></span> <span data-ttu-id="d0739-124">Para obter mais informações, consulte **restringir os membros que são importados**, abaixo.</span><span class="sxs-lookup"><span data-stu-id="d0739-124">For more information, see **Restricting Members That Are Imported**, below.</span></span>

## <a name="implicitly-importing-a-module-powershell-30"></a><span data-ttu-id="d0739-125">Implicitamente importar um módulo (PowerShell 3.0)</span><span class="sxs-lookup"><span data-stu-id="d0739-125">Implicitly Importing a Module (PowerShell 3.0)</span></span>

<span data-ttu-id="d0739-126">A partir do Windows PowerShell 3.0, os módulos são importados automaticamente quando qualquer cmdlet ou uma função no módulo é utilizada num comando.</span><span class="sxs-lookup"><span data-stu-id="d0739-126">Beginning in Windows PowerShell 3.0, modules are imported automatically when any cmdlet or function in the module is used in a command.</span></span> <span data-ttu-id="d0739-127">Esta funcionalidade funciona em qualquer módulo num diretório que isso incluídos no valor dos **PSModulePath** variável de ambiente.</span><span class="sxs-lookup"><span data-stu-id="d0739-127">This feature works on any module in a directory that this included in the value of the **PSModulePath** environment variable.</span></span> <span data-ttu-id="d0739-128">Se não salvar seu módulo num caminho válido no entanto, pode ainda carregá-las usando o explícita [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) opção, descrita acima.</span><span class="sxs-lookup"><span data-stu-id="d0739-128">If you do not save your module on a valid path however, you can still load them using the explicit [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) option, described above.</span></span>

<span data-ttu-id="d0739-129">As seguintes ações acionam a importação automática de um módulo, também conhecido como "módulo de carregamento automático."</span><span class="sxs-lookup"><span data-stu-id="d0739-129">The following actions trigger automatic importing of a module, also known as "module auto-loading."</span></span>

- <span data-ttu-id="d0739-130">Utilizando um cmdlet num comando.</span><span class="sxs-lookup"><span data-stu-id="d0739-130">Using a cmdlet in a command.</span></span> <span data-ttu-id="d0739-131">Por exemplo, se escrever `Get-ExecutionPolicy` importa o módulo de Microsoft.PowerShell.Security que contém o `Get-ExecutionPolicy` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="d0739-131">For example, typing `Get-ExecutionPolicy` imports the Microsoft.PowerShell.Security module that contains the `Get-ExecutionPolicy` cmdlet.</span></span>

- <span data-ttu-id="d0739-132">Utilizar o [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet para obter o comando.</span><span class="sxs-lookup"><span data-stu-id="d0739-132">Using the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet to get the command.</span></span>  <span data-ttu-id="d0739-133">Por exemplo, se escrever `Get-Command Get-JobTrigger` importa os **PSScheduledJob** módulo que contém o `Get-JobTrigger` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="d0739-133">For example, typing `Get-Command Get-JobTrigger` imports the **PSScheduledJob** module that contains the `Get-JobTrigger` cmdlet.</span></span> <span data-ttu-id="d0739-134">A `Get-Command` comando que inclui carateres universais é considerado como estando a deteção e não aciona a importação de um módulo.</span><span class="sxs-lookup"><span data-stu-id="d0739-134">A `Get-Command` command that includes wildcard characters is considered to be discovery and does not trigger importing of a module.</span></span>

- <span data-ttu-id="d0739-135">Utilizar o [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet para obter ajuda para um cmdlet.</span><span class="sxs-lookup"><span data-stu-id="d0739-135">Using the [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet to get help for a cmdlet.</span></span> <span data-ttu-id="d0739-136">Por exemplo, se escrever `Get-Help Get-WinEvent` importa o módulo de Microsoft.PowerShell.Diagnostics que contém o `Get-WinEvent` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="d0739-136">For example, typing `Get-Help Get-WinEvent` imports the Microsoft.PowerShell.Diagnostics module that contains the `Get-WinEvent` cmdlet.</span></span>

<span data-ttu-id="d0739-137">Para suportar a importação automática de módulos, o `Get-Command` cmdlet obtém todos os cmdlets e funções em todos os módulos instalados, mesmo que o módulo não é importado para a sessão.</span><span class="sxs-lookup"><span data-stu-id="d0739-137">To support automatic importing of modules, the `Get-Command` cmdlet gets all cmdlets and functions in all installed modules, even if the module is not imported into the session.</span></span> <span data-ttu-id="d0739-138">Para obter mais informações, consulte o tópico de ajuda para o [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="d0739-138">For more information, see the help topic for the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet.</span></span>

## <a name="the-importing-process"></a><span data-ttu-id="d0739-139">O processo de importação</span><span class="sxs-lookup"><span data-stu-id="d0739-139">The Importing Process</span></span>

<span data-ttu-id="d0739-140">Quando um módulo é importado, um Estado de sessão novo é criado para o módulo e um [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) objeto é criado na memória.</span><span class="sxs-lookup"><span data-stu-id="d0739-140">When a module is imported, a new session state is created for the module, and a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object is created in memory.</span></span> <span data-ttu-id="d0739-141">Um Estado de sessão é criado para cada módulo que é importado (Isto inclui o módulo de raiz e quaisquer módulos aninhados).</span><span class="sxs-lookup"><span data-stu-id="d0739-141">A session-state is created for each module that is imported (this includes the root module and any nested modules).</span></span> <span data-ttu-id="d0739-142">Os membros que são exportados a partir do módulo de raiz, incluindo quaisquer membros que foram exportados para o módulo de raiz por quaisquer módulos aninhados, em seguida, são importados para o estado da sessão do chamador.</span><span class="sxs-lookup"><span data-stu-id="d0739-142">The members that are exported from the root module, including any members that were exported to the root module by any nested modules, are then imported into the caller's session state.</span></span>

<span data-ttu-id="d0739-143">Os metadados de membros que são exportados a partir de um módulo de ter uma propriedade de ModuleName.</span><span class="sxs-lookup"><span data-stu-id="d0739-143">The metadata of members that are exported from a module have a ModuleName property.</span></span> <span data-ttu-id="d0739-144">Esta propriedade é preenchida com o nome do módulo que exportou-los.</span><span class="sxs-lookup"><span data-stu-id="d0739-144">This property is populated with the name of the module that exported them.</span></span>

> [!WARNING]
> <span data-ttu-id="d0739-145">Se o nome de um membro exportado utiliza um verbo não aprovado ou se o nome do membro utiliza caracteres restritos, é apresentado um aviso quando o [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet é executado.</span><span class="sxs-lookup"><span data-stu-id="d0739-145">If the name of an exported member uses an unapproved verb or if the name of the member uses restricted characters, a warning is displayed when the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet is run.</span></span>

<span data-ttu-id="d0739-146">Por predefinição, o [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet não devolve quaisquer objetos para o pipeline.</span><span class="sxs-lookup"><span data-stu-id="d0739-146">By default, the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet does not return any objects to the pipeline.</span></span> <span data-ttu-id="d0739-147">No entanto, o cmdlet suporta um `PassThru` parâmetro pode ser utilizado para devolver uma [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) objeto para cada módulo que é importado.</span><span class="sxs-lookup"><span data-stu-id="d0739-147">However, the cmdlet supports a `PassThru` parameter that can be used to return a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object for each module that is imported.</span></span> <span data-ttu-id="d0739-148">Para enviar a saída para o anfitrião, os utilizadores devem executar o [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="d0739-148">To send output to the host, users should run the [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet.</span></span>

## <a name="restricting--the-members-that-are-imported"></a><span data-ttu-id="d0739-149">Restringir os membros que são importados</span><span class="sxs-lookup"><span data-stu-id="d0739-149">Restricting  the Members That Are Imported</span></span>

<span data-ttu-id="d0739-150">Quando um módulo é importado, utilizando o [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet, por predefinição, o módulo exportado todos os membros são importados para a sessão, incluindo quaisquer comandos exportados para o módulo por um módulo aninhado.</span><span class="sxs-lookup"><span data-stu-id="d0739-150">When a module is imported by using the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet, by default, all exported module members are imported into the session, including any commands exported to the module by a nested module.</span></span> <span data-ttu-id="d0739-151">Por predefinição, variáveis e aliases não são exportados.</span><span class="sxs-lookup"><span data-stu-id="d0739-151">By default, variables and aliases are not exported.</span></span> <span data-ttu-id="d0739-152">Para restringir os membros que são exportados, utilize um [manifesto do módulo](./how-to-write-a-powershell-module-manifest.md).</span><span class="sxs-lookup"><span data-stu-id="d0739-152">To restrict the members that are exported, use a [module manifest](./how-to-write-a-powershell-module-manifest.md).</span></span> <span data-ttu-id="d0739-153">Para restringir os membros que são importados, utilize os seguintes parâmetros do `Import-Module` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="d0739-153">To restrict the members that are imported, use the following parameters of the `Import-Module` cmdlet.</span></span>

- <span data-ttu-id="d0739-154">`Function`: Este parâmetro limita as funções que são exportadas.</span><span class="sxs-lookup"><span data-stu-id="d0739-154">`Function`: This parameter restricts the functions that are exported.</span></span> <span data-ttu-id="d0739-155">(Se estiver a utilizar um manifesto de módulo, consulte a chave de FunctionsToExport.)</span><span class="sxs-lookup"><span data-stu-id="d0739-155">(If you are using a module manifest, see the FunctionsToExport key.)</span></span>

- <span data-ttu-id="d0739-156">`Cmdlet`: Este parâmetro restringe os cmdlets que são exportados (se estiver a utilizar uma veja manifesto, módulo a chave de CmdletsToExport.)</span><span class="sxs-lookup"><span data-stu-id="d0739-156">`Cmdlet`: This parameter restricts the cmdlets that are exported (If you are using a module manifest, see the CmdletsToExport key.)</span></span>

- <span data-ttu-id="d0739-157">`Variable`: Este parâmetro restringe as variáveis que são exportadas (se estiver a utilizar uma veja manifesto, módulo a chave de VariablesToExport.)</span><span class="sxs-lookup"><span data-stu-id="d0739-157">`Variable`: This parameter restricts the variables that are exported (If you are using a module manifest, see the VariablesToExport key.)</span></span>

- <span data-ttu-id="d0739-158">`Alias`: Este parâmetro restringe os aliases que são exportados (se estiver a utilizar uma veja manifesto, módulo a chave de AliasesToExport.)</span><span class="sxs-lookup"><span data-stu-id="d0739-158">`Alias`: This parameter restricts the aliases that are exported (If you are using a module manifest, see the AliasesToExport key.)</span></span>

## <a name="see-also"></a><span data-ttu-id="d0739-159">Veja Também</span><span class="sxs-lookup"><span data-stu-id="d0739-159">See Also</span></span>

[<span data-ttu-id="d0739-160">Escrever um módulo do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="d0739-160">Writing a Windows PowerShell Module</span></span>](./writing-a-windows-powershell-module.md)
