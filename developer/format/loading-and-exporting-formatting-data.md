---
title: A carregar e exportar dados de formatação | Documentos da Microsoft
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 2a48de31-7961-4b0e-b58b-93466e38370b
caps.latest.revision: 6
ms.openlocfilehash: 5c5168ffd74c15066b914ad1b39d9ead947c5e7f
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 04/23/2019
ms.locfileid: "62065211"
---
# <a name="loading-and-exporting-formatting-data"></a><span data-ttu-id="9b325-102">Loading and Exporting Formatting Data (Carregar e Exportar Dados de Formatação)</span><span class="sxs-lookup"><span data-stu-id="9b325-102">Loading and Exporting Formatting Data</span></span>

<span data-ttu-id="9b325-103">Assim que tiver criado o ficheiro de formatação, terá de atualizar os dados do formato da sessão com o carregamento de ficheiros para a sessão atual.</span><span class="sxs-lookup"><span data-stu-id="9b325-103">Once you have created your formatting file, you need to update the format data of the session by loading your files into the current session.</span></span> <span data-ttu-id="9b325-104">(Os arquivos de formatação fornecidos pelo Windows PowerShell são carregados por snap-ins que estão registados quando é aberta a sessão atual.) Depois dos dados do formato da sessão atual são atualizados, o Windows PowerShell usa esses dados para apresentar os objetos .NET associados com as vistas definidas nos ficheiros de formatação de carregá-lo.</span><span class="sxs-lookup"><span data-stu-id="9b325-104">(The formatting files provided by Windows PowerShell are loaded by snap-ins that are registered when the current session is opened.) Once the format data of the current session is updated, Windows PowerShell uses that data to display the .NET objects associated with the views defined in the loaded formatting files.</span></span> <span data-ttu-id="9b325-105">Não existe nenhum limite para o número de arquivos de formatação que pode ser carregado para a sessão atual.</span><span class="sxs-lookup"><span data-stu-id="9b325-105">There is no limit to the number of formatting files that you can load into the current session.</span></span> <span data-ttu-id="9b325-106">Além de atualizar os dados de formatação, pode exportar os dados do formato na sessão atual para um ficheiro de formatação.</span><span class="sxs-lookup"><span data-stu-id="9b325-106">In addition to updating the formatting data, you can export the format data in the current session back to a formatting file.</span></span>

## <a name="loading-format-data"></a><span data-ttu-id="9b325-107">Ao carregar dados de formato</span><span class="sxs-lookup"><span data-stu-id="9b325-107">Loading format data</span></span>

<span data-ttu-id="9b325-108">Arquivos de formatação podem ser carregados para a sessão atual utilizando os seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="9b325-108">Formatting files can be loaded into the current session using the following methods:</span></span>

- <span data-ttu-id="9b325-109">Pode importar o ficheiro de formatação para a sessão atual da linha de comando.</span><span class="sxs-lookup"><span data-stu-id="9b325-109">You can import the formatting file into the current session from the command line.</span></span> <span data-ttu-id="9b325-110">Utilize o [FormatData atualização](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet, conforme descrito no procedimento seguinte.</span><span class="sxs-lookup"><span data-stu-id="9b325-110">Use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet as described in the following procedure.</span></span>

- <span data-ttu-id="9b325-111">Pode criar um manifesto de módulo que referencia o ficheiro de formatação.</span><span class="sxs-lookup"><span data-stu-id="9b325-111">You can create a module manifest that references your formatting file.</span></span> <span data-ttu-id="9b325-112">Módulos permitem-lhe que ficheiros para a distribuição de formatação do pacote.</span><span class="sxs-lookup"><span data-stu-id="9b325-112">Modules allow you to package you formatting files for distribution.</span></span> <span data-ttu-id="9b325-113">Utilize o [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) cmdlet para criar o manifesto e o [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet para carregar o módulo na sessão atual.</span><span class="sxs-lookup"><span data-stu-id="9b325-113">Use the [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) cmdlet to create the manifest, and the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to load the module into the current session.</span></span> <span data-ttu-id="9b325-114">Para obter mais informações sobre os módulos, consulte [escrever um módulo do Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="9b325-114">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="9b325-115">Pode criar um snap-in que referencia o ficheiro de formatação.</span><span class="sxs-lookup"><span data-stu-id="9b325-115">You can create a snap-in that references your formatting file.</span></span> <span data-ttu-id="9b325-116">Utilize o [System.Management.Automation.PSSnapIn.Formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) para referenciar os ficheiros de formatação.</span><span class="sxs-lookup"><span data-stu-id="9b325-116">Use the [System.Management.Automation.PSSnapIn.Formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) to reference your formatting files.</span></span> <span data-ttu-id="9b325-117">É vivamente recomendado que utilize módulos aos cmdlets de pacote e formatação associadas e ficheiros de tipos para distribuição.</span><span class="sxs-lookup"><span data-stu-id="9b325-117">It is strongly encouraged to use modules to package cmdlets, and any associated formatting and types files for distribution.</span></span> <span data-ttu-id="9b325-118">Para obter mais informações sobre os módulos, consulte [escrever um módulo do Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="9b325-118">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="9b325-119">Se está a invocar comandos por meio de programação, pode adicionar uma entrada de ficheiro de formatação para o estado de sessão inicial do espaço de execução em que os comandos são executados.</span><span class="sxs-lookup"><span data-stu-id="9b325-119">If you are invoking commands programmatically, you can add a formatting file entry to the initial session state of the runspace where the commands are run.</span></span> <span data-ttu-id="9b325-120">Para obter mais informações sobre o tipo de .NET usado para adicionar o arquivo de formatação, consulte o [System.Management.Automation.Runspaces.Sessionstateformatentry? Displayproperty = Fullname](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) classe.</span><span class="sxs-lookup"><span data-stu-id="9b325-120">For more information about .NET type used to add the formatting file, see the [System.Management.Automation.Runspaces.Sessionstateformatentry?Displayproperty=Fullname](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) class.</span></span>

<span data-ttu-id="9b325-121">Quando um ficheiro de formatação é carregado, é adicionado a uma lista interna que o Windows PowerShell usa para determinar que ver a utilizar ao apresentar os objetos na linha de comandos.</span><span class="sxs-lookup"><span data-stu-id="9b325-121">When a formatting file is loaded, it is added to an internal list that Windows PowerShell uses to determine which view to use when displaying objects at the command line.</span></span> <span data-ttu-id="9b325-122">Pode preceder o ficheiro de formatação para o início da lista ou pode acrescentá-lo ao final da lista.</span><span class="sxs-lookup"><span data-stu-id="9b325-122">You can prepend your formatting file to the beginning of the list, or you can append it to the end of the list.</span></span> <span data-ttu-id="9b325-123">É importante se estiver a carregar o ficheiro de formatação que define uma vista para um objeto que tem uma vista existente definida, por exemplo, quando quiser alterar a forma como um objeto que é devolvido por um cmdlet de núcleo do Windows PowerShell é saber onde o ficheiro de formatação é adicionado a esta lista  apresentada.</span><span class="sxs-lookup"><span data-stu-id="9b325-123">Knowing where your formatting file is added to this list is important if you are loading formatting file that defines a view for an object that has an existing view defined, such as when you want to change how an object that is returned by a Windows PowerShell core cmdlet is displayed.</span></span> <span data-ttu-id="9b325-124">Se estiver a carregar um ficheiro de formatação que define o modo de exibição apenas para um objeto, pode usar qualquer um dos métodos descritos anteriormente.</span><span class="sxs-lookup"><span data-stu-id="9b325-124">If you are loading a formatting file that defines the only view for an object, you can use any of the methods described previously.</span></span>  <span data-ttu-id="9b325-125">Se estiver a carregar um ficheiro de formatação que define a outra exibição para um objeto, tem de utilizar o [FormatData atualização](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet e anteceder o ficheiro para o início da lista.</span><span class="sxs-lookup"><span data-stu-id="9b325-125">If you are loading a formatting file that defines another view for an object, you must use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet and prepend your file to the beginning of the list.</span></span>

## <a name="storing-your-formatting-file"></a><span data-ttu-id="9b325-126">Armazenar o ficheiro de formatação</span><span class="sxs-lookup"><span data-stu-id="9b325-126">Storing Your Formatting File</span></span>

<span data-ttu-id="9b325-127">Não existe nenhum requisito para onde os seus arquivos de formatação são armazenados no disco.</span><span class="sxs-lookup"><span data-stu-id="9b325-127">There is no requirement for where your formatting files are stored on disk.</span></span> <span data-ttu-id="9b325-128">No entanto, é altamente aconselhável armazená-los na seguinte pasta: `user\documents\windowspowershell\`</span><span class="sxs-lookup"><span data-stu-id="9b325-128">However, it is strongly suggested that you store them in the following folder: `user\documents\windowspowershell\`</span></span>

#### <a name="loading-a-format-file-using-import-formatdata"></a><span data-ttu-id="9b325-129">A carregar um ficheiro de formato com FormatData de importação</span><span class="sxs-lookup"><span data-stu-id="9b325-129">Loading a format file using Import-FormatData</span></span>

1. <span data-ttu-id="9b325-130">Store seu arquivo de formatação para o disco.</span><span class="sxs-lookup"><span data-stu-id="9b325-130">Store your formatting file to disk.</span></span>

2. <span data-ttu-id="9b325-131">Executar o [FormatData atualização](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet através de um dos seguintes comandos.</span><span class="sxs-lookup"><span data-stu-id="9b325-131">Run the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet using one of the following commands.</span></span>

   <span data-ttu-id="9b325-132">Para adicionar a sua formatação ficheiro para a frente da lista, utilize este comando.</span><span class="sxs-lookup"><span data-stu-id="9b325-132">To add your formatting file to the front of the list use this command.</span></span> <span data-ttu-id="9b325-133">Utilize este comando, se estiver a mudar a forma como um objeto é apresentado.</span><span class="sxs-lookup"><span data-stu-id="9b325-133">Use this command if you are changing how an object is displayed.</span></span>

   ```powershell
   Update-FormatData -PrependPath PathToFormattingFile
   ```

   <span data-ttu-id="9b325-134">Para adicionar a sua formatação ficheiro para o final da lista, utilize este comando.</span><span class="sxs-lookup"><span data-stu-id="9b325-134">To add your formatting file to the end of the list use this command.</span></span>

   ```powershell
   Update-FormatData -AppendPath PathToFormattingFile
   ```

   <span data-ttu-id="9b325-135">Depois de adicionar um ficheiro com o [FormatData atualização](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet, não é possível remover o ficheiro da lista enquanto a sessão está aberta.</span><span class="sxs-lookup"><span data-stu-id="9b325-135">Once you have added a file using the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet, you cannot remove the file from the list while the session is open.</span></span> <span data-ttu-id="9b325-136">Tem de fechar a sessão para remover o arquivo de formatação a partir da lista.</span><span class="sxs-lookup"><span data-stu-id="9b325-136">You must close the session to remove the formatting file from the list.</span></span>

## <a name="exporting-format-data"></a><span data-ttu-id="9b325-137">Exportar dados de formato</span><span class="sxs-lookup"><span data-stu-id="9b325-137">Exporting format data</span></span>

<span data-ttu-id="9b325-138">Insira o corpo da secção aqui.</span><span class="sxs-lookup"><span data-stu-id="9b325-138">Insert section body here.</span></span>
