---
title: Exemplos de espaço de execução | Documentos da Microsoft
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: c92a6d3d-8d34-4a76-bdc3-dea923d9858e
caps.latest.revision: 17
ms.openlocfilehash: e24d40746da91f60aaf2af655ddcadc88ab6a4db
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 02/03/2019
ms.locfileid: "56847748"
---
# <a name="runspace-samples"></a><span data-ttu-id="8fb5f-102">Runspace Samples (Exemplos de Espaços de Execução)</span><span class="sxs-lookup"><span data-stu-id="8fb5f-102">Runspace Samples</span></span>

<span data-ttu-id="8fb5f-103">Esta secção inclui código de exemplo que mostra como utilizar diferentes tipos de espaços de execução para executar comandos de modo síncrono e assíncrono.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-103">This section includes sample code that shows how to use different types of runspaces to run commands synchronously and asynchronously.</span></span> <span data-ttu-id="8fb5f-104">Pode utilizar o Microsoft Visual Studio para criar uma aplicação de consola e, em seguida, copie o código os tópicos nesta secção para seu aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-104">You can use Microsoft Visual Studio to create a console application and then copy the code from the topics in this section into your host application.</span></span>

## <a name="in-this-section"></a><span data-ttu-id="8fb5f-105">Nesta Secção</span><span class="sxs-lookup"><span data-stu-id="8fb5f-105">In This Section</span></span>

> [!NOTE]
> <span data-ttu-id="8fb5f-106">Para exemplos de aplicativos de host que criam interfaces de anfitrião personalizado, consulte [exemplos de anfitrião personalizado](./custom-host-samples.md).</span><span class="sxs-lookup"><span data-stu-id="8fb5f-106">For samples of host applications that create custom host interfaces, see [Custom Host Samples](./custom-host-samples.md).</span></span>

 <span data-ttu-id="8fb5f-107">[Exemplo de Runspace01](./runspace01-sample.md) este exemplo mostra como utilizar o [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) classe para executar o [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) cmdlet forma síncrona e Exibe sua saída num console janela.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-107">[Runspace01 Sample](./runspace01-sample.md) This sample shows how to use the [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) class to run the [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) cmdlet synchronously and display its output in a console window.</span></span>

 <span data-ttu-id="8fb5f-108">[Exemplo de Runspace02](./runspace02-sample.md) este exemplo mostra como utilizar o [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) classe para executar o [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) e [Sort-Object](/powershell/module/Microsoft.PowerShell.Utility/Sort-Object) Cmdlets de forma síncrona.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-108">[Runspace02 Sample](./runspace02-sample.md) This sample shows how to use the [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) class to run the [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) and [Sort-Object](/powershell/module/Microsoft.PowerShell.Utility/Sort-Object) cmdlets synchronously.</span></span> <span data-ttu-id="8fb5f-109">Os resultados desses comandos são apresentadas utilizando um [System.Windows.Forms.Datagridview](/dotnet/api/System.Windows.Forms.DataGridView) controle.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-109">The results of these commands is displayed by using a [System.Windows.Forms.Datagridview](/dotnet/api/System.Windows.Forms.DataGridView) control.</span></span>

 <span data-ttu-id="8fb5f-110">[Exemplo de Runspace03](./runspace03-sample.md) este exemplo mostra como utilizar o [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) classe para executar um script de forma síncrona e como lidar com erros de não terminação.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-110">[Runspace03 Sample](./runspace03-sample.md) This sample shows how to use the [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) class to run a script synchronously, and how to handle non-terminating errors.</span></span> <span data-ttu-id="8fb5f-111">O script recebe uma lista de nomes de processo e, em seguida, obtém esses processos.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-111">The script receives a list of process names and then retrieves those processes.</span></span> <span data-ttu-id="8fb5f-112">Os resultados do script, incluindo quaisquer erros de não terminação de mensagens em fila que foram gerados ao executar o script, são exibidos numa janela de consola.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-112">The results of the script, including any non-terminating errors that were generated when running the script, are displayed in a console window.</span></span>

 <span data-ttu-id="8fb5f-113">[Exemplo de Runspace04](./runspace04-sample.md) este exemplo mostra como utilizar o [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) classe para executar comandos e como erros de terminação de catch que forem lançadas. quando executar os comandos.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-113">[Runspace04 Sample](./runspace04-sample.md) This sample shows how to use the [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) class to run commands, and how to catch terminating errors that are thrown when running the commands.</span></span> <span data-ttu-id="8fb5f-114">Dois comandos são executados, e o último comando é passado um argumento de parâmetro que não é válido.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-114">Two commands are run, and the last command is passed a parameter argument that is not valid.</span></span> <span data-ttu-id="8fb5f-115">Como resultado, não existem objetos são devolvidos e um erro de terminação é lançado.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-115">As a result no objects are returned and a terminating error is thrown.</span></span>

 <span data-ttu-id="8fb5f-116">[Exemplo de Runspace05](./runspace05-sample.md) este exemplo mostra como adicionar um snap-in para uma [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) de objeto para que o cmdlet do snap-in está disponível quando o espaço de execução é aberto.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-116">[Runspace05 Sample](./runspace05-sample.md) This sample shows how to add a snap-in to an [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) object so that the cmdlet of the snap-in is available when the runspace is opened.</span></span> <span data-ttu-id="8fb5f-117">O snap-in fornece um cmdlet de Get-Proc (definido pela [exemplo de GetProcessSample01](../cmdlet/getprocesssample01-sample.md)) que é executado de forma síncrona com um [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) objeto.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-117">The snap-in provides a Get-Proc cmdlet (defined by the [GetProcessSample01 Sample](../cmdlet/getprocesssample01-sample.md)) that is run synchronously using a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object.</span></span>

 <span data-ttu-id="8fb5f-118">[Exemplo de Runspace06](./runspace06-sample.md) este exemplo mostra como adicionar um módulo para uma [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) de objeto para que o módulo é carregado quando o espaço de execução é aberto.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-118">[Runspace06 Sample](./runspace06-sample.md) This sample shows how to add a module to an [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) object so that the module is loaded when the runspace is opened.</span></span> <span data-ttu-id="8fb5f-119">O módulo fornece um cmdlet de Get-Proc (definido pela [exemplo GetProcessSample02](../cmdlet/getprocesssample02-sample.md)) que é executado de forma síncrona usando um [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) objeto.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-119">The module provides a Get-Proc cmdlet (defined by the [GetProcessSample02 Sample](../cmdlet/getprocesssample02-sample.md)) that is run synchronously using a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object.</span></span>

 <span data-ttu-id="8fb5f-120">[Exemplo de Runspace07](./runspace07-sample.md) este exemplo mostra como criar um espaço de execução e, em seguida, utilizar esse espaço de execução para executar dois cmdlets de forma síncrona ao utilizar um [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) objeto.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-120">[Runspace07 Sample](./runspace07-sample.md) This sample shows how to create a runspace, and then use that runspace to run two cmdlets synchronously by using a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object.</span></span>

 <span data-ttu-id="8fb5f-121">[Exemplo de Runspace08](./runspace08-sample.md) este exemplo mostra como adicionar comandos e argumentos para o pipeline de uma [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) objeto e como executar os comandos de forma síncrona.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-121">[Runspace08 Sample](./runspace08-sample.md) This sample shows how to add commands and arguments to the pipeline of a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object and how to run the commands synchronously.</span></span>

 <span data-ttu-id="8fb5f-122">[Exemplo de Runspace09](./runspace09-sample.md) este exemplo mostra como adicionar um script para o pipeline de uma [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) objeto e como executar o script de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-122">[Runspace09 Sample](./runspace09-sample.md) This sample shows how to add a script to the pipeline of a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object and how to run the script asynchronously.</span></span> <span data-ttu-id="8fb5f-123">Eventos são usados para manipular a saída do script.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-123">Events are used to handle the output of the script.</span></span>

 <span data-ttu-id="8fb5f-124">[Exemplo de Runspace10](./runspace10-sample.md) este exemplo mostra como criar um Estado de sessão inicial padrão, como adicionar um cmdlet para o [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState), como criar um espaço de execução que utiliza o Estado de sessão inicial e como executar o comando utilizando um [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) objeto.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-124">[Runspace10 Sample](./runspace10-sample.md) This sample shows how to create a default initial session state, how to add a cmdlet to the [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState), how to create a runspace that uses the initial session state, and how to run the command by using a [System.Management.Automation.Powershell](/dotnet/api/system.management.automation.powershell) object.</span></span>

 <span data-ttu-id="8fb5f-125">[Exemplo de Runspace11](./runspace11-sample.md) isso mostra como utilizar o [System.Management.Automation.Proxycommand](/dotnet/api/System.Management.Automation.ProxyCommand) classe para criar um comando de proxy que chama um cmdlet existente, mas restringe o conjunto de parâmetros.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-125">[Runspace11 Sample](./runspace11-sample.md) This shows how to use the [System.Management.Automation.Proxycommand](/dotnet/api/System.Management.Automation.ProxyCommand) class to create a proxy command that calls an existing cmdlet, but restricts the set of available parameters.</span></span> <span data-ttu-id="8fb5f-126">O comando de proxy, em seguida, é adicionado a um Estado de sessão inicial que é utilizado para criar um espaço de execução restrito.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-126">The proxy command is then added to an initial session state that is used to create a constrained runspace.</span></span> <span data-ttu-id="8fb5f-127">Isso significa que o usuário pode acessar a funcionalidade do cmdlet apenas através do comando de proxy.</span><span class="sxs-lookup"><span data-stu-id="8fb5f-127">This means that the user can access the functionality of the cmdlet only through the proxy command.</span></span>

## <a name="see-also"></a><span data-ttu-id="8fb5f-128">Veja Também</span><span class="sxs-lookup"><span data-stu-id="8fb5f-128">See Also</span></span>
