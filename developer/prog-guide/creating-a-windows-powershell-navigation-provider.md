---
title: Criar um fornecedor de navegação do Windows PowerShell | Documentos da Microsoft
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- navigation providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], navigation provider
ms.assetid: 8bd3224d-ca6f-4640-9464-cb4d9f4e13b1
caps.latest.revision: 5
ms.openlocfilehash: cbc8ce0600553f9e9ab973d6f92ea5eafde310e2
ms.sourcegitcommit: 69abc5ad16e5dd29ddfb1853e266a4bfd1d59d59
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 03/05/2019
ms.locfileid: "57430041"
---
# <a name="creating-a-windows-powershell-navigation-provider"></a><span data-ttu-id="0a01c-102">Creating a Windows PowerShell Navigation Provider (Criar um Fornecedor de Navegação do Windows PowerShell)</span><span class="sxs-lookup"><span data-stu-id="0a01c-102">Creating a Windows PowerShell Navigation Provider</span></span>

<span data-ttu-id="0a01c-103">Este tópico descreve como criar um provedor de navegação do Windows PowerShell que pode navegar no arquivo de dados.</span><span class="sxs-lookup"><span data-stu-id="0a01c-103">This topic describes how to create a Windows PowerShell navigation provider that can navigate the data store.</span></span> <span data-ttu-id="0a01c-104">Este tipo de fornecedor suporta comandos de recursiva, contêineres aninhados e caminhos relativos.</span><span class="sxs-lookup"><span data-stu-id="0a01c-104">This type of provider supports recursive commands, nested containers, and relative paths.</span></span>

> [!NOTE]
> <span data-ttu-id="0a01c-105">Pode transferir o C# ficheiro de origem (AccessDBSampleProvider05.cs) para este fornecedor com o Microsoft Windows Software Development Kit para Windows Vista e o .NET Framework 3.0 Runtime Components.</span><span class="sxs-lookup"><span data-stu-id="0a01c-105">You can download the C# source file (AccessDBSampleProvider05.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="0a01c-106">Para obter instruções de transferência, consulte [como instalar o Windows PowerShell e transferir o SDK do Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="0a01c-106">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="0a01c-107">Os arquivos de fonte transferido estão disponíveis no  **\<exemplos do PowerShell >** diretório.</span><span class="sxs-lookup"><span data-stu-id="0a01c-107">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="0a01c-108">Para obter mais informações sobre outras implementações de provedores do Windows PowerShell, consulte [conceber Windows PowerShell Fornecedor_de_e](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0a01c-108">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="0a01c-109">O fornecedor descrito aqui permite o um banco de dados do Access o identificador do usuário como uma unidade, para que o utilizador pode navegar para as tabelas de dados na base de dados.</span><span class="sxs-lookup"><span data-stu-id="0a01c-109">The provider described here enables the user handle an Access database as a drive so that the user can navigate to the data tables in the database.</span></span> <span data-ttu-id="0a01c-110">Ao criar seu próprio provedor de navegação, pode implementar os métodos que podem fazer caminhos qualificado de unidade necessários para a navegação, normalizar caminhos relativos, mova os itens de arquivo de dados, bem como métodos que obtém nomes de subordinado, obtém o caminho principal de um item e de teste para identificar se um item é um contentor.</span><span class="sxs-lookup"><span data-stu-id="0a01c-110">When creating your own navigation provider, you can implement methods that can make drive-qualified paths required for navigation, normalize relative paths, move items of the data store, as well as methods that get child names, get the parent path of an item, and test to identify if an item is a container.</span></span>

> [!CAUTION]
> <span data-ttu-id="0a01c-111">Lembre-se de que esse design supõe que uma base de dados que tem um campo com o ID de nome e de que o tipo do campo é LongInteger.</span><span class="sxs-lookup"><span data-stu-id="0a01c-111">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

<span data-ttu-id="0a01c-112">A lista seguinte inclui as secções neste tópico.</span><span class="sxs-lookup"><span data-stu-id="0a01c-112">The following list includes sections in this topic.</span></span> <span data-ttu-id="0a01c-113">Se não estiver familiarizado com a escrita de um fornecedor de navegação do Windows PowerShell, ler estas informações na ordem em que ele é exibido.</span><span class="sxs-lookup"><span data-stu-id="0a01c-113">If you are unfamiliar with writing a Windows PowerShell navigation provider, read this information in the order that it appears.</span></span> <span data-ttu-id="0a01c-114">No entanto, se estiver familiarizado com a escrita de um fornecedor de navegação do Windows PowerShell, aceda diretamente às informações de que precisa.</span><span class="sxs-lookup"><span data-stu-id="0a01c-114">However, if you are familiar with writing a Windows PowerShell navigation provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="0a01c-115">Definir uma classe de fornecedor de navegação de PS</span><span class="sxs-lookup"><span data-stu-id="0a01c-115">Defining a PS Navigation Provider Class</span></span>](#Define-the-Windows-PowerShell-provider)

- [<span data-ttu-id="0a01c-116">Definir funcionalidade de Base</span><span class="sxs-lookup"><span data-stu-id="0a01c-116">Defining Base Functionality</span></span>](#Defining-Base-Functionality)

- [<span data-ttu-id="0a01c-117">Criar um caminho de PS</span><span class="sxs-lookup"><span data-stu-id="0a01c-117">Creating a PS Path</span></span>](#Creating-a-Windows-PowerShell-Path)

- [<span data-ttu-id="0a01c-118">A obter o caminho principal</span><span class="sxs-lookup"><span data-stu-id="0a01c-118">Retrieving the Parent Path</span></span>](#Retrieving-the-Parent-Path)

- [<span data-ttu-id="0a01c-119">A obter o nome do caminho de subordinados</span><span class="sxs-lookup"><span data-stu-id="0a01c-119">Retrieving the Child Path Name</span></span>](#Retrieve-the-Child-Path-Name)

- [<span data-ttu-id="0a01c-120">Determinar se um Item é um contentor</span><span class="sxs-lookup"><span data-stu-id="0a01c-120">Determining if an Item is a Container</span></span>](#Determining-if-an-Item-is-a-Container)

- [<span data-ttu-id="0a01c-121">Mover um Item</span><span class="sxs-lookup"><span data-stu-id="0a01c-121">Moving an Item</span></span>](#Moving-an-Item)

- [<span data-ttu-id="0a01c-122">Os parâmetros dinâmicos para a anexar o `Move-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="0a01c-122">Attaching Dynamic Parameters to the `Move-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Move-Item-Cmdlet)

- [<span data-ttu-id="0a01c-123">Normalizar um caminho relativo</span><span class="sxs-lookup"><span data-stu-id="0a01c-123">Normalizing a Relative Path</span></span>](#Normalizing-a-Relative-Path)

- [<span data-ttu-id="0a01c-124">Exemplo de código</span><span class="sxs-lookup"><span data-stu-id="0a01c-124">Code Sample</span></span>](#Code-Sample)

- [<span data-ttu-id="0a01c-125">Definir tipos de objeto e formatação</span><span class="sxs-lookup"><span data-stu-id="0a01c-125">Defining Object Types and Formatting</span></span>](#Defining-Object-Types-and-Formatting)

- [<span data-ttu-id="0a01c-126">Criando o provedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="0a01c-126">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-provider)

- [<span data-ttu-id="0a01c-127">Teste o fornecedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="0a01c-127">Testing the Windows PowerShell Provider</span></span>](#Testing-the-Windows-PowerShell-provider)

## <a name="define-the-windows-powershell-provider"></a><span data-ttu-id="0a01c-128">Definir o fornecedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="0a01c-128">Define the Windows PowerShell provider</span></span>

<span data-ttu-id="0a01c-129">Um provedor de navegação do Windows PowerShell tem de criar uma classe do .NET que deriva de [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) classe base.</span><span class="sxs-lookup"><span data-stu-id="0a01c-129">A Windows PowerShell navigation provider must create a .NET class that derives from the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class.</span></span> <span data-ttu-id="0a01c-130">Esta é a definição de classe para o fornecedor de navegação descrita nesta secção.</span><span class="sxs-lookup"><span data-stu-id="0a01c-130">Here is the class definition for the navigation provider described in this section.</span></span>

[!code-csharp[AccessDBProviderSample05.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample05/AccessDBProviderSample05.cs#L31-L32 "AccessDBProviderSample05.cs")]

<span data-ttu-id="0a01c-131">Observe que, neste fornecedor, o [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) atributo inclui dois parâmetros.</span><span class="sxs-lookup"><span data-stu-id="0a01c-131">Note that in this provider, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="0a01c-132">O primeiro parâmetro especifica um nome amigável para o fornecedor que é utilizado pelo Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="0a01c-132">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="0a01c-133">O segundo parâmetro especifica os recursos específicos do Windows PowerShell que o fornecedor expõe o tempo de execução do Windows PowerShell durante o processamento do comando.</span><span class="sxs-lookup"><span data-stu-id="0a01c-133">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="0a01c-134">Para este fornecedor, não há nenhum capacidades específicas do Windows PowerShell que são adicionadas.</span><span class="sxs-lookup"><span data-stu-id="0a01c-134">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="0a01c-135">Definir funcionalidade de Base</span><span class="sxs-lookup"><span data-stu-id="0a01c-135">Defining Base Functionality</span></span>

<span data-ttu-id="0a01c-136">Conforme descrito em [Design de seu fornecedor de PS](./designing-your-windows-powershell-provider.md), o [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) classe base derivada de outras classes que fornecidos fornecedor diferente funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="0a01c-136">As described in [Design Your PS Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="0a01c-137">Um provedor de navegação do Windows PowerShell, por conseguinte, tem de definir todas as funcionalidades fornecidas por essas classes.</span><span class="sxs-lookup"><span data-stu-id="0a01c-137">A Windows PowerShell navigation provider, therefore, must define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="0a01c-138">Para implementar a funcionalidade para adicionar informações de inicialização de específico da sessão e para liberar os recursos que são utilizados pelo fornecedor, veja [criar um fornecedor de PS básica](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0a01c-138">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic PS Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="0a01c-139">No entanto, a maioria dos provedores de (incluindo o fornecedor descrito aqui) pode utilizar a implementação padrão desta funcionalidade fornecida pelo Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="0a01c-139">However, most providers (including the provider described here) can use the default implementation of this functionality provided by Windows PowerShell.</span></span>

<span data-ttu-id="0a01c-140">Para obter acesso ao arquivo de dados por meio de uma unidade do Windows PowerShell, tem de implementar os métodos do [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) classe base.</span><span class="sxs-lookup"><span data-stu-id="0a01c-140">To get access to the data store through a Windows PowerShell drive, you must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="0a01c-141">Para obter mais informações sobre a implementação desses métodos, consulte [criar um fornecedor de unidade do Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0a01c-141">For more information about implementing these methods, see [Creating a Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="0a01c-142">Para manipular os itens de um armazenamento de dados, como obter, configuração e itens de limpeza, o fornecedor tem de implementar os métodos fornecidos pela [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) classe base.</span><span class="sxs-lookup"><span data-stu-id="0a01c-142">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="0a01c-143">Para obter mais informações sobre a implementação desses métodos, consulte [criar um fornecedor de Item do Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0a01c-143">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

<span data-ttu-id="0a01c-144">Para obter os itens subordinados ou seus nomes, de arquivo de dados, bem como métodos que criam, copiam, mudar o nome e remover itens, deve implementar os métodos fornecidos pelo [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider)classe base.</span><span class="sxs-lookup"><span data-stu-id="0a01c-144">To get to the child items, or their names, of the data store, as well as methods that create, copy, rename, and remove items, you must implement the methods provided by the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="0a01c-145">Para obter mais informações sobre a implementação desses métodos, consulte [criar um fornecedor de contentor do Windows PowerShell](./creating-a-windows-powershell-container-provider.md).</span><span class="sxs-lookup"><span data-stu-id="0a01c-145">For more information about implementing these methods, see [Creating a Windows PowerShell Container Provider](./creating-a-windows-powershell-container-provider.md).</span></span>

## <a name="creating-a-windows-powershell-path"></a><span data-ttu-id="0a01c-146">Criar um caminho do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="0a01c-146">Creating a Windows PowerShell Path</span></span>

<span data-ttu-id="0a01c-147">Fornecedor de navegação do Windows PowerShell usar um caminho interno para o fornecedor do Windows PowerShell para navegar os itens de arquivo de dados.</span><span class="sxs-lookup"><span data-stu-id="0a01c-147">Windows PowerShell navigation provider use a provider-internal Windows PowerShell path to navigate the items of the data store.</span></span> <span data-ttu-id="0a01c-148">Para criar um caminho de fornecedor interno o fornecedor tem de implementar o [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) chama o método para suporta do cmdlet Combine-Path.</span><span class="sxs-lookup"><span data-stu-id="0a01c-148">To create a provider-internal path the provider must implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method to supports calls from the Combine-Path cmdlet.</span></span> <span data-ttu-id="0a01c-149">Este método combina um caminho pai e filho num caminho de fornecedor interno, com um separador de caminho específica do fornecedor entre os caminhos principais e subordinados.</span><span class="sxs-lookup"><span data-stu-id="0a01c-149">This method combines a parent and child path into a provider-internal path, using a provider-specific path separator between the parent and child paths.</span></span>

<span data-ttu-id="0a01c-150">A implementação padrão usa caminhos com "/" ou "\\"como separador de caminho, normaliza o separador de caminho para"\\", combina as partes do caminho principal e subordinada com o separador entre eles e, em seguida, retorna uma cadeia que contém o caminhos combinados.</span><span class="sxs-lookup"><span data-stu-id="0a01c-150">The default implementation takes paths with "/" or "\\" as the path separator, normalizes the path separator to "\\", combines the parent and child path parts with the separator between them, and then returns a string that contains the combined paths.</span></span>

<span data-ttu-id="0a01c-151">Este fornecedor de navegação não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="0a01c-151">This navigation provider does not implement this method.</span></span> <span data-ttu-id="0a01c-152">No entanto, o código a seguir é a implementação padrão do [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) método.</span><span class="sxs-lookup"><span data-stu-id="0a01c-152">However, the following code is the default implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermakepath](Msh_samplestestcmdlets#testprovidermakepath)]  -->

#### <a name="things-to-remember-about-implementing-makepath"></a><span data-ttu-id="0a01c-153">Coisas a serem lembrados sobre a implementação MakePath</span><span class="sxs-lookup"><span data-stu-id="0a01c-153">Things to Remember About Implementing MakePath</span></span>

<span data-ttu-id="0a01c-154">As seguintes condições podem aplicar-se na implementação [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath):</span><span class="sxs-lookup"><span data-stu-id="0a01c-154">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath):</span></span>

- <span data-ttu-id="0a01c-155">Sua implementação do [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) método não deve validar o caminho como um caminho totalmente qualificado legal no espaço de nomes do fornecedor.</span><span class="sxs-lookup"><span data-stu-id="0a01c-155">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method should not validate the path as a legal fully-qualified path in the provider namespace.</span></span> <span data-ttu-id="0a01c-156">Lembre-se de que cada parâmetro só pode representar uma parte de um caminho e as partes combinadas não podem gerar um caminho totalmente qualificado.</span><span class="sxs-lookup"><span data-stu-id="0a01c-156">Be aware that each parameter can only represent a part of a path, and the combined parts might not generate a fully-qualified path.</span></span> <span data-ttu-id="0a01c-157">Por exemplo, o [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) método para o fornecedor do sistema de ficheiros pode receber "windows\system32" no `parent` parâmetro e "abc.dll" o `child` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="0a01c-157">For example, the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method for the filesystem provider might receive "windows\system32" in the `parent` parameter and "abc.dll" in the `child` parameter.</span></span> <span data-ttu-id="0a01c-158">O método é associado esses valores com o "\\" separador e devolve "windows\system32\abc.dll", que não é um caminho de sistema de ficheiro completamente qualificado.</span><span class="sxs-lookup"><span data-stu-id="0a01c-158">The method joins these values with the "\\" separator and returns "windows\system32\abc.dll", which is not a fully-qualified file system path.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="0a01c-159">As partes do caminho fornecidas na chamada para [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) pode conter carateres não permitidos no espaço de nomes do fornecedor.</span><span class="sxs-lookup"><span data-stu-id="0a01c-159">The path parts provided in the call to [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) might contain characters not allowed in the provider namespace.</span></span> <span data-ttu-id="0a01c-160">Estes carateres é muito provável que são utilizados para expansão de caráter universal e a implementação desse método não deve removê-los.</span><span class="sxs-lookup"><span data-stu-id="0a01c-160">These characters are most likely used for wildcard expansion and the implementation of this method should not remove them.</span></span>

## <a name="retrieving-the-parent-path"></a><span data-ttu-id="0a01c-161">A obter o caminho principal</span><span class="sxs-lookup"><span data-stu-id="0a01c-161">Retrieving the Parent Path</span></span>

<span data-ttu-id="0a01c-162">Provedores de navegação do Windows PowerShell implementam a [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) método para recuperar a parte do principal do indicado total ou parcial caminho de específica do fornecedor.</span><span class="sxs-lookup"><span data-stu-id="0a01c-162">Windows PowerShell navigation providers implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) method to retrieve the parent part of the indicated full or partial provider-specific path.</span></span> <span data-ttu-id="0a01c-163">O método Remove a parte-filho do caminho e retorna a principal parte do caminho.</span><span class="sxs-lookup"><span data-stu-id="0a01c-163">The method removes the child part of the path and returns the parent path part.</span></span> <span data-ttu-id="0a01c-164">O `root` parâmetro especifica o caminho totalmente qualificado para a raiz de uma unidade.</span><span class="sxs-lookup"><span data-stu-id="0a01c-164">The `root` parameter specifies the fully-qualified path to the root of a drive.</span></span> <span data-ttu-id="0a01c-165">Este parâmetro pode ser nulo nem estar vazio se uma unidade montada não está a ser utilizado para a operação de obtenção.</span><span class="sxs-lookup"><span data-stu-id="0a01c-165">This parameter can be null or empty if a mounted drive is not in use for the retrieval operation.</span></span> <span data-ttu-id="0a01c-166">Se for especificada uma raiz, o método deve retornar um caminho para um contentor na mesma árvore de como a raiz.</span><span class="sxs-lookup"><span data-stu-id="0a01c-166">If a root is specified, the method must return a path to a container in the same tree as the root.</span></span>

<span data-ttu-id="0a01c-167">O exemplo de provedor de navegação não substitui este método, mas usa a implementação padrão.</span><span class="sxs-lookup"><span data-stu-id="0a01c-167">The sample navigation provider does not override this method, but uses the default implementation.</span></span> <span data-ttu-id="0a01c-168">Ela aceita caminhos que utilizam ambos "/" e "\\" como separadores de caminho.</span><span class="sxs-lookup"><span data-stu-id="0a01c-168">It accepts paths that use both "/" and "\\" as path separators.</span></span> <span data-ttu-id="0a01c-169">Ele primeiro normaliza o caminho para ter apenas "\\" separadores, em seguida, divide o caminho principal desativado no último "\\" e retorna o caminho principal.</span><span class="sxs-lookup"><span data-stu-id="0a01c-169">It first normalizes the path to have only "\\" separators, then splits the parent path off at the last "\\" and returns the parent path.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetparentpath](Msh_samplestestcmdlets#testprovidergetparentpath)]  -->

#### <a name="to-remember-about-implementing-getparentpath"></a><span data-ttu-id="0a01c-170">Lembrar-se sobre a implementação GetParentPath</span><span class="sxs-lookup"><span data-stu-id="0a01c-170">To Remember About Implementing GetParentPath</span></span>

<span data-ttu-id="0a01c-171">Sua implementação do [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) método deve dividir o caminho lexicalmente no separador de caminho para o espaço de nomes do fornecedor.</span><span class="sxs-lookup"><span data-stu-id="0a01c-171">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) method should split the path lexically on the path separator for the provider namespace.</span></span> <span data-ttu-id="0a01c-172">Por exemplo, o fornecedor do sistema de ficheiros utiliza este método para procurar o último "\\" e retorna tudo para a esquerda do separador.</span><span class="sxs-lookup"><span data-stu-id="0a01c-172">For example, the filesystem provider uses this method to look for the last "\\" and returns everything to the left of the separator.</span></span>

## <a name="retrieve-the-child-path-name"></a><span data-ttu-id="0a01c-173">Obter o nome do caminho de subordinados</span><span class="sxs-lookup"><span data-stu-id="0a01c-173">Retrieve the Child Path Name</span></span>

<span data-ttu-id="0a01c-174">Sua implementa de fornecedor de navegação da [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) método para recuperar o nome (elemento da folha) do filho do item localizado em todo o indicados ou caminho de específica do fornecedor parcial.</span><span class="sxs-lookup"><span data-stu-id="0a01c-174">Your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) method to retrieve the name (leaf element) of the child of the item located at the indicated full or partial provider-specific path.</span></span>

<span data-ttu-id="0a01c-175">O exemplo de provedor de navegação não substitui este método.</span><span class="sxs-lookup"><span data-stu-id="0a01c-175">The sample navigation provider does not override this method.</span></span> <span data-ttu-id="0a01c-176">A implementação padrão é mostrada abaixo.</span><span class="sxs-lookup"><span data-stu-id="0a01c-176">The default implementation is shown below.</span></span> <span data-ttu-id="0a01c-177">Ela aceita caminhos que utilizam ambos "/" e "\\" como separadores de caminho.</span><span class="sxs-lookup"><span data-stu-id="0a01c-177">It accepts paths that use both "/" and "\\" as path separators.</span></span> <span data-ttu-id="0a01c-178">-Lo primeiro normaliza o caminho para ter apenas "\\" separadores, em seguida, divide o caminho principal desativado no último "\\" e devolve o nome do filho parte do caminho.</span><span class="sxs-lookup"><span data-stu-id="0a01c-178">It first normalizes the path to have only "\\" separators, then splits the parent path off at the last "\\" and returns the name of the child path part.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildname](Msh_samplestestcmdlets#testprovidergetchildname)]  -->

#### <a name="things-to-remember-about-implementing-getchildname"></a><span data-ttu-id="0a01c-179">Coisas a serem lembrados sobre a implementação GetChildName</span><span class="sxs-lookup"><span data-stu-id="0a01c-179">Things to Remember About Implementing GetChildName</span></span>

<span data-ttu-id="0a01c-180">Sua implementação do [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) método deve dividir o caminho lexicalmente no separador de caminho.</span><span class="sxs-lookup"><span data-stu-id="0a01c-180">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) method should split the path lexically on the path separator.</span></span> <span data-ttu-id="0a01c-181">Se o caminho fornecido não contém nenhuma separadores de caminho, o método deve retornar o caminho sem modificações.</span><span class="sxs-lookup"><span data-stu-id="0a01c-181">If the supplied path contains no path separators, the method should return the path unmodified.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="0a01c-182">O caminho fornecido na chamada para esse método pode conter carateres que são ilegais no espaço de nomes do fornecedor.</span><span class="sxs-lookup"><span data-stu-id="0a01c-182">The path provided in the call to this method might contain characters that are illegal in the provider namespace.</span></span> <span data-ttu-id="0a01c-183">Esses caracteres são mais prováveis utilizado para expansão de carateres universais ou correspondência de expressões regulares, e a implementação desse método não deve removê-los.</span><span class="sxs-lookup"><span data-stu-id="0a01c-183">These characters are most likely used for wildcard expansion or regular expression matching, and the implementation of this method should not remove them.</span></span>

## <a name="determining-if-an-item-is-a-container"></a><span data-ttu-id="0a01c-184">Determinar se um Item é um contentor</span><span class="sxs-lookup"><span data-stu-id="0a01c-184">Determining if an Item is a Container</span></span>

<span data-ttu-id="0a01c-185">O fornecedor de navegação que pode implementar o [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) método para determinar se o caminho especificado indica um contentor.</span><span class="sxs-lookup"><span data-stu-id="0a01c-185">The navigation provider can implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) method to determine if the specified path indicates a container.</span></span> <span data-ttu-id="0a01c-186">Devolve VERDADEIRO se o caminho representa um contentor e false caso contrário.</span><span class="sxs-lookup"><span data-stu-id="0a01c-186">It returns true if the path represents a container, and false otherwise.</span></span> <span data-ttu-id="0a01c-187">O utilizador tem este método para poder utilizar o `Test-Path` cmdlet para o caminho fornecido.</span><span class="sxs-lookup"><span data-stu-id="0a01c-187">The user needs this method to be able to use the `Test-Path` cmdlet for the supplied path.</span></span>

<span data-ttu-id="0a01c-188">O código seguinte mostra os [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) implementação no nosso exemplo de provedor de navegação.</span><span class="sxs-lookup"><span data-stu-id="0a01c-188">The following code shows the [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) implementation in our sample navigation provider.</span></span> <span data-ttu-id="0a01c-189">O método verifica que o caminho especificado está correto e se a tabela existe e devolve verdadeira se o caminho indica um contentor.</span><span class="sxs-lookup"><span data-stu-id="0a01c-189">The method verifies that  the specified path is correct and if the table exists, and returns true if the path indicates a container.</span></span>

[!code-csharp[AccessDBProviderSample05.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample05/AccessDBProviderSample05.cs#L847-L872 "AccessDBProviderSample05.cs")]

#### <a name="things-to-remember-about-implementing-isitemcontainer"></a><span data-ttu-id="0a01c-190">Coisas a serem lembrados sobre a implementação IsItemContainer</span><span class="sxs-lookup"><span data-stu-id="0a01c-190">Things to Remember About Implementing IsItemContainer</span></span>

<span data-ttu-id="0a01c-191">Seu fornecedor de navegação de classe do .NET pode declarar capacidades de fornecedor de ExpandWildcards, filtro, inclusão ou exclusão, do [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeração.</span><span class="sxs-lookup"><span data-stu-id="0a01c-191">Your navigation provider .NET class might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="0a01c-192">Neste caso, a implementação do [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) tem de garantir que o caminho transmitido cumpre os requisitos.</span><span class="sxs-lookup"><span data-stu-id="0a01c-192">In this case, the implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) needs to ensure that the path passed meets requirements.</span></span> <span data-ttu-id="0a01c-193">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, o [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) propriedade.</span><span class="sxs-lookup"><span data-stu-id="0a01c-193">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) property.</span></span>

## <a name="moving-an-item"></a><span data-ttu-id="0a01c-194">Mover um Item</span><span class="sxs-lookup"><span data-stu-id="0a01c-194">Moving an Item</span></span>

<span data-ttu-id="0a01c-195">Support do `Move-Item` seu provedor de navegação de cmdlet, implementa o [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) método.</span><span class="sxs-lookup"><span data-stu-id="0a01c-195">In support of the `Move-Item` cmdlet, your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method.</span></span> <span data-ttu-id="0a01c-196">Esse método passa o item especificado pelos `path` parâmetro para o contentor no caminho fornecido no `destination` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="0a01c-196">This method moves the item specified by the `path` parameter to the container at the path supplied in the `destination` parameter.</span></span>

<span data-ttu-id="0a01c-197">O exemplo de provedor de navegação não substitui a [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) método.</span><span class="sxs-lookup"><span data-stu-id="0a01c-197">The sample navigation provider does not override the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method.</span></span> <span data-ttu-id="0a01c-198">Segue-se a implementação padrão.</span><span class="sxs-lookup"><span data-stu-id="0a01c-198">The following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermoveitem](Msh_samplestestcmdlets#testprovidermoveitem)]  -->

#### <a name="things-to-remember-about-implementing-moveitem"></a><span data-ttu-id="0a01c-199">Coisas a serem lembrados sobre a implementação MoveItem</span><span class="sxs-lookup"><span data-stu-id="0a01c-199">Things to Remember About Implementing MoveItem</span></span>

<span data-ttu-id="0a01c-200">Seu fornecedor de navegação de classe do .NET pode declarar capacidades de fornecedor de ExpandWildcards, filtro, inclusão ou exclusão, do [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeração.</span><span class="sxs-lookup"><span data-stu-id="0a01c-200">Your navigation provider .NET class might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="0a01c-201">Neste caso, a implementação do [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) tem de garantir que o caminho transmitido cumpre os requisitos.</span><span class="sxs-lookup"><span data-stu-id="0a01c-201">In this case, the implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) must ensure that the path passed meets requirements.</span></span> <span data-ttu-id="0a01c-202">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, o **CmdletProvider.Exclude** propriedade.</span><span class="sxs-lookup"><span data-stu-id="0a01c-202">To do this, the method should access the appropriate property, for example, the **CmdletProvider.Exclude** property.</span></span>

<span data-ttu-id="0a01c-203">Por predefinição, substituições deste método não deverá mover objetos ao longo de objetos existentes, a menos que o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) estiver definida como `true`.</span><span class="sxs-lookup"><span data-stu-id="0a01c-203">By default, overrides of this method should not move objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="0a01c-204">Por exemplo, o fornecedor do sistema de ficheiros não copiará c:\temp\abc.txt ao longo de um ficheiro de c:\bar.txt existente, a menos que o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) estiver definida como `true`.</span><span class="sxs-lookup"><span data-stu-id="0a01c-204">For example, the filesystem provider will not copy c:\temp\abc.txt over an existing c:\bar.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="0a01c-205">Se o caminho especificado na `destination` parâmetro existe e é um contentor, o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriedade não é necessária.</span><span class="sxs-lookup"><span data-stu-id="0a01c-205">If the path specified in the `destination` parameter exists and is a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="0a01c-206">Neste caso, [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) deve mover o item indicado pela `path` parâmetro para o contentor indicado pelo `destination` parâmetro como um filho.</span><span class="sxs-lookup"><span data-stu-id="0a01c-206">In this case, [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) should move the item indicated by the `path` parameter to the container indicated by the `destination` parameter as a child.</span></span>

<span data-ttu-id="0a01c-207">Sua implementação do [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) deve chamar o método [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e verifique o valor de retorno antes de fazer alterações ao arquivo de dados.</span><span class="sxs-lookup"><span data-stu-id="0a01c-207">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="0a01c-208">Este método é usado para confirmar a execução de uma operação quando é efetuada uma alteração de estado do sistema, por exemplo, a eliminar ficheiros.</span><span class="sxs-lookup"><span data-stu-id="0a01c-208">This method is used to confirm execution of an operation when a change is made to system state, for example, deleting files.</span></span> <span data-ttu-id="0a01c-209">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) envia o nome do recurso a ser alterados ao usuário, com o tempo de execução do Windows PowerShell tendo em conta as definições de linha de comandos ou variáveis de preferência em determinar o que deverá ser apresentado ao utilizador.</span><span class="sxs-lookup"><span data-stu-id="0a01c-209">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed to the user.</span></span>

<span data-ttu-id="0a01c-210">Após a chamada para [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) devolve `true`, o [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) método deve chamar o [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método.</span><span class="sxs-lookup"><span data-stu-id="0a01c-210">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="0a01c-211">Este método envia uma mensagem ao utilizador para permitir que os seus comentários para dizer se deve ser contínuo a operação.</span><span class="sxs-lookup"><span data-stu-id="0a01c-211">This method sends a message to the user to allow feedback to say if the operation should be continued.</span></span> <span data-ttu-id="0a01c-212">O fornecedor deve chamar [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) como uma verificação adicional para as modificações de sistema potencialmente perigosas.</span><span class="sxs-lookup"><span data-stu-id="0a01c-212">Your provider should call [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-move-item-cmdlet"></a><span data-ttu-id="0a01c-213">Anexar parâmetros dinâmicos para o Cmdlet Move-Item</span><span class="sxs-lookup"><span data-stu-id="0a01c-213">Attaching Dynamic Parameters to the Move-Item Cmdlet</span></span>

<span data-ttu-id="0a01c-214">Por vezes, o `Move-Item` cmdlet requer parâmetros adicionais que são fornecidos dinamicamente no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="0a01c-214">Sometimes the `Move-Item` cmdlet requires additional parameters that are provided dynamically at runtime.</span></span> <span data-ttu-id="0a01c-215">Para fornecer estes parâmetros dinâmicos, o fornecedor de navegação tem de implementar o [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters) método para obter os valores de parâmetro necessário do item no caminho indicado e devolver um objeto com propriedades e campos com análise atributos semelhante a uma classe cmdlet ou uma [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="0a01c-215">To provide these dynamic parameters, the navigation provider must implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters) method to get the required parameter values from the item at the indicated path, and return an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span>

<span data-ttu-id="0a01c-216">Este fornecedor de navegação não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="0a01c-216">This navigation provider does not implement this method.</span></span> <span data-ttu-id="0a01c-217">No entanto, o código a seguir é a implementação padrão da [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="0a01c-217">However, the following code is the default implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermoveitemdynamicparameters](Msh_samplestestcmdlets#testprovidermoveitemdynamicparameters)]  -->

## <a name="normalizing-a-relative-path"></a><span data-ttu-id="0a01c-218">Normalizar um caminho relativo</span><span class="sxs-lookup"><span data-stu-id="0a01c-218">Normalizing a Relative Path</span></span>

<span data-ttu-id="0a01c-219">Sua implementa de fornecedor de navegação da [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) método normalizar o caminho totalmente qualificado indicado no `path` parâmetro como sendo relativo ao caminho especificado pelo `basePath` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="0a01c-219">Your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) method to normalize the fully-qualified path indicated in the `path` parameter as being relative to the path specified by the `basePath` parameter.</span></span> <span data-ttu-id="0a01c-220">O método retorna uma representação de cadeia de caracteres do caminho normalizado.</span><span class="sxs-lookup"><span data-stu-id="0a01c-220">The method returns a string representation of the normalized path.</span></span> <span data-ttu-id="0a01c-221">Ele escreve um erro se o `path` parâmetro especifica um caminho não existe.</span><span class="sxs-lookup"><span data-stu-id="0a01c-221">It writes an error if the `path` parameter specifies a nonexistent path.</span></span>

<span data-ttu-id="0a01c-222">O exemplo de provedor de navegação não substitui este método.</span><span class="sxs-lookup"><span data-stu-id="0a01c-222">The sample navigation provider does not override this method.</span></span> <span data-ttu-id="0a01c-223">Segue-se a implementação padrão.</span><span class="sxs-lookup"><span data-stu-id="0a01c-223">The following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernormalizepath](Msh_samplestestcmdlets#testprovidernormalizepath)]  -->

#### <a name="things-to-remember-about-implementing-normalizerelativepath"></a><span data-ttu-id="0a01c-224">Coisas a serem lembrados sobre a implementação NormalizeRelativePath</span><span class="sxs-lookup"><span data-stu-id="0a01c-224">Things to Remember About Implementing NormalizeRelativePath</span></span>

<span data-ttu-id="0a01c-225">A implementação do [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) deve analisar o `path` parâmetro, mas não tem de utilizar a análise puramente sintática.</span><span class="sxs-lookup"><span data-stu-id="0a01c-225">Your implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) should parse the `path` parameter, but it does not have to use purely syntactical parsing.</span></span> <span data-ttu-id="0a01c-226">Incentivamos o design corresponde a este método para utilizar o caminho para procurar as informações de caminho no arquivo de dados e criar um caminho que as maiúsculas e minúsculas e padronizados a sintaxe do caminho.</span><span class="sxs-lookup"><span data-stu-id="0a01c-226">You are encouraged to design this method to use the path to look up the path information in the data store and create a path that matches the casing and standardized path syntax.</span></span>

## <a name="code-sample"></a><span data-ttu-id="0a01c-227">Exemplo de código</span><span class="sxs-lookup"><span data-stu-id="0a01c-227">Code Sample</span></span>

<span data-ttu-id="0a01c-228">Para o código de exemplo completo, consulte [exemplo de código AccessDbProviderSample05](./accessdbprovidersample05-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="0a01c-228">For complete sample code, see [AccessDbProviderSample05 Code Sample](./accessdbprovidersample05-code-sample.md).</span></span>

## <a name="defining-object-types-and-formatting"></a><span data-ttu-id="0a01c-229">Definir tipos de objeto e formatação</span><span class="sxs-lookup"><span data-stu-id="0a01c-229">Defining Object Types and Formatting</span></span>

<span data-ttu-id="0a01c-230">É possível que um fornecedor adicionar membros a objetos existentes ou definir novos objetos.</span><span class="sxs-lookup"><span data-stu-id="0a01c-230">It is possible for a provider to add members to existing objects or define new objects.</span></span> <span data-ttu-id="0a01c-231">Para obter mais informações, consulte[estendendo tipos de objeto e formatação](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span><span class="sxs-lookup"><span data-stu-id="0a01c-231">For more information, see[Extending Object Types and Formatting](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="0a01c-232">Criando o provedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="0a01c-232">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="0a01c-233">Para obter mais informações, consulte [como registrar Cmdlets, fornecedores e alojar aplicações](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="0a01c-233">For more information, see [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="0a01c-234">Teste o fornecedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="0a01c-234">Testing the Windows PowerShell provider</span></span>

<span data-ttu-id="0a01c-235">Quando o seu fornecedor de Windows PowerShell foi registado com o Windows PowerShell, pode testá-lo ao executar os cmdlets suportados na linha de comando, incluindo cmdlets disponibilizados pela derivação.</span><span class="sxs-lookup"><span data-stu-id="0a01c-235">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line, including cmdlets made available by derivation.</span></span> <span data-ttu-id="0a01c-236">Neste exemplo testará o provedor de navegação de exemplo.</span><span class="sxs-lookup"><span data-stu-id="0a01c-236">This example will test the sample navigation provider.</span></span>

1. <span data-ttu-id="0a01c-237">Execute o seu novo shell e utilize o `Set-Location` cmdlet para definir o caminho para indicar o banco de dados do Access.</span><span class="sxs-lookup"><span data-stu-id="0a01c-237">Run your new shell and use the `Set-Location` cmdlet to set the path to indicate the Access database.</span></span>

   ```powershell
   Set-Location mydb:
   ```

2. <span data-ttu-id="0a01c-238">Agora, execute o `Get-Childitem` cmdlet para obter uma lista dos itens da base de dados, que são as tabelas de base de dados disponíveis.</span><span class="sxs-lookup"><span data-stu-id="0a01c-238">Now run the `Get-Childitem` cmdlet to retrieve a list of the database items, which are the available database tables.</span></span> <span data-ttu-id="0a01c-239">Para cada tabela, este cmdlet obtém também o número de linhas de tabela.</span><span class="sxs-lookup"><span data-stu-id="0a01c-239">For each table, this cmdlet also retrieves the number of table rows.</span></span>

   ```powershell
   Get-ChildItem | Format-Table rowcount,name -AutoSize
   ```

   ```output
   RowCount   Name
   --------   ----
        180   MSysAccessObjects
          0   MSysACEs
          1   MSysCmdbars
          0   MSysIMEXColumns
          0   MSysIMEXSpecs
          0   MSysObjects
          0   MSysQueries
          7   MSysRelationships
          8   Categories
         91   Customers
          9   Employees
       2155   Order Details
        830   Orders
         77   Products
          3   Shippers
         29   Suppliers
   ```

3. <span data-ttu-id="0a01c-240">Utilize o `Set-Location` cmdlet novamente para definir o local da tabela de dados de funcionários.</span><span class="sxs-lookup"><span data-stu-id="0a01c-240">Use the `Set-Location` cmdlet again to set the location of the Employees data table.</span></span>

   ```powershell
   Set-Location Employees
   ```

4. <span data-ttu-id="0a01c-241">Agora, vamos utilizar o `Get-Location` cmdlet para obter o caminho para a tabela de funcionários.</span><span class="sxs-lookup"><span data-stu-id="0a01c-241">Let's now use the `Get-Location` cmdlet to retrieve the path to the Employees table.</span></span>

   ```powershell
   Get-Location
   ```

   ```output
   Path
   ----
   mydb:\Employees
   ```

5. <span data-ttu-id="0a01c-242">Agora utilizar o `Get-Childitem` cmdlet enviado por pipe para o `Format-Table` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="0a01c-242">Now use the `Get-Childitem` cmdlet piped to the `Format-Table` cmdlet.</span></span> <span data-ttu-id="0a01c-243">Este conjunto de cmdlets recupera os itens para a tabela de dados de funcionários, que são as linhas de tabela.</span><span class="sxs-lookup"><span data-stu-id="0a01c-243">This set of cmdlets retrieves the items for the Employees data table, which are the table rows.</span></span> <span data-ttu-id="0a01c-244">São formatados como especificado pelo `Format-Table` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="0a01c-244">They are formatted as specified by the `Format-Table` cmdlet.</span></span>

   ```powershell
   Get-ChildItem | Format-Table rownumber,psiscontainer,data -AutoSize
   ```

   ```output
   RowNumber   PSIsContainer   Data
   ---------   --------------   ----
   0           False            System.Data.DataRow
   1           False            System.Data.DataRow
   2           False            System.Data.DataRow
   3           False            System.Data.DataRow
   4           False            System.Data.DataRow
   5           False            System.Data.DataRow
   6           False            System.Data.DataRow
   7           False            System.Data.DataRow
   8           False            System.Data.DataRow
   ```

6. <span data-ttu-id="0a01c-245">Agora, pode executar o `Get-Item` cmdlet para obter os itens para 0 de linha da tabela de dados de funcionários.</span><span class="sxs-lookup"><span data-stu-id="0a01c-245">You can now run the `Get-Item` cmdlet to retrieve the items for row 0 of the Employees data table.</span></span>

   ```powershell
   Get-Item 0
   ```

   ```output
   PSPath        : AccessDB::C:\PS\Northwind.mdb\Employees\0
   PSParentPath  : AccessDB::C:\PS\Northwind.mdb\Employees
   PSChildName   : 0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data           : System.Data.DataRow
   RowNumber      : 0
   ```

7. <span data-ttu-id="0a01c-246">Utilize o `Get-Item` cmdlet novamente para obter os dados de funcionários para os itens na linha 0.</span><span class="sxs-lookup"><span data-stu-id="0a01c-246">Use the `Get-Item` cmdlet again to retrieve the employee data for the items in row 0.</span></span>

   ```powershell
   (Get-Item 0).data
   ```

   ```output
   EmployeeID      : 1
   LastName        : Davis
   FirstName       : Sara
   Title           : Sales Representative
   TitleOfCourtesy : Ms.
   BirthDate       : 12/8/1968 12:00:00 AM
   HireDate        : 5/1/1992 12:00:00 AM
   Address         : 4567 Main Street
                     Apt. 2A
   City            : Buffalo
   Region          : NY
   PostalCode      : 98052
   Country         : USA
   HomePhone       : (206) 555-9857
   Extension       : 5467
   Photo           : EmpID1.bmp
   Notes           : Education includes a BA in psychology from
                     Colorado State University. She also completed "The
                     Art of the Cold Call."  Nancy is a member of
                     Toastmasters International.
   ReportsTo       : 2
   ```

## <a name="see-also"></a><span data-ttu-id="0a01c-247">Veja Também</span><span class="sxs-lookup"><span data-stu-id="0a01c-247">See Also</span></span>

[<span data-ttu-id="0a01c-248">Criar fornecedores de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="0a01c-248">Creating Windows PowerShell providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="0a01c-249">Fornecedor do design do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="0a01c-249">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="0a01c-250">Estendendo tipos de objeto e formatação</span><span class="sxs-lookup"><span data-stu-id="0a01c-250">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="0a01c-251">Implementar um fornecedor de contentor Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="0a01c-251">Implement a Container Windows PowerShell provider</span></span>](./creating-a-windows-powershell-container-provider.md)

[<span data-ttu-id="0a01c-252">Como registar os Cmdlets, fornecedores e alojar aplicações</span><span class="sxs-lookup"><span data-stu-id="0a01c-252">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="0a01c-253">Guia do programador do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="0a01c-253">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="0a01c-254">SDK do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="0a01c-254">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)