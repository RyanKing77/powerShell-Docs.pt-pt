---
title: Criar um fornecedor de contentor do Windows PowerShell | Documentos da Microsoft
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- providers [PowerShell Programmer's Guide], container provider
- container providers [PowerShell Programmer's Guide]
ms.assetid: a7926647-0d18-45b2-967e-b31f92004bc4
caps.latest.revision: 5
ms.openlocfilehash: e0d83a742eae2bcde2e691860a5f2b3e5862d2de
ms.sourcegitcommit: 69abc5ad16e5dd29ddfb1853e266a4bfd1d59d59
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 03/05/2019
ms.locfileid: "57430046"
---
# <a name="creating-a-windows-powershell-container-provider"></a><span data-ttu-id="a1b7a-102">Creating a Windows PowerShell Container Provider (Criar um Fornecedor de Contentores do Windows PowerShell)</span><span class="sxs-lookup"><span data-stu-id="a1b7a-102">Creating a Windows PowerShell Container Provider</span></span>

<span data-ttu-id="a1b7a-103">Este tópico descreve como criar um fornecedor de Windows PowerShell que pode trabalhar nos arquivos de dados de camada multi.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-103">This topic describes how to create a Windows PowerShell provider that can work on multi-layer data stores.</span></span> <span data-ttu-id="a1b7a-104">Para este tipo de arquivo de dados, o nível superior do arquivo contém os itens de raiz e cada nível subseqüente é referido como um nó de itens subordinados.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-104">For this type of data store, the top level of the store contains the root items and each subsequent level is referred to as a node of child items.</span></span> <span data-ttu-id="a1b7a-105">Ao permitir que o utilizador trabalhar em de nós subordinados, um usuário pode interagir hierarquicamente por meio do arquivo de dados.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-105">By allowing the user to work on these child nodes, a user can interact hierarchically through the data store.</span></span>

<span data-ttu-id="a1b7a-106">Fornecedores que podem trabalhar nos arquivos de dados de múltiplos níveis são referidos como fornecedores de contentor do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-106">Providers that can work on multi-level data stores are referred to as Windows PowerShell container providers.</span></span> <span data-ttu-id="a1b7a-107">No entanto, lembre-se de que um fornecedor de contentor do Windows PowerShell pode ser usado apenas quando existe um contentor (não existem contentores aninhadas) com os itens no mesmo.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-107">However, be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="a1b7a-108">Se existirem contêineres aninhados, em seguida, deve implementar um fornecedor de navegação do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-108">If there are nested containers, then you must implement a Windows PowerShell navigation provider.</span></span> <span data-ttu-id="a1b7a-109">Para obter mais informações sobre a implementação de fornecedor de navegação do Windows PowerShell, consulte [criar um fornecedor de navegação do Windows PowerShell](./creating-a-windows-powershell-navigation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-109">For more information about implementing Windows PowerShell navigation provider, see [Creating a Windows PowerShell Navigation Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

> [!NOTE]
> <span data-ttu-id="a1b7a-110">Pode transferir o C# ficheiro de origem (AccessDBSampleProvider04.cs) para este fornecedor com o Microsoft Windows Software Development Kit para Windows Vista e o .NET Framework 3.0 Runtime Components.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-110">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="a1b7a-111">Para obter instruções de transferência, consulte [como instalar o Windows PowerShell e transferir o SDK do Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-111">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="a1b7a-112">Os arquivos de fonte transferido estão disponíveis no  **\<exemplos do PowerShell >** diretório.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-112">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="a1b7a-113">Para obter mais informações sobre outras implementações de provedores do Windows PowerShell, consulte [conceber Windows PowerShell Fornecedor_de_e](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-113">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="a1b7a-114">O fornecedor de contentor do Windows PowerShell descrito aqui define a base de dados como respetivo contentor único, com as tabelas e linhas de base de dados definidos como itens do contentor.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-114">The Windows PowerShell container provider described here defines the database as its single container, with the tables and rows of the database defined as items of the container.</span></span>

> [!CAUTION]
> <span data-ttu-id="a1b7a-115">Lembre-se de que esse design supõe que uma base de dados que tem um campo com o ID de nome e de que o tipo do campo é LongInteger.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-115">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

<span data-ttu-id="a1b7a-116">Aqui está uma lista das secções seguintes deste tópico.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-116">Here is a list of the sections in this topic.</span></span> <span data-ttu-id="a1b7a-117">Se não estiver familiarizado com a escrita de um fornecedor de contentor do Windows PowerShell, leia estas informações na ordem em que ele é exibido.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-117">If you are unfamiliar with writing a Windows PowerShell container provider, please read this information in the order that it appears.</span></span> <span data-ttu-id="a1b7a-118">No entanto, se estiver familiarizado com a escrita de um fornecedor de contentor do Windows PowerShell, aceda diretamente às informações de que precisa.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-118">However, if you are familiar with writing a Windows PowerShell container provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="a1b7a-119">Definir uma classe de fornecedor de contentor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a1b7a-119">Defining a Windows PowerShell Container Provider Class</span></span>](#Defining-a-Windows-PowerShell-Container-Provider-Class)

- [<span data-ttu-id="a1b7a-120">Definir funcionalidade de Base</span><span class="sxs-lookup"><span data-stu-id="a1b7a-120">Defining Base Functionality</span></span>]()

- [<span data-ttu-id="a1b7a-121">A obter itens subordinados</span><span class="sxs-lookup"><span data-stu-id="a1b7a-121">Retrieving Child Items</span></span>](#Retrieving-Child-Items)

- [<span data-ttu-id="a1b7a-122">Os parâmetros dinâmicos para a anexar o `Get-ChildItem` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a1b7a-122">Attaching Dynamic Parameters to the `Get-ChildItem` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet)

- [<span data-ttu-id="a1b7a-123">Obter os nomes de Item subordinado</span><span class="sxs-lookup"><span data-stu-id="a1b7a-123">Retrieving Child Item Names</span></span>](#Retrieving-Child-Item-Names)

- <span data-ttu-id="a1b7a-124">[Os parâmetros dinâmicos para a anexar o `Get-ChildItem` Cmdlet (nome)](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet-(Name))</span><span class="sxs-lookup"><span data-stu-id="a1b7a-124">[Attaching Dynamic Parameters to the `Get-ChildItem` Cmdlet (Name)](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet-(Name))</span></span>

- [<span data-ttu-id="a1b7a-125">Mudar o nome de itens</span><span class="sxs-lookup"><span data-stu-id="a1b7a-125">Renaming Items</span></span>](#Renaming-Items)

- [<span data-ttu-id="a1b7a-126">Os parâmetros dinâmicos para a anexar o `Rename-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a1b7a-126">Attaching Dynamic Parameters to the  `Rename-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Rename-Item-Cmdlet)

- [<span data-ttu-id="a1b7a-127">Criação de novos itens</span><span class="sxs-lookup"><span data-stu-id="a1b7a-127">Creating New Items</span></span>](#Creating-New-Items)

- [<span data-ttu-id="a1b7a-128">Os parâmetros dinâmicos para a anexar o `New-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a1b7a-128">Attaching Dynamic Parameters to the `New-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-New-Item-Cmdlet)

- [<span data-ttu-id="a1b7a-129">Remover um itens</span><span class="sxs-lookup"><span data-stu-id="a1b7a-129">Removing a Items</span></span>](#Removing-Items)

- [<span data-ttu-id="a1b7a-130">Os parâmetros dinâmicos para a anexar o `Remove-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a1b7a-130">Attaching Dynamic Parameters to the `Remove-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Remove-Item-Cmdlet)

- [<span data-ttu-id="a1b7a-131">Consulta para os itens subordinados</span><span class="sxs-lookup"><span data-stu-id="a1b7a-131">Querying for Child Items</span></span>](#Querying-for-Child-Items)

- [<span data-ttu-id="a1b7a-132">Copiar itens</span><span class="sxs-lookup"><span data-stu-id="a1b7a-132">Coping Items</span></span>](#Copying-Items)

- [<span data-ttu-id="a1b7a-133">Os parâmetros dinâmicos para a anexar o `Copy-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a1b7a-133">Attaching Dynamic Parameters to the  `Copy-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Copy-Item-Cmdlet)

- [<span data-ttu-id="a1b7a-134">Exemplo de código</span><span class="sxs-lookup"><span data-stu-id="a1b7a-134">Code Sample</span></span>](#Code-Sample)

- [<span data-ttu-id="a1b7a-135">Definir tipos de objeto e formatação</span><span class="sxs-lookup"><span data-stu-id="a1b7a-135">Defining Object Types and Formatting</span></span>]()

- [<span data-ttu-id="a1b7a-136">Criando o provedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a1b7a-136">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-Provider)

- [<span data-ttu-id="a1b7a-137">Teste o fornecedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a1b7a-137">Testing the Windows PowerShell Provider</span></span>](#Testing-the-Windows-PowerShell-Provider)

## <a name="defining-a-windows-powershell-container-provider-class"></a><span data-ttu-id="a1b7a-138">Definir uma classe de fornecedor de contentor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a1b7a-138">Defining a Windows PowerShell Container Provider Class</span></span>

<span data-ttu-id="a1b7a-139">Um provedor de contentor do Windows PowerShell tem de definir uma classe do .NET que deriva de [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) classe base.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-139">A Windows PowerShell container provider must define a .NET class that derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="a1b7a-140">Esta é a definição de classe para o fornecedor de contentor do Windows PowerShell descrita nesta secção.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-140">Here is the class definition for the Windows PowerShell container provider described in this section.</span></span>

```csharp
   [CmdletProvider("AccessDB", ProviderCapabilities.None)]
   public class AccessDBProvider : ContainerCmdletProvider
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L34-L35 "AccessDBProviderSample04.cs")]

<span data-ttu-id="a1b7a-141">Tenha em atenção que, desta definição, de classe a [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) atributo inclui dois parâmetros.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-141">Notice that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="a1b7a-142">O primeiro parâmetro especifica um nome amigável para o fornecedor que é utilizado pelo Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-142">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="a1b7a-143">O segundo parâmetro especifica os recursos específicos do Windows PowerShell que o fornecedor expõe o tempo de execução do Windows PowerShell durante o processamento do comando.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-143">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="a1b7a-144">Para este fornecedor, não há nenhum capacidades específicas do Windows PowerShell que são adicionadas.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-144">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="a1b7a-145">Definir funcionalidade de Base</span><span class="sxs-lookup"><span data-stu-id="a1b7a-145">Defining Base Functionality</span></span>

<span data-ttu-id="a1b7a-146">Conforme descrito em [conceber Windows PowerShell Fornecedor_de_e](./designing-your-windows-powershell-provider.md), o [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) classe deriva de outras classes que fornecido funcionalidade de outro fornecedor.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-146">As described in [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="a1b7a-147">Um provedor de contentor do Windows PowerShell, por conseguinte, tem de definir todas as funcionalidades fornecidas por essas classes.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-147">A Windows PowerShell container provider, therefore, needs to define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="a1b7a-148">Para implementar a funcionalidade para adicionar informações de inicialização de específico da sessão e para liberar os recursos que são utilizados pelo fornecedor, veja [criar um fornecedor de PowerShell básica do Windows](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-148">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="a1b7a-149">No entanto, a maioria dos provedores de (incluindo o fornecedor descrito aqui) pode utilizar a implementação padrão dessa funcionalidade fornecida pelo Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-149">However, most providers (including the provider described here) can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="a1b7a-150">Para obter acesso ao arquivo de dados, o fornecedor tem de implementar os métodos do [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) classe base.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-150">To get access to the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="a1b7a-151">Para obter mais informações sobre a implementação desses métodos, consulte [criar um fornecedor de unidade do Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-151">For more information about implementing these methods, see [Creating an Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="a1b7a-152">Para manipular os itens de um armazenamento de dados, como obter, configuração e itens de limpeza, o fornecedor tem de implementar os métodos fornecidos pela [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) classe base.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-152">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="a1b7a-153">Para obter mais informações sobre a implementação desses métodos, consulte [criar um fornecedor de Item do Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-153">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

## <a name="retrieving-child-items"></a><span data-ttu-id="a1b7a-154">A obter itens subordinados</span><span class="sxs-lookup"><span data-stu-id="a1b7a-154">Retrieving Child Items</span></span>

<span data-ttu-id="a1b7a-155">Para obter um item subordinado, o fornecedor de contentor do Windows PowerShell tem de substituir a [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método para oferecer suporte a chamadas a partir do `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-155">To retrieve a child item, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method to support calls from the `Get-ChildItem` cmdlet.</span></span> <span data-ttu-id="a1b7a-156">Esse método obtém itens filho do arquivo de dados e escreve-as para o pipeline como objetos.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-156">This method retrieves child items from the data store and writes them to the pipeline as objects.</span></span> <span data-ttu-id="a1b7a-157">Se o `recurse` parâmetro do cmdlet for especificado, o método recupera todos os filhos, independentemente de qual o nível estão em.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-157">If the `recurse` parameter of the cmdlet is specified, the method retrieves all children regardless of what level they are at.</span></span> <span data-ttu-id="a1b7a-158">Se o `recurse` parâmetro não for especificado, o método obtém um único nível de subordinados.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-158">If the `recurse` parameter is not specified, the method retrieves only a single level of children.</span></span>

<span data-ttu-id="a1b7a-159">Eis a implementação do [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método para este fornecedor.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-159">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method for this provider.</span></span> <span data-ttu-id="a1b7a-160">Tenha em atenção que este método obtém os itens subordinados em todas as tabelas de base de dados quando o caminho indica o banco de dados do Access e obtém os itens subordinados das linhas da tabela, se o caminho indica uma tabela de dados.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-160">Notice that this method retrieves the child items in all database tables when the path indicates the Access database, and retrieves the child items from the rows of that table if the path indicates a data table.</span></span>

```csharp
protected override void GetChildItems(string path, bool recurse)
{
    // If path represented is a drive then the children in the path are
    // tables. Hence all tables in the drive represented will have to be
    // returned
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table, path, true);

            // if the specified item exists and recurse has been set then
            // all child items within it have to be obtained as well
            if (ItemExists(path) && recurse)
            {
                GetChildItems(path + pathSeparator + table.Name, recurse);
            }
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get the table name, row number and type of path from the
        // path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Obtain all the rows within the table
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);
            WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
        }
        else
        {
            // In this case, the path specified is not valid
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L311-L362 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchilditems"></a><span data-ttu-id="a1b7a-161">Coisas a serem lembrados sobre a implementação GetChildItems</span><span class="sxs-lookup"><span data-stu-id="a1b7a-161">Things to Remember About Implementing GetChildItems</span></span>

<span data-ttu-id="a1b7a-162">As seguintes condições podem aplicar-se na implementação [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="a1b7a-162">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="a1b7a-163">Ao definir a classe do provedor, um provedor de contentor do Windows PowerShell poderia declarar capacidades de fornecedor de ExpandWildcards, filtro, inclusão ou exclusão, da [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeração.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-163">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="a1b7a-164">Nestes casos, a implementação do [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método precisa para se certificar de que o caminho transmitido ao método cumpre os requisitos do especificado capacidades.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-164">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="a1b7a-165">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, o [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriedades.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-165">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="a1b7a-166">A implementação desse método deve levar em conta nenhuma forma de acesso para o item que pode tornar o item visível ao utilizador.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-166">The implementation of this method should take into account any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="a1b7a-167">Por exemplo, se um utilizador tem acesso de escrita para um ficheiro através do fornecedor do sistema de ficheiros (fornecido pelo Windows PowerShell), mas não acesso de leitura, o ficheiro ainda existe e [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) retorna `true`.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-167">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="a1b7a-168">A implementação pode requerer a verificação de um item de principal para ver se o filho que pode ser enumerado.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-168">Your implementation might require the checking of a parent item to see if the child can be enumerated.</span></span>

- <span data-ttu-id="a1b7a-169">Ao escrever a vários itens, o [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método pode demorar algum tempo.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-169">When writing multiple items, the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method can take some time.</span></span> <span data-ttu-id="a1b7a-170">Pode projetar o seu fornecedor para escrever os itens com o [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) método um por vez.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-170">You can design your provider to write the items using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method one at a time.</span></span> <span data-ttu-id="a1b7a-171">Usando essa técnica irá apresentar os itens ao usuário num fluxo.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-171">Using this technique will present the items to the user in a stream.</span></span>

- <span data-ttu-id="a1b7a-172">A implementação do [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) é responsável por impedir recursão infinita quando existem ligações circulares e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-172">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="a1b7a-173">Deve ser emitida uma exceção de terminação apropriada para refletir esse uma condição.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-173">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet"></a><span data-ttu-id="a1b7a-174">Anexar parâmetros dinâmicos para o Cmdlet Get-ChildItem</span><span class="sxs-lookup"><span data-stu-id="a1b7a-174">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet</span></span>

<span data-ttu-id="a1b7a-175">Por vezes, o `Get-ChildItem` cmdlet que chama [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requer parâmetros adicionais que são especificados dinamicamente no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-175">Sometimes the `Get-ChildItem` cmdlet that calls [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="a1b7a-176">Para fornecer estes parâmetros dinâmicos, o fornecedor de contentor do Windows PowerShell tem de implementar o [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-176">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) method.</span></span> <span data-ttu-id="a1b7a-177">Esse método obtém parâmetros dinâmicos para o item no caminho indicado e retorna um objeto com propriedades e campos com análise atributos semelhantes a uma classe cmdlet ou uma [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-177">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="a1b7a-178">O tempo de execução do Windows PowerShell usa o objeto devolvido para adicionar os parâmetros para o `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-178">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="a1b7a-179">Este fornecedor de contentor do Windows PowerShell não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-179">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="a1b7a-180">No entanto, o código a seguir é a implementação do padrão desse método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-180">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters](Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters)]  -->

## <a name="retrieving-child-item-names"></a><span data-ttu-id="a1b7a-181">Obter os nomes de Item subordinado</span><span class="sxs-lookup"><span data-stu-id="a1b7a-181">Retrieving Child Item Names</span></span>

<span data-ttu-id="a1b7a-182">Para obter os nomes de itens subordinados, o fornecedor de contentor do Windows PowerShell tem de substituir a [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) método para oferecer suporte a chamadas a partir do `Get-ChildItem`cmdlet quando seu `Name` parâmetro for especificado.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-182">To retrieve the names of child items, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method to support calls from the `Get-ChildItem` cmdlet when its `Name` parameter is specified.</span></span> <span data-ttu-id="a1b7a-183">Este método obtém os nomes dos itens subordinados para os nomes de item de caminho ou subordinado especificados para todos os contentores, se o `returnAllContainers` é especificado o parâmetro do cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-183">This method retrieves the names of the child items for the specified path or child item names for all containers if the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="a1b7a-184">Um nome de subordinado é a parte de folha de um caminho.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-184">A child name is the leaf portion of a path.</span></span> <span data-ttu-id="a1b7a-185">Por exemplo, o nome de subordinados para o caminho c:\windows\system32\abc.dll é "abc.dll".</span><span class="sxs-lookup"><span data-stu-id="a1b7a-185">For example, the child name for the path c:\windows\system32\abc.dll is "abc.dll".</span></span> <span data-ttu-id="a1b7a-186">O nome de subordinados para o diretório c:\windows\system32 é "system32".</span><span class="sxs-lookup"><span data-stu-id="a1b7a-186">The child name for the directory c:\windows\system32 is "system32".</span></span>

<span data-ttu-id="a1b7a-187">Eis a implementação do [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) método para este fornecedor.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-187">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method for this provider.</span></span> <span data-ttu-id="a1b7a-188">Tenha em atenção que o método obtém nomes de tabela, se o caminho especificado indica o banco de dados do Access (unidade) e números de linha se o caminho indica uma tabela.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-188">Notice that the method retrieves table names if the specified path indicates the Access database (drive) and row numbers if the path indicates a table.</span></span>

```csharp
protected override void GetChildNames(string path,
                            ReturnContainers returnContainers)
{
    // If the path represented is a drive, then the child items are
    // tables. get the names of all the tables in the drive.
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table.Name, path, true);
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get type, table name and row number from path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Get all the rows in the table and then write out the
            // row numbers.
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row.RowNumber, path, false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);

            WriteItemObject(row.RowNumber, path, false);
        }
        else
        {
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildNames
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L369-L411 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchildnames"></a><span data-ttu-id="a1b7a-189">Coisas a serem lembrados sobre a implementação GetChildNames</span><span class="sxs-lookup"><span data-stu-id="a1b7a-189">Things to Remember About Implementing GetChildNames</span></span>

<span data-ttu-id="a1b7a-190">As seguintes condições podem aplicar-se na implementação [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="a1b7a-190">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="a1b7a-191">Ao definir a classe do provedor, um provedor de contentor do Windows PowerShell poderia declarar capacidades de fornecedor de ExpandWildcards, filtro, inclusão ou exclusão, da [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeração.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-191">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="a1b7a-192">Nestes casos, a implementação do [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método precisa para se certificar de que o caminho transmitido ao método cumpre os requisitos do especificado capacidades.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-192">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="a1b7a-193">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, o [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriedades.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-193">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

  > [!NOTE]
  > <span data-ttu-id="a1b7a-194">Ocorre uma exceção a esta regra quando o `returnAllContainers` é especificado o parâmetro do cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-194">An exception to this rule occurs when the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="a1b7a-195">Neste caso, o método deve recuperar qualquer nome de subordinados para um contentor, mesmo que não corresponde aos valores do [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), ou [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) propriedades.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-195">In this case, the method should retrieve any child name for a container, even if it does not match the values of the [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), or [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) properties.</span></span>

- <span data-ttu-id="a1b7a-196">Por predefinição, substituições deste método não devem obter nomes de objetos que geralmente estão ocultos do utilizador, a menos que o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) é especificada a propriedade.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-196">By default, overrides of this method should not retrieve names of objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="a1b7a-197">Se o caminho especificado indica um contentor, o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriedade não é necessária.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-197">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="a1b7a-198">A implementação do [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) é responsável por impedir recursão infinita quando existem ligações circulares e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-198">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="a1b7a-199">Deve ser emitida uma exceção de terminação apropriada para refletir esse uma condição.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-199">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet-name"></a><span data-ttu-id="a1b7a-200">Anexar parâmetros dinâmicos para o Cmdlet Get-ChildItem (nome)</span><span class="sxs-lookup"><span data-stu-id="a1b7a-200">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet (Name)</span></span>

<span data-ttu-id="a1b7a-201">Por vezes, o `Get-ChildItem` cmdlet (com o `Name` parâmetro) requer parâmetros adicionais que são especificados dinamicamente no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-201">Sometimes the `Get-ChildItem` cmdlet (with the `Name` parameter) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="a1b7a-202">Para fornecer estes parâmetros dinâmicos, o fornecedor de contentor do Windows PowerShell tem de implementar o [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-202">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) method.</span></span> <span data-ttu-id="a1b7a-203">Esse método obtém os parâmetros dinâmicos para o item no caminho indicado e retorna um objeto com propriedades e campos com análise atributos semelhantes a uma classe cmdlet ou uma [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-203">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="a1b7a-204">O tempo de execução do Windows PowerShell usa o objeto devolvido para adicionar os parâmetros para o `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-204">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="a1b7a-205">Este fornecedor não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-205">This provider does not implement this method.</span></span> <span data-ttu-id="a1b7a-206">No entanto, o código a seguir é a implementação do padrão desse método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-206">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters](Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters)]  -->

## <a name="renaming-items"></a><span data-ttu-id="a1b7a-207">Mudar o nome de itens</span><span class="sxs-lookup"><span data-stu-id="a1b7a-207">Renaming Items</span></span>

<span data-ttu-id="a1b7a-208">Para mudar o nome de um item, um provedor de contentor do Windows PowerShell tem de substituir a [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) método para oferecer suporte a chamadas a partir do `Rename-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-208">To rename an item, a Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method to support calls from the `Rename-Item` cmdlet.</span></span> <span data-ttu-id="a1b7a-209">Esse método altera o nome do item no caminho especificado para o novo nome fornecido.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-209">This method changes the name of the item at the specified path to the new name provided.</span></span> <span data-ttu-id="a1b7a-210">O novo nome tem de ser sempre em relação ao item principal (contentor).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-210">The new name must always be relative to the parent item (container).</span></span>

<span data-ttu-id="a1b7a-211">Este fornecedor não substitui a [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-211">This provider does not override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method.</span></span> <span data-ttu-id="a1b7a-212">No entanto, segue-se a implementação padrão.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-212">However, the following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitem](Msh_samplestestcmdlets#testproviderrenameitem)]  -->

#### <a name="things-to-remember-about-implementing-renameitem"></a><span data-ttu-id="a1b7a-213">Coisas a serem lembrados sobre a implementação RenameItem</span><span class="sxs-lookup"><span data-stu-id="a1b7a-213">Things to Remember About Implementing RenameItem</span></span>

<span data-ttu-id="a1b7a-214">As seguintes condições podem aplicar-se na implementação [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span><span class="sxs-lookup"><span data-stu-id="a1b7a-214">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span></span>

- <span data-ttu-id="a1b7a-215">Ao definir a classe do provedor, um provedor de contentor do Windows PowerShell poderia declarar capacidades de fornecedor de ExpandWildcards, filtro, inclusão ou exclusão, da [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeração.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-215">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="a1b7a-216">Nestes casos, a implementação do [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método precisa para se certificar de que o caminho transmitido ao método cumpre os requisitos do especificado capacidades.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-216">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="a1b7a-217">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, o [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriedades.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-217">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="a1b7a-218">O [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) método destina-se para a modificação do nome de um item apenas e não para operações de movimentação.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-218">The [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method is intended for the modification of the name of an item only, and not for move operations.</span></span> <span data-ttu-id="a1b7a-219">A implementação do método deve escrever um erro se o `newName` parâmetro contém separadores de caminho ou, caso contrário, pode fazer com que o item Alterar a localização principal.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-219">Your implementation of the method should write an error if the `newName` parameter contains path separators, or might otherwise cause the item to change its parent location.</span></span>

- <span data-ttu-id="a1b7a-220">Por predefinição, substituições desse método devem não mudar o nome de objetos, a menos que o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) é especificada a propriedade.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-220">By default, overrides of this method should not rename objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="a1b7a-221">Se o caminho especificado indica um contentor, o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriedade não é necessária.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-221">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="a1b7a-222">Sua implementação do [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) deve chamar o método [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e verifique o valor de retorno antes de fazer alterações ao arquivo de dados.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-222">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="a1b7a-223">Este método é usado para confirmar a execução de uma operação quando é efetuada uma alteração de estado do sistema, por exemplo, mudar o nome de ficheiros.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-223">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="a1b7a-224">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) envia o nome do recurso a ser alterados ao usuário, com o tempo de execução do Windows PowerShell tendo em conta as definições de linha de comandos ou variáveis de preferência em determinar o que deverá ser apresentado.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-224">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="a1b7a-225">Após a chamada para [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) devolve `true`, o [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) método deve chamar o [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-225">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="a1b7a-226">Este método envia uma mensagem de uma mensagem de confirmação ao utilizador para permitir que os comentários adicionais dizer se deve ser contínuo a operação.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-226">This method sends a message a confirmation message to the user to allow additional feedback to say if the operation should be continued.</span></span> <span data-ttu-id="a1b7a-227">Um provedor deve chamar [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) como uma verificação adicional para as modificações de sistema potencialmente perigosas.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-227">A provider should call [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-rename-item-cmdlet"></a><span data-ttu-id="a1b7a-228">Anexar parâmetros dinâmicos para o Cmdlet Rename-Item</span><span class="sxs-lookup"><span data-stu-id="a1b7a-228">Attaching Dynamic Parameters to the Rename-Item Cmdlet</span></span>

<span data-ttu-id="a1b7a-229">Por vezes, o `Rename-Item` cmdlet requer parâmetros adicionais que são especificados dinamicamente no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-229">Sometimes the `Rename-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="a1b7a-230">Para fornecer estes parâmetros dinâmicos, fornecedor de contentor do Windows PowerShell tem de implementar o [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-230">To provide these dynamic parameters, Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) method.</span></span> <span data-ttu-id="a1b7a-231">Esse método obtém os parâmetros para o item no caminho indicado e retorna um objeto com propriedades e campos com análise atributos semelhantes a uma classe cmdlet ou uma [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-231">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="a1b7a-232">O tempo de execução do Windows PowerShell usa o objeto devolvido para adicionar os parâmetros para o `Rename-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-232">The Windows PowerShell runtime uses the returned object to add the parameters to the `Rename-Item` cmdlet.</span></span>

<span data-ttu-id="a1b7a-233">Este fornecedor de contentor não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-233">This container provider does not implement this method.</span></span> <span data-ttu-id="a1b7a-234">No entanto, o código a seguir é a implementação do padrão desse método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-234">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters](Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters)]  -->

## <a name="creating-new-items"></a><span data-ttu-id="a1b7a-235">Criação de novos itens</span><span class="sxs-lookup"><span data-stu-id="a1b7a-235">Creating New Items</span></span>

<span data-ttu-id="a1b7a-236">Para criar novos itens, um fornecedor de contentor tem de implementar o [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método para oferecer suporte a chamadas a partir do `New-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-236">To create new items, a container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method to support calls from the `New-Item` cmdlet.</span></span> <span data-ttu-id="a1b7a-237">Este método cria um item de dados localizado no caminho especificado.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-237">This method creates a data item located at the specified path.</span></span> <span data-ttu-id="a1b7a-238">O `type` parâmetro do cmdlet contém o tipo definido pelo fornecedor para o novo item.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-238">The `type` parameter of the cmdlet contains the provider-defined type for the new item.</span></span> <span data-ttu-id="a1b7a-239">Por exemplo, o fornecedor de sistema de ficheiros utiliza um `type` parâmetro com um valor de "arquivo" ou "diretório".</span><span class="sxs-lookup"><span data-stu-id="a1b7a-239">For example, the FileSystem provider uses a `type` parameter with a value of "file" or "directory".</span></span> <span data-ttu-id="a1b7a-240">O `newItemValue` parâmetro do cmdlet Especifica um valor de específica do fornecedor para o novo item.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-240">The `newItemValue` parameter of the cmdlet specifies a provider-specific value for the new item.</span></span>

<span data-ttu-id="a1b7a-241">Eis a implementação do [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método para este fornecedor.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-241">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method for this provider.</span></span>

```csharp
protected override void NewItem( string path, string type,
                                 object newItemValue )
{
    // Create the new item here after
    // performing necessary validations
    //
    // WriteItemObject(newItemValue, path, false);

    // Example
    //
    // if (ShouldProcess(path, "new item"))
    // {
    //      // Create a new item and then call WriteObject
    //      WriteObject(newItemValue, path, false);
    // }

} // NewItem
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L939-L955 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-newitem"></a><span data-ttu-id="a1b7a-242">Coisas a serem lembrados sobre a implementação NewItem</span><span class="sxs-lookup"><span data-stu-id="a1b7a-242">Things to Remember About Implementing NewItem</span></span>

<span data-ttu-id="a1b7a-243">As seguintes condições podem aplicar-se na implementação [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="a1b7a-243">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="a1b7a-244">O [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método deve executar uma comparação de maiúsculas e minúsculas de cadeia transmitida a `type` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-244">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should perform a case-insensitive comparison of the string passed in the `type` parameter.</span></span> <span data-ttu-id="a1b7a-245">Deve também permitir menos ambíguas correspondências.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-245">It should also allow for least ambiguous matches.</span></span> <span data-ttu-id="a1b7a-246">Por exemplo, para os tipos "arquivo" e "diretório", apenas a primeira letra é necessário para eliminar a ambiguidade.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-246">For example, for the types "file" and "directory", only the first letter is required to disambiguate.</span></span> <span data-ttu-id="a1b7a-247">Se o `type` parâmetro indica um tipo não é possível criar o seu fornecedor, o [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método deve escrever uma ArgumentException com uma mensagem o fornecedor que indica os tipos pode criar.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-247">If the `type` parameter indicates a type your provider cannot create, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should write an ArgumentException with a message indicating the types the provider can create.</span></span>

- <span data-ttu-id="a1b7a-248">Para o `newItemValue` parâmetro, a implementação do [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método é recomendado para aceitar as cadeias de caracteres no mínimo.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-248">For the `newItemValue` parameter, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method is recommended to accept strings at a minimum.</span></span> <span data-ttu-id="a1b7a-249">Ele também deve aceitar o tipo de objeto que é recuperado o [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) método para o mesmo caminho.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-249">It should also accept the type of object that is retrieved by the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the same path.</span></span> <span data-ttu-id="a1b7a-250">O [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método pode usar o [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) tipos de método para converter a o tipo desejado.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-250">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method can use the [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) method to convert types to the desired type.</span></span>

- <span data-ttu-id="a1b7a-251">Sua implementação do [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) deve chamar o método [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e verifique o valor de retorno antes de fazer alterações ao arquivo de dados.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-251">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="a1b7a-252">Após a chamada para [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retorna true, o [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método deve chamar o [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método como uma verificação adicional para as modificações de sistema potencialmente perigosas.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-252">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-new-item-cmdlet"></a><span data-ttu-id="a1b7a-253">Anexar parâmetros dinâmicos para o Cmdlet de novo Item</span><span class="sxs-lookup"><span data-stu-id="a1b7a-253">Attaching Dynamic Parameters to the New-Item Cmdlet</span></span>

<span data-ttu-id="a1b7a-254">Por vezes, o `New-Item` cmdlet requer parâmetros adicionais que são especificados dinamicamente no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-254">Sometimes the `New-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="a1b7a-255">Para fornecer estes parâmetros dinâmicos, o fornecedor de contentor tem de implementar o [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-255">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) method.</span></span> <span data-ttu-id="a1b7a-256">Esse método obtém os parâmetros para o item no caminho indicado e retorna um objeto com propriedades e campos com análise atributos semelhantes a uma classe cmdlet ou uma [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-256">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="a1b7a-257">O tempo de execução do Windows PowerShell usa o objeto devolvido para adicionar os parâmetros para o `New-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-257">The Windows PowerShell runtime uses the returned object to add the parameters to the `New-Item` cmdlet.</span></span>

<span data-ttu-id="a1b7a-258">Este fornecedor não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-258">This provider does not implement this method.</span></span> <span data-ttu-id="a1b7a-259">No entanto, o código a seguir é a implementação do padrão desse método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-259">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernewitemdynamicparameters](Msh_samplestestcmdlets#testprovidernewitemdynamicparameters)]  -->

## <a name="removing-items"></a><span data-ttu-id="a1b7a-260">Remover itens</span><span class="sxs-lookup"><span data-stu-id="a1b7a-260">Removing Items</span></span>

<span data-ttu-id="a1b7a-261">Para remover itens, o fornecedor de Windows PowerShell tem de substituir a [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) método para oferecer suporte a chamadas a partir do `Remove-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-261">To remove items, the Windows PowerShell provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method to support calls from the `Remove-Item` cmdlet.</span></span> <span data-ttu-id="a1b7a-262">Este método elimina um item do arquivo de dados no caminho especificado.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-262">This method deletes an item from the data store at the specified path.</span></span> <span data-ttu-id="a1b7a-263">Se o `recurse` parâmetro do `Remove-Item` cmdlet está definido como `true`, o método Remove todos os itens subordinados, independentemente de seu nível.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-263">If the `recurse` parameter of the `Remove-Item` cmdlet is set to `true`, the method removes all child items regardless of their level.</span></span> <span data-ttu-id="a1b7a-264">Se o parâmetro estiver definido como `false`, o método Remove apenas um único item no caminho especificado.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-264">If the parameter is set to `false`, the method removes only a single item at the specified path.</span></span>

<span data-ttu-id="a1b7a-265">Este fornecedor não suporta a remoção do item.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-265">This provider does not support item removal.</span></span> <span data-ttu-id="a1b7a-266">No entanto, o código a seguir é a implementação padrão da [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-266">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitem](Msh_samplestestcmdlets#testproviderremoveitem)]  -->

#### <a name="things-to-remember-about-implementing-removeitem"></a><span data-ttu-id="a1b7a-267">Coisas a serem lembrados sobre a implementação RemoveItem</span><span class="sxs-lookup"><span data-stu-id="a1b7a-267">Things to Remember About Implementing RemoveItem</span></span>

<span data-ttu-id="a1b7a-268">As seguintes condições podem aplicar-se na implementação [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="a1b7a-268">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="a1b7a-269">Ao definir a classe do provedor, um provedor de contentor do Windows PowerShell poderia declarar capacidades de fornecedor de ExpandWildcards, filtro, inclusão ou exclusão, da [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeração.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-269">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="a1b7a-270">Nestes casos, a implementação do [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método precisa para se certificar de que o caminho transmitido ao método cumpre os requisitos do especificado capacidades.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-270">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="a1b7a-271">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, o [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriedades.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-271">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="a1b7a-272">Por predefinição, substituições deste método não deverá remover objetos, a menos que o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriedade está definida como true.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-272">By default, overrides of this method should not remove objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to true.</span></span> <span data-ttu-id="a1b7a-273">Se o caminho especificado indica um contentor, o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriedade não é necessária.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-273">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="a1b7a-274">A implementação do [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) é responsável por impedir recursão infinita quando existem ligações circulares e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-274">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="a1b7a-275">Deve ser emitida uma exceção de terminação apropriada para refletir esse uma condição.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-275">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="a1b7a-276">Sua implementação do [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) deve chamar o método [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e verifique o valor de retorno antes de fazer alterações ao arquivo de dados.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-276">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="a1b7a-277">Após a chamada para [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) devolve `true`, o [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) método deve chamar o [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método como uma verificação adicional para as modificações de sistema potencialmente perigosas.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-277">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-remove-item-cmdlet"></a><span data-ttu-id="a1b7a-278">Anexar parâmetros dinâmicos para o Cmdlet Remove-Item</span><span class="sxs-lookup"><span data-stu-id="a1b7a-278">Attaching Dynamic Parameters to the Remove-Item Cmdlet</span></span>

<span data-ttu-id="a1b7a-279">Por vezes, o `Remove-Item` cmdlet requer parâmetros adicionais que são especificados dinamicamente no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-279">Sometimes the `Remove-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="a1b7a-280">Para fornecer estes parâmetros dinâmicos, o fornecedor de contentor tem de implementar o [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) método para lidar com esses parâmetros.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-280">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="a1b7a-281">Esse método obtém os parâmetros dinâmicos para o item no caminho indicado e retorna um objeto com propriedades e campos com análise atributos semelhantes a uma classe cmdlet ou uma [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-281">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="a1b7a-282">O tempo de execução do Windows PowerShell usa o objeto devolvido para adicionar os parâmetros para o `Remove-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-282">The Windows PowerShell runtime uses the returned object to add the parameters to the `Remove-Item` cmdlet.</span></span>

<span data-ttu-id="a1b7a-283">Este fornecedor de contentor não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-283">This container provider does not implement this method.</span></span> <span data-ttu-id="a1b7a-284">No entanto, o código a seguir é a implementação padrão da [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-284">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters](Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters)]  -->

## <a name="querying-for-child-items"></a><span data-ttu-id="a1b7a-285">Consulta para os itens subordinados</span><span class="sxs-lookup"><span data-stu-id="a1b7a-285">Querying for Child Items</span></span>

<span data-ttu-id="a1b7a-286">Para verificar se os itens filho existirem no caminho especificado, o fornecedor de contentor do Windows PowerShell tem de substituir a [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-286">To check to see if child items exist at the specified path, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="a1b7a-287">Este método devolve `true` se o item tiver subordinados, e `false` caso contrário.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-287">This method returns `true` if the item has children, and `false` otherwise.</span></span> <span data-ttu-id="a1b7a-288">Para um caminho nulo ou está vazio, o método considera todos os itens no arquivo de dados para ser subordinados e retorna `true`.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-288">For a null or empty path, the method considers any items in the data store to be children and returns `true`.</span></span>

<span data-ttu-id="a1b7a-289">Eis a substituição para o [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-289">Here is the override for the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="a1b7a-290">Se existirem mais de duas partes do caminho criados pelo método auxiliar ChunkPath, o método retorna `false`, uma vez que apenas um contentor de base de dados e um contentor de tabela são definidos.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-290">If there are more than two path parts created by the ChunkPath helper method, the method returns `false`, since only a database container and a table container are defined.</span></span> <span data-ttu-id="a1b7a-291">Para mais informações sobre esse método auxiliar, consulte o método ChunkPath é discutido [criar um fornecedor de Item do Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-291">For more information about this helper method, see the ChunkPath method is discussed in [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

```csharp
protected override bool HasChildItems( string path )
{
    return false;
} // HasChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L1094-L1097 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-haschilditems"></a><span data-ttu-id="a1b7a-292">Coisas a serem lembrados sobre a implementação HasChildItems</span><span class="sxs-lookup"><span data-stu-id="a1b7a-292">Things to Remember About Implementing HasChildItems</span></span>

<span data-ttu-id="a1b7a-293">As seguintes condições podem aplicar-se na implementação [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span><span class="sxs-lookup"><span data-stu-id="a1b7a-293">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span></span>

- <span data-ttu-id="a1b7a-294">Se o fornecedor de contentor expõe uma raiz que contém os pontos de montagem de interessante, a implementação do [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) método deve retornar `true`quando um valor nulo ou uma cadeia vazia é passada para o caminho.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-294">If the container provider exposes a root that contains interesting mount points, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method should return `true` when a null or an empty string is passed in for the path.</span></span>

## <a name="copying-items"></a><span data-ttu-id="a1b7a-295">Copiar itens</span><span class="sxs-lookup"><span data-stu-id="a1b7a-295">Copying Items</span></span>

<span data-ttu-id="a1b7a-296">Para copiar itens, o fornecedor de contentor tem de implementar o [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) método para oferecer suporte a chamadas a partir do `Copy-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-296">To copy items, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method to support calls from the `Copy-Item` cmdlet.</span></span> <span data-ttu-id="a1b7a-297">Este método copia um item de dados de localização indicada pela `path` parâmetro do cmdlet para o local indicado pelo `copyPath` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-297">This method copies a data item from the location indicated by the `path` parameter of the cmdlet to the location indicated by the `copyPath` parameter.</span></span> <span data-ttu-id="a1b7a-298">Se o `recurse` parâmetro for especificado, o método copia todos os sub-recipientes.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-298">If the `recurse` parameter is specified, the method copies all sub-containers.</span></span> <span data-ttu-id="a1b7a-299">Se o parâmetro não for especificado, o método copia apenas um único nível de itens.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-299">If the parameter is not specified, the method copies only a single level of items.</span></span>

<span data-ttu-id="a1b7a-300">Este fornecedor não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-300">This provider does not implement this method.</span></span> <span data-ttu-id="a1b7a-301">No entanto, o código a seguir é a implementação padrão da [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-301">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitem](Msh_samplestestcmdlets#testprovidercopyitem)]  -->

#### <a name="things-to-remember-about-implementing-copyitem"></a><span data-ttu-id="a1b7a-302">Coisas a serem lembrados sobre a implementação de CopyItem</span><span class="sxs-lookup"><span data-stu-id="a1b7a-302">Things to Remember About Implementing CopyItem</span></span>

<span data-ttu-id="a1b7a-303">As seguintes condições podem aplicar-se na implementação [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span><span class="sxs-lookup"><span data-stu-id="a1b7a-303">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span></span>

- <span data-ttu-id="a1b7a-304">Ao definir a classe do provedor, um provedor de contentor do Windows PowerShell poderia declarar capacidades de fornecedor de ExpandWildcards, filtro, inclusão ou exclusão, da [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeração.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-304">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="a1b7a-305">Nestes casos, a implementação do [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método precisa para se certificar de que o caminho transmitido ao método cumpre os requisitos do especificado capacidades.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-305">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="a1b7a-306">Para fazer isso, o método deve acessar a propriedade apropriada, por exemplo, o [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) e [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriedades.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-306">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="a1b7a-307">Por predefinição, substituições deste método não devem copiar objetos ao longo de objetos existentes, a menos que o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) estiver definida como `true`.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-307">By default, overrides of this method should not copy objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="a1b7a-308">Por exemplo, o fornecedor do sistema de ficheiros não copiará c:\temp\abc.txt ao longo de um ficheiro de c:\abc.txt existente, a menos que o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) estiver definida como `true`.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-308">For example, the FileSystem provider will not copy c:\temp\abc.txt over an existing c:\abc.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="a1b7a-309">Se o caminho especificado na `copyPath` parâmetro existe e indica um contentor, o [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriedade não é necessária.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-309">If the path specified in the `copyPath` parameter exists and indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="a1b7a-310">Neste caso, [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) deve copiar o item indicado pela `path` parâmetro para o contentor indicado pelo `copyPath` parâmetro como um filho.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-310">In this case, [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) should copy the item indicated by the `path` parameter to the container indicated by the `copyPath` parameter as a child.</span></span>

- <span data-ttu-id="a1b7a-311">A implementação do [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) é responsável por impedir recursão infinita quando existem ligações circulares e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-311">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="a1b7a-312">Deve ser emitida uma exceção de terminação apropriada para refletir esse uma condição.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-312">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="a1b7a-313">Sua implementação do [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) deve chamar o método [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) e verifique o valor de retorno antes de fazer alterações ao arquivo de dados.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-313">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="a1b7a-314">Após a chamada para [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retorna true, o [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) método deve chamar o [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método como uma verificação adicional para as modificações de sistema potencialmente perigosas.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-314">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Copyitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span> <span data-ttu-id="a1b7a-315">Para obter mais informações sobre como chamar esses métodos, consulte [mudar o nome de itens](#Renaming-Items).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-315">For more information about calling these methods, see [Rename Items](#Renaming-Items).</span></span>

## <a name="attaching-dynamic-parameters-to-the-copy-item-cmdlet"></a><span data-ttu-id="a1b7a-316">Anexar parâmetros dinâmicos para o Cmdlet Copy-Item</span><span class="sxs-lookup"><span data-stu-id="a1b7a-316">Attaching Dynamic Parameters to the Copy-Item Cmdlet</span></span>

<span data-ttu-id="a1b7a-317">Por vezes, o `Copy-Item` cmdlet requer parâmetros adicionais que são especificados dinamicamente no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-317">Sometimes the `Copy-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="a1b7a-318">Para fornecer estes parâmetros dinâmicos, o fornecedor de contentor do Windows PowerShell tem de implementar o [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) método para lidar com esses parâmetros.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-318">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="a1b7a-319">Esse método obtém os parâmetros para o item no caminho indicado e retorna um objeto com propriedades e campos com análise atributos semelhantes a uma classe cmdlet ou uma [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-319">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="a1b7a-320">O tempo de execução do Windows PowerShell usa o objeto devolvido para adicionar os parâmetros para o `Copy-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-320">The Windows PowerShell runtime uses the returned object to add the parameters to the `Copy-Item` cmdlet.</span></span>

<span data-ttu-id="a1b7a-321">Este fornecedor não implementa esse método.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-321">This provider does not implement this method.</span></span> <span data-ttu-id="a1b7a-322">No entanto, o código a seguir é a implementação padrão da [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-322">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters](Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters)]  -->

## <a name="code-sample"></a><span data-ttu-id="a1b7a-323">Exemplo de código</span><span class="sxs-lookup"><span data-stu-id="a1b7a-323">Code Sample</span></span>

<span data-ttu-id="a1b7a-324">Para o código de exemplo completo, consulte [exemplo de código AccessDbProviderSample04](./accessdbprovidersample04-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-324">For complete sample code, see [AccessDbProviderSample04 Code Sample](./accessdbprovidersample04-code-sample.md).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="a1b7a-325">Criando o provedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a1b7a-325">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="a1b7a-326">Ver [como registar os Cmdlets, fornecedores e alojar aplicações](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="a1b7a-326">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="a1b7a-327">Teste o fornecedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a1b7a-327">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="a1b7a-328">Quando o seu fornecedor de Windows PowerShell foi registado com o Windows PowerShell, pode testá-lo ao executar os cmdlets suportados na linha de comandos.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-328">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="a1b7a-329">Lembre-se de que o resultado de exemplo seguinte utiliza uma base de dados do Access fictício.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-329">Be aware that the following example output uses a fictitious Access database.</span></span>

1. <span data-ttu-id="a1b7a-330">Execute o `Get-ChildItem` cmdlet para obter a lista de itens subordinados de uma tabela de clientes da base de dados de acesso.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-330">Run the `Get-ChildItem` cmdlet to retrieve the list of child items from a Customers table in the Access database.</span></span>

   ```powershell
   Get-ChildItem mydb:customers
   ```

   <span data-ttu-id="a1b7a-331">O resultado seguinte é apresentada.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-331">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : True
   Data          : System.Data.DataRow
   Name          : Customers
   RowCount      : 91
   Columns       :
   ```

2. <span data-ttu-id="a1b7a-332">Execute o `Get-ChildItem` cmdlet novamente para recuperar os dados de uma tabela.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-332">Run the `Get-ChildItem` cmdlet again to retrieve the data of a table.</span></span>

   ```powershell
   (Get-ChildItem mydb:customers).data
   ```

   <span data-ttu-id="a1b7a-333">O resultado seguinte é apresentada.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-333">The following output appears.</span></span>

   ```output
   TABLE_CAT   : c:\PS\northwind
   TABLE_SCHEM :
   TABLE_NAME  : Customers
   TABLE_TYPE  : TABLE
   REMARKS     :
   ```

3. <span data-ttu-id="a1b7a-334">Agora utilizar o `Get-Item` cmdlet para obter os itens de linha 0 na tabela de dados.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-334">Now use the `Get-Item` cmdlet to retrieve the items at row 0 in the data table.</span></span>

   ```powershell
   Get-Item mydb:\customers\0
   ```

   <span data-ttu-id="a1b7a-335">O resultado seguinte é apresentada.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-335">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers\0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data          : System.Data.DataRow
   RowNumber     : 0
   ```

4. <span data-ttu-id="a1b7a-336">Reutilizar `Get-Item` para recuperar os dados para os itens na linha 0.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-336">Reuse `Get-Item` to retrieve the data for the items in row 0.</span></span>

   ```powershell
   (Get-Item mydb:\customers\0).data
   ```

   <span data-ttu-id="a1b7a-337">O resultado seguinte é apresentada.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-337">The following output appears.</span></span>

   ```output
   CustomerID   : 1234
   CompanyName  : Fabrikam
   ContactName  : Eric Gruber
   ContactTitle : President
   Address      : 4567 Main Street
   City         : Buffalo
   Region       : NY
   PostalCode   : 98052
   Country      : USA
   Phone        : (425) 555-0100
   Fax          : (425) 555-0101
   ```

5. <span data-ttu-id="a1b7a-338">Agora utilizar o `New-Item` cmdlet para adicionar uma linha para uma tabela existente.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-338">Now use the `New-Item` cmdlet to add a row to an existing table.</span></span> <span data-ttu-id="a1b7a-339">O `Path` parâmetro especifica o caminho completo para a linha e tem de indicar um número de linha que é superior ao número de linhas na tabela existente.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-339">The `Path` parameter specifies the full path to the row, and must indicate a row number that is greater than the existing number of rows in the table.</span></span> <span data-ttu-id="a1b7a-340">O `Type` parâmetro indica "linha" para especificar esse tipo de item para adicionar.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-340">The `Type` parameter indicates "row" to specify that type of item to add.</span></span> <span data-ttu-id="a1b7a-341">Por fim, o `Value` parâmetro especifica uma lista delimitada por vírgulas de valores de coluna para a linha.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-341">Finally, the `Value` parameter specifies a comma-delimited list of column values for the row.</span></span>

   ```powershell
   New-Item -Path mydb:\Customers\3 -ItemType "row" -Value "3,CustomerFirstName,CustomerLastName,CustomerEmailAdress,CustomerTitle,CustomerCompany,CustomerPhone, CustomerAddress,CustomerCity,CustomerState,CustomerZip,CustomerCountry"
   ```

6. <span data-ttu-id="a1b7a-342">Verificar a correção da operação de novo item da seguinte forma.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-342">Verify the correctness of the new item operation as follows.</span></span>

   ```none
   PS mydb:\> cd Customers
   PS mydb:\Customers> (Get-Item 3).data
   ```

   <span data-ttu-id="a1b7a-343">O resultado seguinte é apresentada.</span><span class="sxs-lookup"><span data-stu-id="a1b7a-343">The following output appears.</span></span>

   ```output
   ID        : 3
   FirstName : Eric
   LastName  : Gruber
   Email     : ericgruber@fabrikam.com
   Title     : President
   Company   : Fabrikam
   WorkPhone : (425) 555-0100
   Address   : 4567 Main Street
   City      : Buffalo
   State     : NY
   Zip       : 98052
   Country   : USA
   ```

## <a name="see-also"></a><span data-ttu-id="a1b7a-344">Veja Também</span><span class="sxs-lookup"><span data-stu-id="a1b7a-344">See Also</span></span>

[<span data-ttu-id="a1b7a-345">Criar provedores do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a1b7a-345">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="a1b7a-346">Estruturar o seu fornecedor do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a1b7a-346">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="a1b7a-347">Implementando um provedor de PowerShell do Windows de Item</span><span class="sxs-lookup"><span data-stu-id="a1b7a-347">Implementing an Item Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-item-provider.md)

[<span data-ttu-id="a1b7a-348">Implementando um provedor de PowerShell do Windows de navegação</span><span class="sxs-lookup"><span data-stu-id="a1b7a-348">Implementing a Navigation Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

[<span data-ttu-id="a1b7a-349">Como registar os Cmdlets, fornecedores e alojar aplicações</span><span class="sxs-lookup"><span data-stu-id="a1b7a-349">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="a1b7a-350">SDK do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a1b7a-350">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="a1b7a-351">Guia do programador do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a1b7a-351">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)