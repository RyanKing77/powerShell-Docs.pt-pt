---
ms.date: 2017-06-12
author: rpsqrd
ms.topic: conceptual
keywords: "jea, powershell, segurança"
title: "Considerações de segurança JEA"
ms.openlocfilehash: 2dcce34113998a1c31709b6afe6d0a21c991e79d
ms.sourcegitcommit: f069ff0689006fece768f178c10e3e3eeaee09f0
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/13/2017
---
# <a name="jea-security-considerations"></a><span data-ttu-id="a655c-103">Considerações de segurança JEA</span><span class="sxs-lookup"><span data-stu-id="a655c-103">JEA Security Considerations</span></span>

> <span data-ttu-id="a655c-104">Aplica-se a: Windows PowerShell 5.0</span><span class="sxs-lookup"><span data-stu-id="a655c-104">Applies to: Windows PowerShell 5.0</span></span>

<span data-ttu-id="a655c-105">JEA ajuda a melhorar a sua postura de segurança, reduzindo o número de administradores permanentes nas suas máquinas.</span><span class="sxs-lookup"><span data-stu-id="a655c-105">JEA helps you improve your security posture by reducing the number of permanent administrators on your machines.</span></span>
<span data-ttu-id="a655c-106">Isto é feito através da criação de um novo ponto de entrada para os utilizadores gerir o sistema (uma configuração de sessão do PowerShell), que é totalmente bloqueado por predefinição, para impedir a utilização indevida.</span><span class="sxs-lookup"><span data-stu-id="a655c-106">It does so by creating a new entry point for users to manage the system (a PowerShell session configuration) which is tightly locked down by default to prevent misuse.</span></span>
<span data-ttu-id="a655c-107">Os utilizadores que necessitam de algumas, mas não ilimitado, o acesso ao computador para executar tarefas administrativas pode ser concedido acesso ao ponto final do JEA.</span><span class="sxs-lookup"><span data-stu-id="a655c-107">Users who need some, but not unlimited, access to the machine to perform administrative tasks can be granted access to the JEA endpoint.</span></span>
<span data-ttu-id="a655c-108">Porque JEA permite-lhes para executarem comandos admin sem diretamente ter acesso de administrador, em seguida, pode remover os utilizadores de grupos de segurança altamente privilegiadas (faz com que os utilizadores padrão).</span><span class="sxs-lookup"><span data-stu-id="a655c-108">Because JEA allows them to run admin commands without directly having admin access, you can then remove those users from highly privileged security groups (make them standard users).</span></span>

<span data-ttu-id="a655c-109">Este tópico descreve o modelo de segurança JEA e melhores práticas em mais detalhe.</span><span class="sxs-lookup"><span data-stu-id="a655c-109">This topic describes the JEA security model and best practices in more detail.</span></span>

## <a name="run-as-account"></a><span data-ttu-id="a655c-110">Conta Run As</span><span class="sxs-lookup"><span data-stu-id="a655c-110">Run As account</span></span>

<span data-ttu-id="a655c-111">Cada ponto final JEA tem uma conta designada "Executar como" qual é a conta sob a qual as ações o utilizador ao ligar é efetuado.</span><span class="sxs-lookup"><span data-stu-id="a655c-111">Each JEA endpoint has a designated "run as" account, which is the account under which the connecting user's actions are performed.</span></span>
<span data-ttu-id="a655c-112">Esta conta é configurável no [ficheiro de configuração de sessão](session-configurations.md), e a conta que escolher tem um efeito significativo da segurança do seu ponto final.</span><span class="sxs-lookup"><span data-stu-id="a655c-112">This account is configurable in the [session configuration file](session-configurations.md), and the account you choose has a significant bearing on the security of your endpoint.</span></span>

<span data-ttu-id="a655c-113">**As contas virtual** são a forma recomendada de configuração o ser executado como conta.</span><span class="sxs-lookup"><span data-stu-id="a655c-113">**Virtual accounts** are the recommended way of configuring the run as account.</span></span>
<span data-ttu-id="a655c-114">As contas de virtual são monouso, temporárias contas locais que são criadas para o utilizador ao ligar a utilizar durante a duração da sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="a655c-114">Virtual accounts are one-time, temporary local accounts that are created for the connecting user to use during the duration of their JEA session.</span></span>
<span data-ttu-id="a655c-115">Assim que a sessão foi terminada, a conta virtual irá ser destruída e não pode ser utilizada já.</span><span class="sxs-lookup"><span data-stu-id="a655c-115">As soon as their session is terminated, the virtual account will be destroyed and cannot be used anymore.</span></span>
<span data-ttu-id="a655c-116">O utilizador de ligação não souber as credenciais da conta virtual e não é possível utilizar a conta virtual para aceder ao sistema através de outros meios, como o ambiente de trabalho remoto ou um ponto de final do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a655c-116">The connecting user does not know the credentials for the virtual account and cannot use the virtual account to access the system via other means, such as Remote Desktop or an unconstrained PowerShell endpoint.</span></span>

<span data-ttu-id="a655c-117">Por predefinição, as contas virtual pertencem ao grupo de administradores local no computador.</span><span class="sxs-lookup"><span data-stu-id="a655c-117">By default, virtual accounts belong to the local administrators group on the machine.</span></span>
<span data-ttu-id="a655c-118">Isto proporciona-lhes direitos totais para gerir nada no sistema, mas não existem direitos para gerir os recursos na rede.</span><span class="sxs-lookup"><span data-stu-id="a655c-118">This gives them full rights to manage anything on the system, but no rights to manage resources on the network.</span></span>
<span data-ttu-id="a655c-119">Quando a autenticação com outras máquinas, o contexto de utilizador será da conta de computador local, não a conta virtual.</span><span class="sxs-lookup"><span data-stu-id="a655c-119">When authenticating with other machines, the user context will be that of the local computer account, not the virtual account.</span></span>

<span data-ttu-id="a655c-120">Os controladores de domínio são um caso especial porque não existe nenhum conceito de um grupo de administradores locais.</span><span class="sxs-lookup"><span data-stu-id="a655c-120">Domain controllers are a special case since there is no concept of a local administrators group.</span></span>
<span data-ttu-id="a655c-121">Em vez disso, as contas virtual pertencem a Admins do domínio em vez disso e podem gerir os serviços de diretório no controlador de domínio.</span><span class="sxs-lookup"><span data-stu-id="a655c-121">Instead, virtual accounts belong to Domain Admins instead and can manage the directory services on the domain controller.</span></span>
<span data-ttu-id="a655c-122">A identidade do domínio é ainda restringida para utilizar no controlador de domínio em que a sessão JEA instanciada e será apresentado qualquer acesso à rede ser proveniente do objeto de computador do controlador de domínio em vez disso.</span><span class="sxs-lookup"><span data-stu-id="a655c-122">The domain identity is still restricted to use on the domain controller where the JEA session was instantiated, and any network access will appear to come from the domain controller computer object instead.</span></span>

<span data-ttu-id="a655c-123">Em ambos os casos, pode definir explicitamente também que a conta virtual deve pertencer de grupos de segurança.</span><span class="sxs-lookup"><span data-stu-id="a655c-123">In both cases, you can also explicitly define which security groups the virtual account should belong to.</span></span>
<span data-ttu-id="a655c-124">Esta é uma boa prática quando a tarefa que está a efetuar pode ser realizada sem privilégios de administrador local/domínio.</span><span class="sxs-lookup"><span data-stu-id="a655c-124">This is a good practice when the task you are performing can be done without local/domain admin privileges.</span></span>
<span data-ttu-id="a655c-125">Se já tiver um grupo de segurança definido para os seus administradores, pode conceder a associação de conta virtual simplesmente a esse grupo para atribuir-lhe as permissões que necessita.</span><span class="sxs-lookup"><span data-stu-id="a655c-125">If you already have a security group defined for your admins, you can simply grant the virtual account membership to that group to give it the permissions it needs.</span></span>
<span data-ttu-id="a655c-126">Associação ao grupo de conta virtual está limitada a grupos de segurança local nos servidores de estação de trabalho e o membro, mas num controlador de domínio só podem ser membros dos grupos de segurança do domínio.</span><span class="sxs-lookup"><span data-stu-id="a655c-126">Virtual account group membership is limited to local security groups on workstation and member servers, but on a domain controller they can only be members of domain security groups.</span></span>
<span data-ttu-id="a655c-127">Depois de especificar um ou mais grupos de segurança para a conta virtual pertence a, já não irá pertencer aos grupos predefinidos (administrador local ou o administrador de domínio).</span><span class="sxs-lookup"><span data-stu-id="a655c-127">Once you specify one or more security groups for the virtual account to belong to, it will no longer belong to the default groups (local admin or domain admin).</span></span>

<span data-ttu-id="a655c-128">A tabela abaixo resume as opções de configuração possíveis e permissões resultantes para contas virtuais</span><span class="sxs-lookup"><span data-stu-id="a655c-128">The table below summarizes the possible configuration options and resulting permissions for virtual accounts</span></span>

<span data-ttu-id="a655c-129">Tipo de computador</span><span class="sxs-lookup"><span data-stu-id="a655c-129">Computer type</span></span>                | <span data-ttu-id="a655c-130">Configuração do grupo de conta virtual</span><span class="sxs-lookup"><span data-stu-id="a655c-130">Virtual account group configuration</span></span> | <span data-ttu-id="a655c-131">Contexto de utilizador local</span><span class="sxs-lookup"><span data-stu-id="a655c-131">Local user context</span></span>                                      | <span data-ttu-id="a655c-132">Contexto de utilizador de rede</span><span class="sxs-lookup"><span data-stu-id="a655c-132">Network user context</span></span>
-----------------------------|-------------------------------------|---------------------------------------------------------|--------------------------------------------------
<span data-ttu-id="a655c-133">Controlador de domínio</span><span class="sxs-lookup"><span data-stu-id="a655c-133">Domain controller</span></span>            | <span data-ttu-id="a655c-134">Predefinido</span><span class="sxs-lookup"><span data-stu-id="a655c-134">Default</span></span>                             | <span data-ttu-id="a655c-135">Utilizador de domínio, membro de '*domínio*\Domain Admins</span><span class="sxs-lookup"><span data-stu-id="a655c-135">Domain user, member of '*DOMAIN*\Domain Admins'</span></span>         | <span data-ttu-id="a655c-136">Conta de computador</span><span class="sxs-lookup"><span data-stu-id="a655c-136">Computer account</span></span>
<span data-ttu-id="a655c-137">Controlador de domínio</span><span class="sxs-lookup"><span data-stu-id="a655c-137">Domain controller</span></span>            | <span data-ttu-id="a655c-138">Grupos de domínio A e B</span><span class="sxs-lookup"><span data-stu-id="a655c-138">Domain groups A and B</span></span>               | <span data-ttu-id="a655c-139">Utilizador de domínio, membro de '*domínio*\A ','*domínio*\B'</span><span class="sxs-lookup"><span data-stu-id="a655c-139">Domain user, member of '*DOMAIN*\A', '*DOMAIN*\B'</span></span>       | <span data-ttu-id="a655c-140">Conta de computador</span><span class="sxs-lookup"><span data-stu-id="a655c-140">Computer account</span></span>
<span data-ttu-id="a655c-141">Servidor membro ou estação de trabalho</span><span class="sxs-lookup"><span data-stu-id="a655c-141">Member server or workstation</span></span> | <span data-ttu-id="a655c-142">Predefinido</span><span class="sxs-lookup"><span data-stu-id="a655c-142">Default</span></span>                             | <span data-ttu-id="a655c-143">Utilizador local, membro de '*BUILTIN*dos \Administrators</span><span class="sxs-lookup"><span data-stu-id="a655c-143">Local user, member of '*BUILTIN*\Administrators'</span></span>        | <span data-ttu-id="a655c-144">Conta de computador</span><span class="sxs-lookup"><span data-stu-id="a655c-144">Computer account</span></span>
<span data-ttu-id="a655c-145">Servidor membro ou estação de trabalho</span><span class="sxs-lookup"><span data-stu-id="a655c-145">Member server or workstation</span></span> | <span data-ttu-id="a655c-146">Grupos locais C e D</span><span class="sxs-lookup"><span data-stu-id="a655c-146">Local groups C and D</span></span>                | <span data-ttu-id="a655c-147">Utilizador local, membro de '*computador*\C' e '*computador*\D'</span><span class="sxs-lookup"><span data-stu-id="a655c-147">Local user, member of '*COMPUTER*\C' and '*COMPUTER*\D'</span></span> | <span data-ttu-id="a655c-148">Conta de computador</span><span class="sxs-lookup"><span data-stu-id="a655c-148">Computer account</span></span>

<span data-ttu-id="a655c-149">Quando observar os eventos de auditoria de segurança e registos de eventos de aplicações, verá que cada sessão de utilizador JEA tem uma conta virtual exclusiva.</span><span class="sxs-lookup"><span data-stu-id="a655c-149">When you look at security audit events and application event logs, you will see that each JEA user session has a unique virtual account.</span></span>
<span data-ttu-id="a655c-150">Isto ajuda a controlar as ações do utilizador num ponto final JEA novamente para o utilizador original que executou o comando.</span><span class="sxs-lookup"><span data-stu-id="a655c-150">This helps you track user actions in a JEA endpoint back to the original user who ran the command.</span></span>
<span data-ttu-id="a655c-151">Conta virtual nomes seguem o formato "utilizadores do WinRM Virtual\\WinRM\_VA\_*ACCOUNTNUMBER*\_*domínio* \_ *sAMAccountName*"por exemplo, se o utilizador"Alice"no domínio"Contoso"reinicia um serviço num ponto final JEA, o nome de utilizador associado a quaisquer eventos de Gestor de controlo do serviço será" utilizadores do WinRM Virtual\\WinRM\_ VA\_1\_contoso\_alice ".</span><span class="sxs-lookup"><span data-stu-id="a655c-151">Virtual account names follow the format "WinRM Virtual Users\\WinRM\_VA\_*ACCOUNTNUMBER*\_*DOMAIN*\_*sAMAccountName*" For example, if user "Alice" in domain "Contoso" restarts a service in a JEA endpoint, the username associated with any service control manager events would be "WinRM Virtual Users\\WinRM\_VA\_1\_contoso\_alice".</span></span>


<span data-ttu-id="a655c-152">**Grupo de contas de serviço geridas (gMSAs)** são úteis quando um servidor membro tem de ter acesso a recursos de rede na sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="a655c-152">**Group managed service accounts (gMSAs)** are useful when a member server needs to have access to network resources in the JEA session.</span></span>
<span data-ttu-id="a655c-153">Um caso de utilização de exemplo para este é um ponto final de JEA é utilizado para controlar o acesso a uma API REST alojada num computador diferente.</span><span class="sxs-lookup"><span data-stu-id="a655c-153">An example use case for this is a JEA endpoint that is used to control access to a REST API hosted on a different machine.</span></span>
<span data-ttu-id="a655c-154">É mais fácil escrever funções para tornar as invocações pretendidas na REST API, mas para autenticar com a API precisam de uma identidade de rede.</span><span class="sxs-lookup"><span data-stu-id="a655c-154">It is easy to write functions to make the desired invocations on the REST API, but in order to authenticate with the API you need a network identity.</span></span>
<span data-ttu-id="a655c-155">Utilizar uma conta de serviço geridas de grupo possibilita o "segundo hop" enquanto ainda tem controlo sobre o qual os computadores podem utilizar a conta.</span><span class="sxs-lookup"><span data-stu-id="a655c-155">Using a group managed service account makes the "second hop" possible while still having control over which computers can use the account.</span></span>
<span data-ttu-id="a655c-156">As permissões efetivas de capacidade de gMSA são definidas por grupos de segurança (locais ou domínio) para que a conta gMSA pertence.</span><span class="sxs-lookup"><span data-stu-id="a655c-156">The effective permissions of the gMSA are defined by the security groups (local or domain) to which the gMSA account belongs.</span></span>

<span data-ttu-id="a655c-157">Quando um ponto final JEA é configurado para utilizar uma conta gMSA, as ações de todos os utilizadores JEA aparecerá fique do mesmo grupo de conta de serviço gerida.</span><span class="sxs-lookup"><span data-stu-id="a655c-157">When a JEA endpoint is configured to use a gMSA account, the actions of all JEA users will appear to come from the same group managed service account.</span></span>
<span data-ttu-id="a655c-158">É a única forma de pode analisar as ações para um utilizador específico para identificar o conjunto de comandos a executar um transcript de sessão do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a655c-158">The only way you can trace actions back to a specific user is to identify the set of commands run in a PowerShell session transcript.</span></span>

<span data-ttu-id="a655c-159">**Transmita-através da credenciais** são utilizadas quando não especificar um executado como conta e pretender do PowerShell para utilizar a ligação credencial do utilizador para executar comandos no servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="a655c-159">**Pass-thru credentials** are used when you do not specify a run as account and want PowerShell to use the connecting user's credential to run commands on the remote server.</span></span>
<span data-ttu-id="a655c-160">Esta configuração é *não* recomendada para JEA, este seria tem de conceder o acesso direto ligação do utilizador aos grupos de gestão com privilégios.</span><span class="sxs-lookup"><span data-stu-id="a655c-160">This configuration is *not* recommended for JEA as it would require you to grant the connecting user direct access to privileged management groups.</span></span>
<span data-ttu-id="a655c-161">Se o utilizador ligação já tiver privilégios de administrador, pode evitar completamente o JEA e gerir o sistema através de outros, significa.</span><span class="sxs-lookup"><span data-stu-id="a655c-161">If the connecting user already has admin privileges, they can avoid JEA altogether and manage the system via other, unconstrained means.</span></span>
<span data-ttu-id="a655c-162">Consulte a secção abaixo sobre como [JEA não protege contra a admins](#jea-does-not-protect-against-admins) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="a655c-162">See the section below on how [JEA does not protect against admins](#jea-does-not-protect-against-admins) for more information.</span></span>

<span data-ttu-id="a655c-163">**Executar padrão como contas** permitem-lhe especificar uma conta de utilizador na qual a sessão de PowerShell completa será executado.</span><span class="sxs-lookup"><span data-stu-id="a655c-163">**Standard run as accounts** allow you to specify any user account under which the entire PowerShell session will run.</span></span>
<span data-ttu-id="a655c-164">Esta é uma distinção importante, porque uma configuração de sessão definido para utilizar uma execução fixa como conta (com o `-RunAsCredential` parâmetro) não está ciente de JEA.</span><span class="sxs-lookup"><span data-stu-id="a655c-164">This is an important distinction, because a session configuration set to use a fixed run as account (with the `-RunAsCredential` parameter) is not JEA-aware.</span></span>
<span data-ttu-id="a655c-165">Isto significa que as definições de função deixarão de funcionar conforme esperado e todos os utilizadores autorizados a aceder ao ponto final serão atribuído a mesma função.</span><span class="sxs-lookup"><span data-stu-id="a655c-165">That means that role definitions no longer function as expected, and every user authorized to access the endpoint will be assigned the same role.</span></span>

<span data-ttu-id="a655c-166">Não deve utilizar um RunAsCredential um ponto final JEA devido a dificuldade em ações para utilizadores específicos e a falta de suporte para o mapeamento de utilizadores a funções de rastreio.</span><span class="sxs-lookup"><span data-stu-id="a655c-166">You should not use a RunAsCredential on a JEA endpoint because of the difficulty in tracing actions back to specific users and the lack of support for mapping users to roles.</span></span>

## <a name="winrm-endpoint-acl"></a><span data-ttu-id="a655c-167">ACL de ponto final WinRM</span><span class="sxs-lookup"><span data-stu-id="a655c-167">WinRM Endpoint ACL</span></span>

<span data-ttu-id="a655c-168">Como com regulares PowerShell remota pontos finais, cada ponto final JEA tem uma lista de controlo de acesso separado (ACL) definida na configuração do WinRM que controla quem pode autenticar com o ponto final JEA.</span><span class="sxs-lookup"><span data-stu-id="a655c-168">As with regular PowerShell remoting endpoints, each JEA endpoint has a separate access control list (ACL) set in the WinRM configuration that controls who can authenticate with the JEA endpoint.</span></span>
<span data-ttu-id="a655c-169">Se configurado incorretamente, utilizadores fidedignos poderão não conseguir aceder ao ponto final JEA e/ou os utilizadores não fidedignos, podem obter acesso.</span><span class="sxs-lookup"><span data-stu-id="a655c-169">If improperly configured, trusted users may not be able to access the JEA endpoint and/or untrusted users may gain access.</span></span>
<span data-ttu-id="a655c-170">A ACL de WinRM não, no entanto, afeta o mapeamento de utilizadores a funções JEA.</span><span class="sxs-lookup"><span data-stu-id="a655c-170">The WinRM ACL does not, however, affect the mapping of users to JEA roles.</span></span>
<span data-ttu-id="a655c-171">Que é controlada pelo *RoleDefinitions* campo no ficheiro de configuração de sessão que foi registado no sistema.</span><span class="sxs-lookup"><span data-stu-id="a655c-171">That is controlled by the *RoleDefinitions* field in the session configuration file that was registered on the system.</span></span>

<span data-ttu-id="a655c-172">Por predefinição, ao registar um ponto final de JEA utilizando um ficheiro de configuração de sessão e um ou mais capacidades de função, a ACL de WinRM será configurada para permitir que todos os utilizadores de mapeamento para um ou mais o acesso de funções para o ponto final.</span><span class="sxs-lookup"><span data-stu-id="a655c-172">By default, when you register a JEA endpoint using a session configuration file and one or more role capabilities, the WinRM ACL will be configured to allow all users mapping to one or more roles access to the endpoint.</span></span>
<span data-ttu-id="a655c-173">Por exemplo, uma sessão JEA configurada utilizando os seguintes comandos irá conceder acesso total ao *CONTOSO\JEA\_Lev1* e *CONTOSO\JEA\_Lev2*.</span><span class="sxs-lookup"><span data-stu-id="a655c-173">For example, a JEA session configured using the following commands will grant full access to *CONTOSO\JEA\_Lev1* and *CONTOSO\JEA\_Lev2*.</span></span>

```powershell
$roles = @{ 'CONTOSO\JEA_Lev1' = 'Lev1Role'; 'CONTOSO\JEA_Lev2' = 'Lev2Role' }
New-PSSessionConfigurationFile -Path '.\jea.pssc' -SessionType RestrictedRemoteServer -RoleDefinitions $roles -RunAsVirtualAccount
Register-PSSessionConfiguration -Path '.\jea.pssc' -Name 'MyJEAEndpoint'
```

<span data-ttu-id="a655c-174">Pode auditar as permissões de utilizador com o [Get-PSSessionConfiguration](https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a655c-174">You can audit user permissions with the [Get-PSSessionConfiguration](https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span></span>

```powershell
PS C:\> Get-PSSessionConfiguration -Name 'MyJEAEndpoint' | Select-Object Permission

Permission
----------
CONTOSO\JEA_Lev1 AccessAllowed
CONTOSO\JEA_Lev2 AccessAllowed
```

<span data-ttu-id="a655c-175">Para alterar os utilizadores que têm acesso, execute um `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` para uma linha de comandos interativa ou `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` para atualizar as permissões.</span><span class="sxs-lookup"><span data-stu-id="a655c-175">To change which users have access, run either `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` for an interactive prompt or `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` to update the permissions.</span></span>
<span data-ttu-id="a655c-176">Os utilizadores necessitam de pelo menos *Invoke* direitos para aceder ao ponto final JEA.</span><span class="sxs-lookup"><span data-stu-id="a655c-176">Users need at least *Invoke* rights to access the JEA endpoint.</span></span>

<span data-ttu-id="a655c-177">Se os utilizadores adicionais são concedidos o acesso ao ponto final do JEA, mas não se enquadram qualquer uma das funções definidas no ficheiro de configuração de sessão, poderão iniciar uma sessão JEA, mas só tem acesso para os cmdlets de predefinição.</span><span class="sxs-lookup"><span data-stu-id="a655c-177">If additional users are granted access to the JEA endpoint but do not fall into any of the roles defined in the session configuration file, they will be able to start a JEA session but only have access to the default cmdlets.</span></span>
<span data-ttu-id="a655c-178">Pode auditar as permissões de utilizador num ponto final JEA executando `Get-PSSessionCapability`.</span><span class="sxs-lookup"><span data-stu-id="a655c-178">You can audit user permissions in a JEA endpoint by running `Get-PSSessionCapability`.</span></span>
<span data-ttu-id="a655c-179">Veja o [auditoria e de relatórios no JEA](audit-and-report.md) artigo para obter mais informações sobre a auditoria de que os comandos de um utilizador tem acesso num ponto final JEA.</span><span class="sxs-lookup"><span data-stu-id="a655c-179">Check out the [Auditing and Reporting on JEA](audit-and-report.md) article for more information about auditing which commands a user has access to in a JEA endpoint.</span></span>

## <a name="least-privilege-roles"></a><span data-ttu-id="a655c-180">Funções do menor privilégio</span><span class="sxs-lookup"><span data-stu-id="a655c-180">Least privilege roles</span></span>

<span data-ttu-id="a655c-181">Ao conceber funções JEA, é importante lembrar-se de que o virtual ou grupo serviço gerido conta em execução nos bastidores, muitas vezes, tem acesso sem restrições para gerir o computador local.</span><span class="sxs-lookup"><span data-stu-id="a655c-181">When designing JEA roles, it is important to remember that the virtual or group managed service account running behind the scenes often has unrestricted access to manage the local machine.</span></span>
<span data-ttu-id="a655c-182">Capacidades de função JEA ajudam a restringir a que essa conta pode ser utilizada ao limitar os comandos e as aplicações que podem ser executadas utilizando nesse contexto com privilégios.</span><span class="sxs-lookup"><span data-stu-id="a655c-182">JEA role capabilities help restrict what that account can be used for by limiting the commands and applications that can be run using that privileged context.</span></span>
<span data-ttu-id="a655c-183">Funções concebidas incorretamente podem permitir perigosos comandos a executar que podem permitir que um utilizador break fora dos limites JEA ou obter acesso a informações confidenciais.</span><span class="sxs-lookup"><span data-stu-id="a655c-183">Improperly designed roles can allow dangerous commands to run that may allow a user to break out of the JEA boundaries or obtain access to sensitive information.</span></span>

<span data-ttu-id="a655c-184">Por exemplo, considere a seguinte entrada de capacidade de função:</span><span class="sxs-lookup"><span data-stu-id="a655c-184">For example, consider the following role capability entry:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\*-Process'
}
```

<span data-ttu-id="a655c-185">Esta capacidade de função permite aos utilizadores executar qualquer cmdlet do PowerShell com o nome "Processo" do módulo de Management.</span><span class="sxs-lookup"><span data-stu-id="a655c-185">This role capability allows users to run any PowerShell cmdlet with the noun "Process" from the Microsoft.PowerShell.Management module.</span></span>
<span data-ttu-id="a655c-186">Os utilizadores podem precisar aceder aos cmdlets como `Get-Process` para compreender que aplicações estão em execução no sistema e `Stop-Process` eliminar qualquer suspensos aplicações.</span><span class="sxs-lookup"><span data-stu-id="a655c-186">Users may need to access cmdlets like `Get-Process` to understand what applications are running on the system and `Stop-Process` to kill any hung applications.</span></span>
<span data-ttu-id="a655c-187">No entanto, esta entrada também permite `Start-Process`, que podem ser utilizadas para iniciar um programa arbitrário com permissões de administrador total.</span><span class="sxs-lookup"><span data-stu-id="a655c-187">However, this entry also allows `Start-Process`, which can be used to start up an arbitrary program with full administrator permissions.</span></span>
<span data-ttu-id="a655c-188">O programa não tem de estar instalado localmente no sistema, pelo que um adversário simplesmente foi possível iniciar um programa numa partilha de ficheiros que permite ao utilizador ligados de privilégios de administrador local, executa malware e muito mais.'</span><span class="sxs-lookup"><span data-stu-id="a655c-188">The program doesn't need to be installed locally on the system, so an adversary could simply start a program on a file share that gives the connecting user local admin privileges, runs malware, and more.'</span></span>

<span data-ttu-id="a655c-189">Uma versão mais segura desta mesma capacidade de função deverá ter o seguinte aspeto:</span><span class="sxs-lookup"><span data-stu-id="a655c-189">A more secure version of this same role capability would look like:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\Get-Process', 'Microsoft.PowerShell.Management\Stop-Process'
}
```

<span data-ttu-id="a655c-190">Evitar a utilização de carateres universais no capacidades de função e não se esqueça de [auditoria permissões de utilizador Efetivo](audit-and-report.md#check-effective-rights-for-a-specific-user) regularmente a compreender de que os comandos de um utilizador tem acesso.</span><span class="sxs-lookup"><span data-stu-id="a655c-190">Avoid using wildcards in role capabilities, and be sure to [audit effective user permissions](audit-and-report.md#check-effective-rights-for-a-specific-user) regularly to understand which commands a user has access to.</span></span>

## <a name="jea-does-not-protect-against-admins"></a><span data-ttu-id="a655c-191">JEA não protege contra a admins</span><span class="sxs-lookup"><span data-stu-id="a655c-191">JEA does not protect against admins</span></span>

<span data-ttu-id="a655c-192">Um dos princípios de núcleos de JEA é permitir que não administradores efetuar *algumas* tarefas de administração.</span><span class="sxs-lookup"><span data-stu-id="a655c-192">One of the core principles of JEA is that it allows non-admins to perform *some* admin tasks.</span></span>
<span data-ttu-id="a655c-193">JEA não protege contra a quem já ter privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="a655c-193">JEA does not protect against those who already have administrator privileges.</span></span>
<span data-ttu-id="a655c-194">Os utilizadores que pertencem "admins do domínio," "local admins", ou outros grupos altamente privilegiados no seu ambiente ainda será capazes de contornar proteções do JEA inscrevendo-os no computador através de outro meio.</span><span class="sxs-lookup"><span data-stu-id="a655c-194">Users who belong "domain admins," "local admins," or other highly privileged groups in your environment will still be able to get around JEA's protections by signing into the machine via another means.</span></span>
<span data-ttu-id="a655c-195">Por exemplo, estes foi, inicie sessão com RDP, utilize consolas remotas do MMC ou ligar a pontos finais de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a655c-195">They could, for example, sign in with RDP, use remote MMC consoles, or connect to unconstrained PowerShell endpoints.</span></span>
<span data-ttu-id="a655c-196">Administradores local no sistema, também podem modificar as configurações de JEA para permitir que os utilizadores adicionais gerir o sistema ou alterar uma capacidade de função para expandir o âmbito do que um utilizador pode fazer na sua sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="a655c-196">Local admins on the system can also modify JEA configurations to allow additional users to manage the system or change a role capability to extend the scope of what a user can do in their JEA session.</span></span>
<span data-ttu-id="a655c-197">Consequentemente, é importante avaliar as permissões de expandida dos seus utilizadores JEA para ver se existem outras formas foi ganham acesso privilegiado ao sistema.</span><span class="sxs-lookup"><span data-stu-id="a655c-197">It is therefore important to evaluate your JEA users' extended permissions to see if there are other ways they could gain privileged access to the system.</span></span>

<span data-ttu-id="a655c-198">É uma prática comum utilizar JEA para manutenção de rotina regular e ter um "apenas no tempo" privilegiado solução de gestão de acesso permitir que os utilizadores ficam temporariamente administradores local em situações de emergência.</span><span class="sxs-lookup"><span data-stu-id="a655c-198">A common practice is to use JEA for regular day-to-day maintenance and have a "just in time" privileged access management solution allow users to temporarily become local admins in emergency situations.</span></span>
<span data-ttu-id="a655c-199">Isto ajuda a certifique-se de que os utilizadores não são administradores permanentes no sistema, mas podem obter esses direitos se, e apenas quando, concluírem o fluxo de trabalho que documentos a utilização dessas permissões.</span><span class="sxs-lookup"><span data-stu-id="a655c-199">This helps ensure users are not permanent admins on the system, but can get those rights if, and only when, they complete a workflow that documents their use of those permissions.</span></span>

