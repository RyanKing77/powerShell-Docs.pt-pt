---
ms.date: 07/10/2019
keywords: jea, powershell, segurança
title: Considerações de segurança JEA
ms.openlocfilehash: befc24fec368c4f6d60477daf63bf17e9431133e
ms.sourcegitcommit: 46bebe692689ebedfe65ff2c828fe666b443198d
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 07/10/2019
ms.locfileid: "67726579"
---
# <a name="jea-security-considerations"></a><span data-ttu-id="b81e5-103">Considerações de segurança JEA</span><span class="sxs-lookup"><span data-stu-id="b81e5-103">JEA Security Considerations</span></span>

<span data-ttu-id="b81e5-104">JEA ajuda-o a melhorar a sua postura de segurança, reduzindo o número de administradores permanentes nas suas máquinas.</span><span class="sxs-lookup"><span data-stu-id="b81e5-104">JEA helps you improve your security posture by reducing the number of permanent administrators on your machines.</span></span> <span data-ttu-id="b81e5-105">JEA utiliza uma configuração de sessão do PowerShell para criar um novo ponto de entrada para os utilizadores gerir o sistema.</span><span class="sxs-lookup"><span data-stu-id="b81e5-105">JEA uses a PowerShell session configuration to create a new entry point for users to manage the system.</span></span> <span data-ttu-id="b81e5-106">Os utilizadores que precisam de acesso elevado, mas não ilimitado, para a máquina para realizar tarefas administrativas, podem ser concedidos acesso ao ponto final JEA.</span><span class="sxs-lookup"><span data-stu-id="b81e5-106">Users who need elevated, but not unlimited, access to the machine to do administrative tasks can be granted access to the JEA endpoint.</span></span> <span data-ttu-id="b81e5-107">Uma vez que o JEA permite que esses usuários executar comandos de administrador sem ter acesso de administrador completo, em seguida, pode remover esses utilizadores de grupos de segurança com privilégios elevados.</span><span class="sxs-lookup"><span data-stu-id="b81e5-107">Since JEA allows these users to run admin commands without having full admin access, you can then remove those users from highly privileged security groups.</span></span>

## <a name="run-as-account"></a><span data-ttu-id="b81e5-108">Conta Run As</span><span class="sxs-lookup"><span data-stu-id="b81e5-108">Run-As account</span></span>

<span data-ttu-id="b81e5-109">Cada ponto final da JEA tem um designado **Run** conta.</span><span class="sxs-lookup"><span data-stu-id="b81e5-109">Each JEA endpoint has a designated **run-as** account.</span></span> <span data-ttu-id="b81e5-110">Esta é a conta sob a qual são executadas ações do usuário conectado.</span><span class="sxs-lookup"><span data-stu-id="b81e5-110">This is the account under which the connecting user's actions are executed.</span></span> <span data-ttu-id="b81e5-111">Esta conta pode ser configurada no [o ficheiro de configuração de sessão](session-configurations.md), e a conta que escolher tem um efeito significativo sobre a segurança do seu ponto final.</span><span class="sxs-lookup"><span data-stu-id="b81e5-111">This account is configurable in the [session configuration file](session-configurations.md), and the account you choose has a significant bearing on the security of your endpoint.</span></span>

<span data-ttu-id="b81e5-112">**Contas virtuais** são a forma recomendada de configurar o **Run** conta.</span><span class="sxs-lookup"><span data-stu-id="b81e5-112">**Virtual accounts** are the recommended way of configuring the **run-as** account.</span></span> <span data-ttu-id="b81e5-113">Contas virtuais são a únicas de temporárias contas locais que são criadas para o usuário conectado a utilizar durante a duração da sua sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="b81e5-113">Virtual accounts are one-time, temporary local accounts that are created for the connecting user to use during the duration of their JEA session.</span></span> <span data-ttu-id="b81e5-114">Assim que a sessão foi terminada, a conta virtual é destruída e não pode ser utilizada.</span><span class="sxs-lookup"><span data-stu-id="b81e5-114">As soon as their session is terminated, the virtual account is destroyed and can't be used anymore.</span></span> <span data-ttu-id="b81e5-115">O usuário conectado, não sabe as credenciais da conta virtual.</span><span class="sxs-lookup"><span data-stu-id="b81e5-115">The connecting user doesn't know the credentials for the virtual account.</span></span> <span data-ttu-id="b81e5-116">Não é possível utilizar a conta virtual para aceder ao sistema através de outros meios, como o ambiente de trabalho remoto ou um ponto de extremidade irrestrita do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="b81e5-116">The virtual account can't be used to access the system via other means like Remote Desktop or an unconstrained PowerShell endpoint.</span></span>

<span data-ttu-id="b81e5-117">Por predefinição, as contas virtuais pertencem local **administradores** grupo na máquina.</span><span class="sxs-lookup"><span data-stu-id="b81e5-117">By default, virtual accounts belong to the local **Administrators** group on the machine.</span></span> <span data-ttu-id="b81e5-118">Isto dá a eles todos os direitos para gerir qualquer coisa no sistema, mas nenhum direito para gerir os recursos na rede.</span><span class="sxs-lookup"><span data-stu-id="b81e5-118">This gives them full rights to manage anything on the system, but no rights to manage resources on the network.</span></span>
<span data-ttu-id="b81e5-119">Durante a autenticação com outras máquinas, o contexto do usuário é que a conta de computador local, a conta virtual.</span><span class="sxs-lookup"><span data-stu-id="b81e5-119">When authenticating with other machines, the user context is that of the local computer account, not the virtual account.</span></span>

<span data-ttu-id="b81e5-120">Controladores de domínio são um caso especial, uma vez que existem não é um local **administradores** grupo.</span><span class="sxs-lookup"><span data-stu-id="b81e5-120">Domain controllers are a special case since there isn't a local **Administrators** group.</span></span> <span data-ttu-id="b81e5-121">Em vez disso, as contas virtuais pertencem à **Admins do domínio** e pode gerir os serviços de diretório no controlador de domínio.</span><span class="sxs-lookup"><span data-stu-id="b81e5-121">Instead, virtual accounts belong to **Domain Admins** and can manage the directory services on the domain controller.</span></span> <span data-ttu-id="b81e5-122">A identidade de domínio é ainda restringida para utilização no controlador de domínio em que a sessão JEA foi instanciada.</span><span class="sxs-lookup"><span data-stu-id="b81e5-122">The domain identity is still restricted for use on the domain controller where the JEA session was instantiated.</span></span> <span data-ttu-id="b81e5-123">É apresentada qualquer acesso de rede proveniente do objeto de computador do controlador de domínio em vez disso.</span><span class="sxs-lookup"><span data-stu-id="b81e5-123">Any network access appears to come from the domain controller computer object instead.</span></span>

<span data-ttu-id="b81e5-124">Em ambos os casos, pode definir explicitamente quais grupos de segurança da conta virtual pertence.</span><span class="sxs-lookup"><span data-stu-id="b81e5-124">In both cases, you may explicitly define which security groups the virtual account belongs to.</span></span> <span data-ttu-id="b81e5-125">Esta é uma boa prática, quando a tarefa pode ser feita sem privilégios de administrador local ou de domínio.</span><span class="sxs-lookup"><span data-stu-id="b81e5-125">This is a good practice when the task can be done without local or domain admin privileges.</span></span> <span data-ttu-id="b81e5-126">Se já tiver um grupo de segurança definido para os seus administradores, conceda a associação de conta virtual a esse grupo.</span><span class="sxs-lookup"><span data-stu-id="b81e5-126">If you already have a security group defined for your admins, grant the virtual account membership to that group.</span></span> <span data-ttu-id="b81e5-127">A associação de grupo conta virtual é limitada a grupos de segurança local nos servidores de estação de trabalho e o membro.</span><span class="sxs-lookup"><span data-stu-id="b81e5-127">Virtual account group membership is limited to local security groups on workstation and member servers.</span></span> <span data-ttu-id="b81e5-128">Em controladores de domínio virtual contas tem de ser membros dos grupos de segurança do domínio.</span><span class="sxs-lookup"><span data-stu-id="b81e5-128">On domain controllers, virtual accounts must be members of domain security groups.</span></span>
<span data-ttu-id="b81e5-129">Depois de adicionada a um ou mais grupos de segurança, a conta virtual já não pertence aos grupos padrão (administradores locais ou de domínio).</span><span class="sxs-lookup"><span data-stu-id="b81e5-129">Once the virtual account has been added to one or more security groups, it no longer belongs to the default groups (local or domain admins).</span></span>

<span data-ttu-id="b81e5-130">A tabela seguinte resume as opções de configuração possíveis e permissões resultantes para contas virtuais:</span><span class="sxs-lookup"><span data-stu-id="b81e5-130">The following table summarizes the possible configuration options and resulting permissions for virtual accounts:</span></span>

|        <span data-ttu-id="b81e5-131">Tipo de computador</span><span class="sxs-lookup"><span data-stu-id="b81e5-131">Computer type</span></span>         | <span data-ttu-id="b81e5-132">Configuração do grupo de conta virtual</span><span class="sxs-lookup"><span data-stu-id="b81e5-132">Virtual account group configuration</span></span> |                   <span data-ttu-id="b81e5-133">Contexto de utilizador local</span><span class="sxs-lookup"><span data-stu-id="b81e5-133">Local user context</span></span>                    | <span data-ttu-id="b81e5-134">Contexto de utilizador de rede</span><span class="sxs-lookup"><span data-stu-id="b81e5-134">Network user context</span></span> |
| ---------------------------- | ----------------------------------- | ------------------------------------------------------- | -------------------- |
| <span data-ttu-id="b81e5-135">Controlador de domínio</span><span class="sxs-lookup"><span data-stu-id="b81e5-135">Domain controller</span></span>            | <span data-ttu-id="b81e5-136">Predefinição</span><span class="sxs-lookup"><span data-stu-id="b81e5-136">Default</span></span>                             | <span data-ttu-id="b81e5-137">Utilizador de domínio, o membro de '*domínio*administradores \Domain</span><span class="sxs-lookup"><span data-stu-id="b81e5-137">Domain user, member of '*DOMAIN*\Domain Admins'</span></span>         | <span data-ttu-id="b81e5-138">Conta de computador</span><span class="sxs-lookup"><span data-stu-id="b81e5-138">Computer account</span></span>     |
| <span data-ttu-id="b81e5-139">Controlador de domínio</span><span class="sxs-lookup"><span data-stu-id="b81e5-139">Domain controller</span></span>            | <span data-ttu-id="b81e5-140">Grupos de domínio A e B</span><span class="sxs-lookup"><span data-stu-id="b81e5-140">Domain groups A and B</span></span>               | <span data-ttu-id="b81e5-141">Utilizador de domínio, o membro de '*domínio*\A ','*domínio*\B'</span><span class="sxs-lookup"><span data-stu-id="b81e5-141">Domain user, member of '*DOMAIN*\A', '*DOMAIN*\B'</span></span>       | <span data-ttu-id="b81e5-142">Conta de computador</span><span class="sxs-lookup"><span data-stu-id="b81e5-142">Computer account</span></span>     |
| <span data-ttu-id="b81e5-143">Servidor membro ou estação de trabalho</span><span class="sxs-lookup"><span data-stu-id="b81e5-143">Member server or workstation</span></span> | <span data-ttu-id="b81e5-144">Predefinição</span><span class="sxs-lookup"><span data-stu-id="b81e5-144">Default</span></span>                             | <span data-ttu-id="b81e5-145">Utilizador local, o membro de '*BUILTIN*dos \Administrators</span><span class="sxs-lookup"><span data-stu-id="b81e5-145">Local user, member of '*BUILTIN*\Administrators'</span></span>        | <span data-ttu-id="b81e5-146">Conta de computador</span><span class="sxs-lookup"><span data-stu-id="b81e5-146">Computer account</span></span>     |
| <span data-ttu-id="b81e5-147">Servidor membro ou estação de trabalho</span><span class="sxs-lookup"><span data-stu-id="b81e5-147">Member server or workstation</span></span> | <span data-ttu-id="b81e5-148">Grupos locais, C e D</span><span class="sxs-lookup"><span data-stu-id="b81e5-148">Local groups C and D</span></span>                | <span data-ttu-id="b81e5-149">Utilizador local, o membro de '*computador*\C' e '*computador*\D'</span><span class="sxs-lookup"><span data-stu-id="b81e5-149">Local user, member of '*COMPUTER*\C' and '*COMPUTER*\D'</span></span> | <span data-ttu-id="b81e5-150">Conta de computador</span><span class="sxs-lookup"><span data-stu-id="b81e5-150">Computer account</span></span>     |

<span data-ttu-id="b81e5-151">Quando examinar os eventos de auditoria de segurança e logs de eventos do aplicativo, verá que cada sessão de utilizador JEA tem uma conta virtual exclusiva.</span><span class="sxs-lookup"><span data-stu-id="b81e5-151">When you look at security audit events and application event logs, you see that each JEA user session has a unique virtual account.</span></span> <span data-ttu-id="b81e5-152">Esta conta exclusiva ajuda-o a controlar as ações do usuário num ponto final JEA novamente para o utilizador original que executou o comando.</span><span class="sxs-lookup"><span data-stu-id="b81e5-152">This unique account helps you track user actions in a JEA endpoint back to the original user who ran the command.</span></span> <span data-ttu-id="b81e5-153">Conta virtual nomes seguem o formato `WinRM Virtual Users\WinRM_VA_<ACCOUNTNUMBER>_<DOMAIN>_<sAMAccountName>` por exemplo, se usuário **Alice** no domínio **Contoso** reinicia um serviço num ponto de final JEA, o nome de utilizador associada a qualquer Gerenciador de controle de serviço eventos seria `WinRM Virtual Users\WinRM_VA_1_contoso_alice`.</span><span class="sxs-lookup"><span data-stu-id="b81e5-153">Virtual account names follow the format `WinRM Virtual Users\WinRM_VA_<ACCOUNTNUMBER>_<DOMAIN>_<sAMAccountName>` For example, if user **Alice** in domain **Contoso** restarts a service in a JEA endpoint, the username associated with any service control manager events would be `WinRM Virtual Users\WinRM_VA_1_contoso_alice`.</span></span>

<span data-ttu-id="b81e5-154">**Contas de serviço gerida de grupo (gMSAs)** são úteis quando um servidor membro tem de ter acesso a recursos de rede na sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="b81e5-154">**Group-managed service accounts (gMSAs)** are useful when a member server needs to have access to network resources in the JEA session.</span></span> <span data-ttu-id="b81e5-155">Por exemplo, quando um ponto final JEA é utilizado para controlar o acesso a um serviço de REST API alojado num computador diferente.</span><span class="sxs-lookup"><span data-stu-id="b81e5-155">For example, when a JEA endpoint is used to control access to a REST API service hosted on a different machine.</span></span> <span data-ttu-id="b81e5-156">É fácil escrever funções para chamar as APIs REST, mas terá uma identidade de rede para se autenticar com a API.</span><span class="sxs-lookup"><span data-stu-id="b81e5-156">It's easy to write functions to invoke the REST APIs, but you need a network identity to authenticate with the API.</span></span> <span data-ttu-id="b81e5-157">Utilizar uma conta de serviço gerida de grupo torna o segundo salto possível e manter o controlo sobre o qual os computadores podem utilizar a conta.</span><span class="sxs-lookup"><span data-stu-id="b81e5-157">Using a group-managed service account makes the second hop possible while maintaining control over which computers can use the account.</span></span> <span data-ttu-id="b81e5-158">As permissões efetivas da gMSA são definidas por grupos de segurança (locais ou de domínio) para que a conta gMSA pertence.</span><span class="sxs-lookup"><span data-stu-id="b81e5-158">The effective permissions of the gMSA are defined by the security groups (local or domain) to which the gMSA account belongs.</span></span>

<span data-ttu-id="b81e5-159">Quando um ponto final JEA é configurado para utilizar um gMSA, as ações de todos os utilizadores JEA aparecem provenientes do mesmo gMSA.</span><span class="sxs-lookup"><span data-stu-id="b81e5-159">When a JEA endpoint is configured to use a gMSA, the actions of all JEA users appear to come from the same gMSA.</span></span> <span data-ttu-id="b81e5-160">A única forma de ações de rastreio para um utilizador específico é identificar o conjunto de comandos são executados numa transcrição de sessão do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="b81e5-160">The only way to trace actions back to a specific user is to identify the set of commands run in a PowerShell session transcript.</span></span>

<span data-ttu-id="b81e5-161">**Pass-até credenciais** são utilizados quando não especificar um **Run** conta.</span><span class="sxs-lookup"><span data-stu-id="b81e5-161">**Pass-thru credentials** are used when you don't specify a **run-as** account.</span></span> <span data-ttu-id="b81e5-162">PowerShell utiliza credenciais de ligação do utilizador para executar comandos no servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="b81e5-162">PowerShell uses the connecting user's credential to run commands on the remote server.</span></span> <span data-ttu-id="b81e5-163">Isto requer a conceder o acesso direto de utilizador ao ligar a grupos de gestão com privilégios.</span><span class="sxs-lookup"><span data-stu-id="b81e5-163">This requires you to grant the connecting user direct access to privileged management groups.</span></span> <span data-ttu-id="b81e5-164">Esta configuração é **não** recomendado para JEA.</span><span class="sxs-lookup"><span data-stu-id="b81e5-164">This configuration is **not** recommended for JEA.</span></span> <span data-ttu-id="b81e5-165">Se o usuário conectado já tiver privilégios de administrador, pode evitar JEA e gerir o sistema por meio de outro, irrestrita.</span><span class="sxs-lookup"><span data-stu-id="b81e5-165">If the connecting user already has admin privileges, they can avoid JEA and manage the system via other, unconstrained means.</span></span> <span data-ttu-id="b81e5-166">Para obter mais informações, consulte a secção abaixo sobre como [JEA não protege contra administradores](#jea-doesnt-protect-against-admins).</span><span class="sxs-lookup"><span data-stu-id="b81e5-166">For more information, see the section below on how [JEA doesn't protect against admins](#jea-doesnt-protect-against-admins).</span></span>

<span data-ttu-id="b81e5-167">**Contas executar como padrão** permitem-lhe especificar uma conta de utilizador na qual a sessão do PowerShell toda é executado.</span><span class="sxs-lookup"><span data-stu-id="b81e5-167">**Standard run-as accounts** allow you to specify any user account under which the entire PowerShell session runs.</span></span> <span data-ttu-id="b81e5-168">Fixo de configurações de sessão usando **Run** contas (com o `-RunAsCredential` parâmetro) não têm consciência de JEA.</span><span class="sxs-lookup"><span data-stu-id="b81e5-168">Session configurations using fixed **run-as** accounts (with the `-RunAsCredential` parameter) aren't JEA-aware.</span></span> <span data-ttu-id="b81e5-169">Definições de funções deixarão de funcionar conforme esperado.</span><span class="sxs-lookup"><span data-stu-id="b81e5-169">Role definitions no longer function as expected.</span></span> <span data-ttu-id="b81e5-170">Cada usuário tem autorizado para aceder ao ponto final é atribuído a mesma função.</span><span class="sxs-lookup"><span data-stu-id="b81e5-170">Every user authorized to access the endpoint is assigned the same role.</span></span>

<span data-ttu-id="b81e5-171">Não deve utilizar um **RunAsCredential** num ponto final JEA porque é difícil para ações de rastreio para específico utilizadores e não dispõe o suporte para o mapeamento de utilizadores a funções.</span><span class="sxs-lookup"><span data-stu-id="b81e5-171">You shouldn't use a **RunAsCredential** on a JEA endpoint because it's difficult to trace actions back to specific users and lacks support for mapping users to roles.</span></span>

## <a name="winrm-endpoint-acl"></a><span data-ttu-id="b81e5-172">ACL de ponto final WinRM</span><span class="sxs-lookup"><span data-stu-id="b81e5-172">WinRM Endpoint ACL</span></span>

<span data-ttu-id="b81e5-173">Como com regulares PowerShell remoting pontos finais, cada ponto final da JEA tem uma lista de controlo de acesso separado (ACL) que controla quem pode autenticar com o ponto final da JEA.</span><span class="sxs-lookup"><span data-stu-id="b81e5-173">As with regular PowerShell remoting endpoints, each JEA endpoint has a separate access control list (ACL) that controls who can authenticate with the JEA endpoint.</span></span> <span data-ttu-id="b81e5-174">Se configurado incorretamente, utilizadores fidedignos podem não conseguir aceder ao ponto de final JEA e os utilizadores não fidedignos podem ter acesso.</span><span class="sxs-lookup"><span data-stu-id="b81e5-174">If improperly configured, trusted users may not be able to access the JEA endpoint and untrusted users may have access.</span></span> <span data-ttu-id="b81e5-175">A ACL de WinRM não afeta o mapeamento de utilizadores às funções JEA.</span><span class="sxs-lookup"><span data-stu-id="b81e5-175">The WinRM ACL doesn't affect the mapping of users to JEA roles.</span></span> <span data-ttu-id="b81e5-176">Mapeamento é controlado pelos **RoleDefinitions** campo no ficheiro de configuração de sessão utilizado para registar o ponto final.</span><span class="sxs-lookup"><span data-stu-id="b81e5-176">Mapping is controlled by the **RoleDefinitions** field in the session configuration file used to register the endpoint.</span></span>

<span data-ttu-id="b81e5-177">Por predefinição, quando um ponto final JEA tem várias funcionalidades de função, a ACL de WinRM está configurada para permitir o acesso a todos os utilizadores mapeados.</span><span class="sxs-lookup"><span data-stu-id="b81e5-177">By default, when a JEA endpoint has multiple role capabilities, the WinRM ACL is configured to allow access to all mapped users.</span></span> <span data-ttu-id="b81e5-178">Por exemplo, uma sessão JEA configurada com os comandos seguintes concede acesso total à `CONTOSO\JEA_Lev1` e `CONTOSO\JEA_Lev2`.</span><span class="sxs-lookup"><span data-stu-id="b81e5-178">For example, a JEA session configured using the following commands grants full access to `CONTOSO\JEA_Lev1` and `CONTOSO\JEA_Lev2`.</span></span>

```powershell
$roles = @{ 'CONTOSO\JEA_Lev1' = 'Lev1Role'; 'CONTOSO\JEA_Lev2' = 'Lev2Role' }
New-PSSessionConfigurationFile -Path '.\jea.pssc' -SessionType RestrictedRemoteServer -RoleDefinitions $roles -RunAsVirtualAccount
Register-PSSessionConfiguration -Path '.\jea.pssc' -Name 'MyJEAEndpoint'
```

<span data-ttu-id="b81e5-179">É possível auditar as permissões de utilizador com o [Get-PSSessionConfiguration](/powershell/module/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="b81e5-179">You can audit user permissions with the [Get-PSSessionConfiguration](/powershell/module/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span></span>

```powershell
Get-PSSessionConfiguration -Name 'MyJEAEndpoint' | Select-Object Permission
```

```Output
Permission
----------
CONTOSO\JEA_Lev1 AccessAllowed
CONTOSO\JEA_Lev2 AccessAllowed
```

<span data-ttu-id="b81e5-180">Para alterar os utilizadores que têm acesso, execute `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` para uma linha de comandos interativa ou `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` para atualizar as permissões.</span><span class="sxs-lookup"><span data-stu-id="b81e5-180">To change which users have access, run either `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` for an interactive prompt or `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` to update the permissions.</span></span> <span data-ttu-id="b81e5-181">Os utilizadores necessitam de pelo menos *Invoke* direitos para aceder ao ponto de final JEA.</span><span class="sxs-lookup"><span data-stu-id="b81e5-181">Users need at least *Invoke* rights to access the JEA endpoint.</span></span>

<span data-ttu-id="b81e5-182">É possível criar um ponto final JEA que não mapeiam uma função definida para cada utilizador que tenha acesso.</span><span class="sxs-lookup"><span data-stu-id="b81e5-182">It's possible to create a JEA endpoint that doesn't map a defined role to every user that has access.</span></span> <span data-ttu-id="b81e5-183">Estes utilizadores podem iniciar uma sessão JEA, mas só tem acesso aos cmdlets do padrão.</span><span class="sxs-lookup"><span data-stu-id="b81e5-183">These users can start a JEA session, but only have access to the default cmdlets.</span></span> <span data-ttu-id="b81e5-184">É possível auditar as permissões de utilizador num ponto final JEA executando `Get-PSSessionCapability`.</span><span class="sxs-lookup"><span data-stu-id="b81e5-184">You can audit user permissions in a JEA endpoint by running `Get-PSSessionCapability`.</span></span> <span data-ttu-id="b81e5-185">Para obter mais informações, consulte [auditoria e relatórios na JEA](audit-and-report.md).</span><span class="sxs-lookup"><span data-stu-id="b81e5-185">For more information, see [Auditing and Reporting on JEA](audit-and-report.md).</span></span>

## <a name="least-privilege-roles"></a><span data-ttu-id="b81e5-186">Funções de privilégio mínimo</span><span class="sxs-lookup"><span data-stu-id="b81e5-186">Least privilege roles</span></span>

<span data-ttu-id="b81e5-187">Ao desenvolver funções JEA, é importante lembrar-se de que as contas de serviço gerida de grupo e virtual em execução em segundo plano podem ter acesso ilimitado ao computador local.</span><span class="sxs-lookup"><span data-stu-id="b81e5-187">When designing JEA roles, it's important to remember that the virtual and group-managed service accounts running behind the scenes can have unrestricted access to the local machine.</span></span> <span data-ttu-id="b81e5-188">Funcionalidades de função JEA ajudam a limitar os comandos e as aplicações que podem ser executadas em que o contexto privilegiado.</span><span class="sxs-lookup"><span data-stu-id="b81e5-188">JEA role capabilities help limit the commands and applications that can be run in that privileged context.</span></span>
<span data-ttu-id="b81e5-189">Funções desenvolvidas podem permitir que os comandos perigosos que podem permitir a um utilizador de invasão os limites JEA ou de obter acesso a informações confidenciais.</span><span class="sxs-lookup"><span data-stu-id="b81e5-189">Improperly designed roles can allow dangerous commands that may permit a user to break out of the JEA boundaries or obtain access to sensitive information.</span></span>

<span data-ttu-id="b81e5-190">Por exemplo, considere a seguinte entrada de recurso de função:</span><span class="sxs-lookup"><span data-stu-id="b81e5-190">For example, consider the following role capability entry:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\*-Process'
}
```

<span data-ttu-id="b81e5-191">Esta capacidade de função permite aos utilizadores executar qualquer cmdlet do PowerShell com o substantivo **processo** partir do **Management** módulo.</span><span class="sxs-lookup"><span data-stu-id="b81e5-191">This role capability allows users to run any PowerShell cmdlet with the noun **Process** from the **Microsoft.PowerShell.Management** module.</span></span> <span data-ttu-id="b81e5-192">Os usuários podem precisar acessar os cmdlets, como `Get-Process` para ver quais aplicativos estão sendo executados no sistema e `Stop-Process` para eliminar aplicativos que não estão a responder.</span><span class="sxs-lookup"><span data-stu-id="b81e5-192">Users may need to access cmdlets like `Get-Process` to see what applications are running on the system and `Stop-Process` to kill applications that aren't responding.</span></span> <span data-ttu-id="b81e5-193">No entanto, esta entrada também permite `Start-Process`, que pode ser utilizado para iniciar um programa arbitrário com permissões de administrador completo.</span><span class="sxs-lookup"><span data-stu-id="b81e5-193">However, this entry also allows `Start-Process`, which can be used to start up an arbitrary program with full administrator permissions.</span></span> <span data-ttu-id="b81e5-194">O programa não precisa ser instalado localmente no sistema.</span><span class="sxs-lookup"><span data-stu-id="b81e5-194">The program doesn't need to be installed locally on the system.</span></span> <span data-ttu-id="b81e5-195">Um usuário conectado foi possível iniciar um programa a partir de uma partilha de ficheiros que disponibiliza ao utilizador privilégios de administrador local, é executado software maligno e muito mais.</span><span class="sxs-lookup"><span data-stu-id="b81e5-195">A connected user could start a program from a file share that gives the user local admin privileges, runs malware, and more.</span></span>

<span data-ttu-id="b81e5-196">Uma versão mais segura desse mesmo recurso de função teria o seguinte aspeto:</span><span class="sxs-lookup"><span data-stu-id="b81e5-196">A more secure version of this same role capability would look like:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\Get-Process', 'Microsoft.PowerShell.Management\Stop-Process'
}
```

<span data-ttu-id="b81e5-197">Evite a utilização de carateres universais no funcionalidades de função.</span><span class="sxs-lookup"><span data-stu-id="b81e5-197">Avoid using wildcards in role capabilities.</span></span> <span data-ttu-id="b81e5-198">Não se esqueça de regularmente [auditar as permissões de utilizador Efetivo](audit-and-report.md#check-effective-rights-for-a-specific-user) para compreender quais comandos estão disponíveis ao usuário.</span><span class="sxs-lookup"><span data-stu-id="b81e5-198">Be sure to regularly [audit effective user permissions](audit-and-report.md#check-effective-rights-for-a-specific-user) to understand which commands are accessible to the user.</span></span>

## <a name="jea-doesnt-protect-against-admins"></a><span data-ttu-id="b81e5-199">JEA não protege contra administradores</span><span class="sxs-lookup"><span data-stu-id="b81e5-199">JEA doesn't protect against admins</span></span>

<span data-ttu-id="b81e5-200">Um dos princípios fundamentais da JEA é que ele permite fazer algumas tarefas de administração não administradores.</span><span class="sxs-lookup"><span data-stu-id="b81e5-200">One of the core principles of JEA is that it allows non-admins to do some admin tasks.</span></span> <span data-ttu-id="b81e5-201">JEA não protege contra utilizadores que já têm privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="b81e5-201">JEA doesn't protect against users who already have administrator privileges.</span></span> <span data-ttu-id="b81e5-202">Os utilizadores que pertencem **Admins do domínio**local **administradores**, ou outros grupos com privilégios elevados, podem contornar proteções de JEA por meio de outros meios.</span><span class="sxs-lookup"><span data-stu-id="b81e5-202">Users who belong **Domain Admins**, local **Administrators**, or other highly privileged groups can circumvent JEA's protections via another means.</span></span> <span data-ttu-id="b81e5-203">Por exemplo, pode iniciar sessão com o RDP, utilizar as consolas remotas do MMC ou ligar a pontos de extremidade de PowerShell irrestrita.</span><span class="sxs-lookup"><span data-stu-id="b81e5-203">For example, they could sign in with RDP, use remote MMC consoles, or connect to unconstrained PowerShell endpoints.</span></span> <span data-ttu-id="b81e5-204">Além disso, os administradores locais num sistema podem modificar configurações de JEA para permitir que os utilizadores adicionais ou alterar um recurso de função para estender o escopo do que um utilizador pode fazer na sua sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="b81e5-204">Also, local admins on a system can modify JEA configurations to allow additional users or change a role capability to extend the scope of what a user can do in their JEA session.</span></span> <span data-ttu-id="b81e5-205">É importante avaliar as permissões de expandida dos seus utilizadores JEA para ver se existem outras formas de obter acesso privilegiado ao sistema.</span><span class="sxs-lookup"><span data-stu-id="b81e5-205">It's important to evaluate your JEA users' extended permissions to see if there are other ways to gain privileged access to the system.</span></span>

<span data-ttu-id="b81e5-206">Uma prática comum é utilizar JEA para manutenção diária regular e fazer um just-in-time, solução de gestão de acesso privilegiado que permite que os usuários fiquem temporariamente administradores locais em situações de emergência.</span><span class="sxs-lookup"><span data-stu-id="b81e5-206">A common practice is to use JEA for regular day-to-day maintenance and have a just-in-time, privileged access management solution that allows users to temporarily become local admins in emergency situations.</span></span> <span data-ttu-id="b81e5-207">Isto ajuda a garantir que os utilizadores não são administradores permanentes no sistema, mas podem obter esses direitos se e somente quando, concluírem o fluxo de trabalho que documenta o uso dessas permissões.</span><span class="sxs-lookup"><span data-stu-id="b81e5-207">This helps ensure users aren't permanent admins on the system, but can get those rights if, and only when, they complete a workflow that documents their use of those permissions.</span></span>
