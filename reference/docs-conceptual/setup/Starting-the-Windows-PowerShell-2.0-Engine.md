---
ms.date: 06/05/2017
keywords: PowerShell, o cmdlet
title: Iniciar o Motor do Windows PowerShell 2.0
ms.assetid: edafc2fa-7576-49c2-bbba-9336f4bcfc28
ms.openlocfilehash: 618745ff4865dd046acf46487e87c3ca0e324f95
ms.sourcegitcommit: 735ccab3fb3834ccd8559fab6700b798e8e5ffbf
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 05/25/2018
---
# <a name="starting-the-windows-powershell-20-engine"></a><span data-ttu-id="c1dc7-103">Iniciar o Motor do Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="c1dc7-103">Starting the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="c1dc7-104">Esta secção explica como iniciar o motor do Windows PowerShell 2.0 no Windows 8.1, Windows Server 2012 R2, Windows 8 e Windows Server 2012, que incluem o motor do Windows PowerShell 2.0 e em outros sistemas na qual o Windows PowerShell 2.0, Windows PowerShell 3.0 e o Windows PowerShell 4.0 estão instalado.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-104">This section explains how to start the Windows PowerShell 2.0 Engine on Windows 8.1, Windows Server 2012 R2, Windows 8, and Windows Server 2012, which include the Windows PowerShell 2.0 Engine, and on other systems on which Windows PowerShell 2.0, Windows PowerShell 3.0, and Windows PowerShell 4.0 are installed.</span></span>

<span data-ttu-id="c1dc7-105">Windows PowerShell 4.0 e o Windows PowerShell 3.0 foram concebidos para serem retrocompatíveis com o Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-105">Windows PowerShell 4.0 and Windows PowerShell 3.0 are designed to be backwards compatible with Windows PowerShell 2.0.</span></span> <span data-ttu-id="c1dc7-106">Os cmdlets, fornecedores, snap-ins, módulos e scripts escritos para o Windows PowerShell 2.0 executam inalterados no Windows PowerShell 4.0 e o Windows PowerShell 3.0.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-106">Cmdlets, providers, snap-ins, modules, and scripts written for Windows PowerShell 2.0 run unchanged in Windows PowerShell 4.0 and Windows PowerShell 3.0.</span></span> <span data-ttu-id="c1dc7-107">No entanto, devido a uma alteração na política de ativação de tempo de execução no Microsoft .NET Framework 4, alojar programas do Windows PowerShell que foram escritos para o Windows PowerShell 2.0 e compilados com o Common Language Runtime (CLR) 2.0 não é possível executar sem modificação no Windows PowerShell 3.0 ou Windows PowerShell 4.0, que são compiladas com CLR 4.0.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-107">However, due to a change in the runtime activation policy in Microsoft .NET Framework 4, Windows PowerShell host programs that were written for Windows PowerShell 2.0 and compiled with Common Language Runtime (CLR) 2.0 cannot run without modification in Windows PowerShell 3.0 or Windows PowerShell 4.0, which are compiled with CLR 4.0.</span></span> <span data-ttu-id="c1dc7-108">O motor do Windows PowerShell 2.0 se destina a ser utilizado apenas quando um script existente ou não é possível executar o programa de anfitrião porque é incompatível com o Windows PowerShell 4.0, o Windows PowerShell 3.0 ou o Microsoft .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-108">The Windows PowerShell 2.0 Engine is intended to be used only when an existing script or host program cannot run because it is incompatible with Windows PowerShell 4.0, Windows PowerShell 3.0, or Microsoft .NET Framework 4.</span></span> <span data-ttu-id="c1dc7-109">Nestes casos deverão estar raro.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-109">Such cases are expected to be rare.</span></span>

<span data-ttu-id="c1dc7-110">Muitos programas que requerem o motor do Windows PowerShell 2.0 iniciam-o automaticamente.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-110">Many programs that require the Windows PowerShell 2.0 Engine start it automatically.</span></span> <span data-ttu-id="c1dc7-111">Estas instruções estão incluídas nas situações raras nos quais tem de iniciar o motor manualmente.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-111">These instructions are included for the rare situations in which you need to start the engine manually.</span></span>

## <a name="installing-and-enabling-required-programs"></a><span data-ttu-id="c1dc7-112">Instalar e ativar os programas necessários</span><span class="sxs-lookup"><span data-stu-id="c1dc7-112">Installing and Enabling Required Programs</span></span>

<span data-ttu-id="c1dc7-113">Antes de iniciar o motor do Windows PowerShell 2.0, ative o motor do Windows PowerShell 2.0 e o Microsoft .NET Framework 3.5 com Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-113">Before starting the Windows PowerShell 2.0 Engine, enable the Windows PowerShell 2.0 Engine and Microsoft .NET Framework 3.5 with Service Pack 1.</span></span> <span data-ttu-id="c1dc7-114">Para obter instruções, consulte [instalar o Windows PowerShell](Installing-Windows-PowerShell.md).</span><span class="sxs-lookup"><span data-stu-id="c1dc7-114">For instructions, see [Installing Windows PowerShell](Installing-Windows-PowerShell.md).</span></span>

<span data-ttu-id="c1dc7-115">Sistemas no qual [Windows Management Framework 4.0](http://go.microsoft.com/fwlink/?LinkID=293881) ou o Windows Management Framework 3.0 estão instalados ter todos os componentes necessários.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-115">Systems on which [Windows Management Framework 4.0](http://go.microsoft.com/fwlink/?LinkID=293881) or Windows Management Framework 3.0 are installed have all of the required components.</span></span> <span data-ttu-id="c1dc7-116">Não é necessária nenhuma configuração adicional.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-116">No further configuration is necessary.</span></span> <span data-ttu-id="c1dc7-117">Para obter informações sobre a instalação [Windows Management Framework 4.0](http://go.microsoft.com/fwlink/?LinkID=293881) ou o Windows Management Framework 3.0, consulte [instalar o Windows PowerShell](Installing-Windows-PowerShell.md).</span><span class="sxs-lookup"><span data-stu-id="c1dc7-117">For information about installing [Windows Management Framework 4.0](http://go.microsoft.com/fwlink/?LinkID=293881) or Windows Management Framework 3.0, see [Installing Windows PowerShell](Installing-Windows-PowerShell.md).</span></span>

## <a name="how-to-start-the-windows-powershell-20-engine"></a><span data-ttu-id="c1dc7-118">Como iniciar o motor do Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="c1dc7-118">How to start the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="c1dc7-119">Quando iniciar o Windows PowerShell a versão mais recente é iniciado por predefinição.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-119">When you start Windows PowerShell the newest version starts by default.</span></span> <span data-ttu-id="c1dc7-120">Para iniciar o Windows PowerShell com o motor do Windows PowerShell 2.0, utilize o parâmetro de versão de PowerShell.exe.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-120">To start Windows PowerShell with the Windows PowerShell 2.0 Engine, use the Version parameter of PowerShell.exe.</span></span> <span data-ttu-id="c1dc7-121">Pode executar o comando qualquer linha de comandos, incluindo o Windows PowerShell e Cmd.exe.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-121">You can run the command at any command prompt, including Windows PowerShell and Cmd.exe.</span></span>

```
PowerShell.exe -Version 2
```

## <a name="how-to-start-a-remote-session-with-the-windows-powershell-20-engine"></a><span data-ttu-id="c1dc7-122">Como iniciar uma sessão remota com o motor do Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="c1dc7-122">How to start a remote session with the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="c1dc7-123">Para executar uma sessão remota do motor do Windows PowerShell 2.0, crie uma configuração de sessão (também conhecido como um "ponto final") no computador remoto que carrega o motor do Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-123">To run the Windows PowerShell 2.0 Engine in a remote session, create a session configuration (also known as an "endpoint") on the remote computer that loads the Windows PowerShell 2.0 Engine.</span></span> <span data-ttu-id="c1dc7-124">A configuração de sessão é guardada no computador remoto e pode ser utilizada por qualquer utilizador autorizado a criar sessões que utilizam o motor do Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-124">The session configuration is saved on the remote computer and can be used by any authorized user to create sessions that use the Windows PowerShell 2.0 Engine.</span></span>

<span data-ttu-id="c1dc7-125">Esta é uma tarefa avançada que normalmente é efetuada por um administrador de sistema.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-125">This is an advanced task that is typically performed by a system administrator.</span></span>

<span data-ttu-id="c1dc7-126">O procedimento seguinte utiliza o **PSVersion** parâmetro o [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet para criar uma configuração de sessão que utiliza o motor do Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-126">The following procedure uses the **PSVersion** parameter of the [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet to create a session configuration that uses the Windows PowerShell 2.0 Engine.</span></span> <span data-ttu-id="c1dc7-127">Também pode utilizar o **PowerShellVersion** parâmetro o [New-PSSessionConfigurationFile](https://technet.microsoft.com/library/5f3e3633-6e90-479c-aea9-ba45a1954866) cmdlet para criar um ficheiro de configuração de sessão para uma sessão que carrega o motor do Windows PowerShell 2.0 e Pode utilizar o **PSVersion** parâmetro o [Set-PSSessionConfiguration](https://technet.microsoft.com/library/b21fbad3-1759-4260-b206-dcb8431cd6ea) parâmetro para alterar uma configuração de sessão para utilizar o motor do Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-127">You can also use the **PowerShellVersion** parameter of the [New-PSSessionConfigurationFile](https://technet.microsoft.com/library/5f3e3633-6e90-479c-aea9-ba45a1954866) cmdlet to create a session configuration file for a session that loads the Windows PowerShell 2.0 Engine and you can use the **PSVersion** parameter of the [Set-PSSessionConfiguration](https://technet.microsoft.com/library/b21fbad3-1759-4260-b206-dcb8431cd6ea) parameter to change a session configuration to use the Windows PowerShell 2.0 Engine.</span></span>

<span data-ttu-id="c1dc7-128">Para mais informações sobre os ficheiros de configuração de sessão, consulte [about_Session_Configuration_Files](https://technet.microsoft.com/library/c7217447-1ebf-477b-a8ef-4dbe9a1473b8). Para obter informações sobre configurações de sessão, incluindo a configuração e segurança, consulte [about_Session_Configurations [v4]](https://technet.microsoft.com/library/a2fbe12a-350c-4d04-be50-24102824e3ab).</span><span class="sxs-lookup"><span data-stu-id="c1dc7-128">For more information about session configuration files, see [about_Session_Configuration_Files](https://technet.microsoft.com/library/c7217447-1ebf-477b-a8ef-4dbe9a1473b8).For information about session configurations, including setup and security, see [about_Session_Configurations[v4]](https://technet.microsoft.com/library/a2fbe12a-350c-4d04-be50-24102824e3ab).</span></span>

#### <a name="to-start-a-remote-windows-powershell-20-session"></a><span data-ttu-id="c1dc7-129">Para iniciar uma sessão remota do Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="c1dc7-129">To start a remote Windows PowerShell 2.0 session</span></span>

1. <span data-ttu-id="c1dc7-130">Para criar uma configuração de sessão que requer que o motor do Windows PowerShell 2.0, utilize o **PSVersion** parâmetro o [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet com um valor de "2.0".</span><span class="sxs-lookup"><span data-stu-id="c1dc7-130">To create a session configuration that requires the Windows PowerShell 2.0 Engine, use the **PSVersion** parameter of the [Register-PSSessionConfiguration](https://technet.microsoft.com/library/e9152ae2-bd6d-4056-9bc7-dc1893aa29ea) cmdlet with a value of "2.0".</span></span> <span data-ttu-id="c1dc7-131">Execute este comando no computador no "lado do servidor" ou do recetor da ligação.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-131">Run this command on the computer at the "server side" or receiving end of the connection.</span></span>

   <span data-ttu-id="c1dc7-132">O comando de exemplo seguinte cria a configuração de sessão PS2 no computador servidor01.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-132">The following sample command creates the PS2 session configuration on the Server01 computer.</span></span> <span data-ttu-id="c1dc7-133">Para executar este comando, inicie o Windows PowerShell 4.0 ou o Windows PowerShell 3.0 com o **executar como administrador** opção.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-133">To run this command, start Windows PowerShell 4.0 or Windows PowerShell 3.0 with the **Run as administrator** option.</span></span>

   ```powershell
   Register-PSSessionConfiguration -Name PS2 -PSVersion 2.0
   ```

2. <span data-ttu-id="c1dc7-134">Para criar uma sessão no computador servidor01 que utiliza a configuração de sessão PS2, utilize o **ConfigurationName** parâmetro de cmdlets que criar uma sessão remota, tais como o [New-PSSession](https://technet.microsoft.com/library/76f6628c-054c-4eda-ba7a-a6f28daaa26f) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-134">To create a session on the Server01 computer that uses the PS2 session configuration, use the **ConfigurationName** parameter of cmdlets that create a remote session, such as the [New-PSSession](https://technet.microsoft.com/library/76f6628c-054c-4eda-ba7a-a6f28daaa26f) cmdlet.</span></span>

   <span data-ttu-id="c1dc7-135">Quando uma sessão que utiliza a configuração de sessão é iniciado, o motor do Windows PowerShell 2.0 automaticamente foi carregado para a sessão.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-135">When a session that uses the session configuration starts, the Windows PowerShell 2.0 Engine is automatically loaded into the session.</span></span>

   <span data-ttu-id="c1dc7-136">O seguinte comando inicia uma sessão no computador servidor01 que utiliza a configuração de sessão PS2.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-136">The following command starts a session on the Server01 computer that uses the PS2 session configuration.</span></span> <span data-ttu-id="c1dc7-137">O comando guarda a sessão na variável $s.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-137">The command saves the session in the $s variable.</span></span>

   ```powershell
   $s = New-PSSession -ComputerName Server01 -ConfigurationName PS2
   ```

## <a name="how-to-start-a-background-job-with-the-windows-powershell-20-engine"></a><span data-ttu-id="c1dc7-138">Como iniciar uma tarefa em segundo plano com o motor do Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="c1dc7-138">How to start a background job with the Windows PowerShell 2.0 Engine</span></span>

<span data-ttu-id="c1dc7-139">Para iniciar uma tarefa em segundo plano com o motor do Windows PowerShell 2.0, utilize o **PSVersion** parâmetro o [Start-Job](https://technet.microsoft.com/library/2bc04935-0deb-4ec0-b856-d7290cca6442) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="c1dc7-139">To start a background job with the Windows PowerShell 2.0 Engine, use the **PSVersion** parameter of the [Start-Job](https://technet.microsoft.com/library/2bc04935-0deb-4ec0-b856-d7290cca6442) cmdlet.</span></span>

<span data-ttu-id="c1dc7-140">O seguinte comando inicia uma tarefa em segundo plano com o motor do Windows PowerShell 2.0</span><span class="sxs-lookup"><span data-stu-id="c1dc7-140">The following command starts a background job with the Windows PowerShell 2.0 Engine</span></span>

```powershell
Start-Job {Get-Process} -PSVersion 2.0
```

<span data-ttu-id="c1dc7-141">Para mais informações sobre tarefas em segundo plano, consulte [about_Jobs](/powershell/module/microsoft.powershell.core/about/about_jobs).</span><span class="sxs-lookup"><span data-stu-id="c1dc7-141">For more information about background jobs, see [about_Jobs](/powershell/module/microsoft.powershell.core/about/about_jobs).</span></span>