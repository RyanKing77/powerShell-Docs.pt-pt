---
ms.date: 08/23/2017
keywords: PowerShell, o cmdlet
title: instalar e utilizar o acesso web windows powershell
ms.openlocfilehash: d718d9b286a8a2189f44f10983cdc0061e41d4b9
ms.sourcegitcommit: 6749f67c32e05999e10deb9d45f90f45ac21a599
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 10/09/2018
ms.locfileid: "48851329"
---
# <a name="install-and-use-windows-powershell-web-access"></a><span data-ttu-id="6bc02-103">Instalar e Utilizar o Acesso Web Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6bc02-103">Install and Use Windows PowerShell Web Access</span></span>

<span data-ttu-id="6bc02-104">Atualização: 5 de Novembro de 2013 (editado: 23 de Agosto de 2017)</span><span class="sxs-lookup"><span data-stu-id="6bc02-104">Updated: November 5, 2013 (Edited: August 23, 2017)</span></span>

<span data-ttu-id="6bc02-105">Aplica-se a: Windows Server 2012 R2, Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="6bc02-105">Applies To: Windows Server 2012 R2, Windows Server 2012</span></span>

## <a name="introduction"></a><span data-ttu-id="6bc02-106">Introdução</span><span class="sxs-lookup"><span data-stu-id="6bc02-106">Introduction</span></span>

<span data-ttu-id="6bc02-107">Windows PowerShell Web Access, introduzido pela primeira vez no Windows Server 2012, atua como um gateway do Windows PowerShell, fornecendo uma consola do Windows PowerShell baseada na web que é direcionada para um computador remoto.</span><span class="sxs-lookup"><span data-stu-id="6bc02-107">Windows PowerShell Web Access, first introduced in Windows Server 2012, acts as a Windows PowerShell gateway, providing a web-based Windows PowerShell console that is targeted at a remote computer.</span></span> <span data-ttu-id="6bc02-108">Permite que os profissionais de TI executar comandos do Windows PowerShell e scripts a partir de uma consola do Windows PowerShell num navegador da web, sem Windows PowerShell, o software de gestão remota ou a instalação Plug-in do browser necessária no dispositivo cliente.</span><span class="sxs-lookup"><span data-stu-id="6bc02-108">It enables IT Pros to run Windows PowerShell commands and scripts from a Windows PowerShell console in a web browser, with no Windows PowerShell, remote management software, or browser plug-in installation necessary on the client device.</span></span> <span data-ttu-id="6bc02-109">Tudo o que é necessário para executar a consola do Windows PowerShell baseada na web é um gateway de acesso do Windows PowerShell Web configurado corretamente e um browser de dispositivo do cliente que suporte a JavaScript e aceite cookies.</span><span class="sxs-lookup"><span data-stu-id="6bc02-109">All that is required to run the web-based Windows PowerShell console is a properly-configured Windows PowerShell Web Access gateway, and a client device browser that supports JavaScript and accepts cookies.</span></span>

<span data-ttu-id="6bc02-110">Exemplos de dispositivos cliente incluem computadores portáteis, computadores pessoais sem ser de trabalho, computadores emprestados, computadores tablet, quiosques Web, computadores sem sistema operativo baseado em Windows e browsers de telemóvel.</span><span class="sxs-lookup"><span data-stu-id="6bc02-110">Examples of client devices include laptops, non-work personal computers, borrowed computers, tablet computers, web kiosks, computers that are not running a Windows-based operating system, and cell phone browsers.</span></span> <span data-ttu-id="6bc02-111">Os profissionais de TI podem efetuar tarefas de gestão críticas em servidores remotos baseados no Windows a partir de dispositivos com acesso a uma ligação à Internet e a um browser.</span><span class="sxs-lookup"><span data-stu-id="6bc02-111">IT Pros can perform critical management tasks on remote Windows-based servers from devices that have access to an Internet connection and a web browser.</span></span>

<span data-ttu-id="6bc02-112">Após a instalação de gateway com êxito e a configuração, os utilizadores podem aceder a consola do Windows PowerShell, utilizando um navegador da web.</span><span class="sxs-lookup"><span data-stu-id="6bc02-112">After successful gateway setup and configuration, users can access a Windows PowerShell console by using a web browser.</span></span> <span data-ttu-id="6bc02-113">Quando os utilizadores abrem o site seguro do Windows PowerShell Web Access, eles podem ser executados uma consola do Windows PowerShell baseada na web após a autenticação com êxito.</span><span class="sxs-lookup"><span data-stu-id="6bc02-113">When users open the secured Windows PowerShell Web Access website, they can run a web-based Windows PowerShell console after successful authentication.</span></span>

<span data-ttu-id="6bc02-114">Configuração do Windows PowerShell Web Access e a configuração é um processo em três etapas:</span><span class="sxs-lookup"><span data-stu-id="6bc02-114">Windows PowerShell Web Access setup and configuration is a three-step process:</span></span>

1. [<span data-ttu-id="6bc02-115">Instalar o Windows PowerShell Web Access</span><span class="sxs-lookup"><span data-stu-id="6bc02-115">Install Windows PowerShell Web Access</span></span>](#install-windows-powershell-web-access)
1. [<span data-ttu-id="6bc02-116">Configurar o Gateway</span><span class="sxs-lookup"><span data-stu-id="6bc02-116">Configure the Gateway</span></span>](#configure-the-gateway)
1. [<span data-ttu-id="6bc02-117">Configurar uma regra de autorização restrita</span><span class="sxs-lookup"><span data-stu-id="6bc02-117">Configure a restrictive authorization rule</span></span>](#configure-a-restrictive-authorization-rule)

<span data-ttu-id="6bc02-118">Antes de instalar e configurar o Windows PowerShell Web Access, recomendamos que leia este guia completo, que inclui instruções sobre como instalar, proteger e desinstalar o Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="6bc02-118">Before you install and configure Windows PowerShell Web Access, we recommend that you read this entire guide, which includes instructions about how to install, secure, and uninstall Windows PowerShell Web Access.</span></span> <span data-ttu-id="6bc02-119">O [utilizar a consola do PowerShell baseada na Web do Windows](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh831417(v=ws.11)) tópico descreve a forma como os utilizadores iniciam sessão na consola baseada na web e abrange as limitações e diferenças entre a consola do Windows PowerShell baseada na web e o  **PowerShell.exe** consola.</span><span class="sxs-lookup"><span data-stu-id="6bc02-119">The [Use the Web-based Windows PowerShell Console](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh831417(v=ws.11)) topic describes how users sign in to the web-based console, and covers limitations and differences between the web-based Windows PowerShell console and the **powershell.exe** console.</span></span> <span data-ttu-id="6bc02-120">Os utilizadores finais da consola baseada na web devem ler [utilizam o Web baseado em Windows PowerShell consola](use-the-web-based-windows-powershell-console.md), mas não é necessário ler o restante deste guia.</span><span class="sxs-lookup"><span data-stu-id="6bc02-120">End users of the web-based console should read [Use the Web based Windows PowerShell Console](use-the-web-based-windows-powershell-console.md), but do not need to read the rest of this guide.</span></span>

<span data-ttu-id="6bc02-121">Este tópico fornece orientações detalhadas de operações servidor Web IIS; apenas os passos necessários para configurar o gateway do Windows PowerShell Web Access são descritos neste tópico.</span><span class="sxs-lookup"><span data-stu-id="6bc02-121">This topic does not provide in-depth IIS Web Server operations guidance; only those steps required to configure the Windows PowerShell Web Access gateway are described in this topic.</span></span> <span data-ttu-id="6bc02-122">Para mais informações sobre como configurar e proteger Web sites no IIS, consulte os recursos da documentação do IIS na secção Consulte Também.</span><span class="sxs-lookup"><span data-stu-id="6bc02-122">For more information about configuring and securing websites in IIS, see the IIS documentation resources in the See Also section.</span></span>

<span data-ttu-id="6bc02-123">O diagrama seguinte mostra como funciona o Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="6bc02-123">The following diagram shows how Windows PowerShell Web Access works.</span></span>

![Diagrama do Acesso Web do Windows PowerShell](images/Windows-PowerShell-Web-Access-diagram.jpg)

## <a name="requirements-for-running-windows-powershell-web-access"></a><span data-ttu-id="6bc02-125">Requisitos para executar o Acesso Web Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6bc02-125">Requirements for running Windows PowerShell Web Access</span></span>

<span data-ttu-id="6bc02-126">Acesso Web do Windows PowerShell requer o servidor Web (IIS), o .NET Framework 4.5 e o Windows PowerShell 3.0 ou o Windows PowerShell 4.0 em execução no servidor no qual pretende executar o gateway.</span><span class="sxs-lookup"><span data-stu-id="6bc02-126">Windows PowerShell Web Access requires Web Server (IIS), .NET Framework 4.5, and Windows PowerShell 3.0 or Windows PowerShell 4.0 to be running on the server on which you want to run the gateway.</span></span> <span data-ttu-id="6bc02-127">Pode instalar o Windows PowerShell Web Access num servidor que está a executar o Windows Server 2012 R2 ou Windows Server 2012, utilizando a adicionar funções e funcionalidades assistente no Gestor de servidores ou cmdlets de implementação do Windows PowerShell para o Gestor de servidores.</span><span class="sxs-lookup"><span data-stu-id="6bc02-127">You can install Windows PowerShell Web Access on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using either the Add Roles and Features Wizard in Server Manager, or Windows PowerShell deployment cmdlets for Server Manager.</span></span> <span data-ttu-id="6bc02-128">Quando instala o Windows PowerShell Web Access, utilizando o Gestor de servidores ou respetivos cmdlets de implementação, funções e funcionalidades necessárias são adicionadas automaticamente como parte do processo de instalação.</span><span class="sxs-lookup"><span data-stu-id="6bc02-128">When you install Windows PowerShell Web Access by using Server Manager or its deployment cmdlets, required roles and features are automatically added as part of the installation process.</span></span>

<span data-ttu-id="6bc02-129">Windows PowerShell Web Access permite aos utilizadores remotos aceder a computadores na sua organização utilizando o Windows PowerShell num navegador da web.</span><span class="sxs-lookup"><span data-stu-id="6bc02-129">Windows PowerShell Web Access allows remote users to access computers in your organization by using Windows PowerShell in a web browser.</span></span> <span data-ttu-id="6bc02-130">Embora o Windows PowerShell Web Access é uma ferramenta de gestão prática e poderosa, o acesso baseado na web tem riscos de segurança e deve ser configurado de forma mais segura possível.</span><span class="sxs-lookup"><span data-stu-id="6bc02-130">Although Windows PowerShell Web Access is a convenient and powerful management tool, the web-based access poses security risks, and should be configured as securely as possible.</span></span> <span data-ttu-id="6bc02-131">Recomendamos que os administradores que configurarem o gateway do Windows PowerShell Web Access utilizam camadas de segurança disponíveis, ambas as regras de autorização baseadas em cmdlets incluídas no Windows PowerShell Web Access e segurança camadas que estão disponíveis no servidor Web ( IIS) e aplicações de terceiros.</span><span class="sxs-lookup"><span data-stu-id="6bc02-131">We recommend that administrators who configure the Windows PowerShell Web Access gateway use available security layers, both the cmdlet-based authorization rules included with Windows PowerShell Web Access, and security layers that are available in Web Server (IIS) and third-party applications.</span></span> <span data-ttu-id="6bc02-132">Esta documentação inclui exemplos não seguros apenas recomendados para ambientes de teste e exemplos recomendados para implementações seguras.</span><span class="sxs-lookup"><span data-stu-id="6bc02-132">This documentation includes both unsecure examples that are only recommended for test environments, as well as examples that are recommended for secure deployments.</span></span>

## <a name="browser-and-client-device-support"></a><span data-ttu-id="6bc02-133">Suporte de browsers e dispositivos cliente</span><span class="sxs-lookup"><span data-stu-id="6bc02-133">Browser and client device support</span></span>

<span data-ttu-id="6bc02-134">Windows PowerShell Web Access suporta os seguintes navegadores de Internet.</span><span class="sxs-lookup"><span data-stu-id="6bc02-134">Windows PowerShell Web Access supports the following Internet browsers.</span></span> <span data-ttu-id="6bc02-135">Apesar de browsers para dispositivos móveis não serem suportados oficialmente, muitos podem ser capazes de executar a consola do Windows PowerShell baseada na web.</span><span class="sxs-lookup"><span data-stu-id="6bc02-135">Although mobile browsers are not officially supported, many may be able to run the web-based Windows PowerShell console.</span></span>
<span data-ttu-id="6bc02-136">Espera-se que outros browsers que aceitam cookies, executam JavaScript e executam Web sites HTTPS funcionem, mas são foram testados oficialmente.</span><span class="sxs-lookup"><span data-stu-id="6bc02-136">Other browsers that accept cookies, run JavaScript, and run HTTPS websites are expected to work, but are not officially tested.</span></span>

### <a name="supported-desktop-computer-browsers"></a><span data-ttu-id="6bc02-137">Browsers para computadores de secretária suportados</span><span class="sxs-lookup"><span data-stu-id="6bc02-137">Supported desktop computer browsers</span></span>

- <span data-ttu-id="6bc02-138">Windows Internet Explorer para Microsoft Windows 8.0, 9.0, 10.0 e 11.0</span><span class="sxs-lookup"><span data-stu-id="6bc02-138">Windows Internet Explorer for Microsoft Windows 8.0, 9.0, 10.0, and 11.0</span></span>
- <span data-ttu-id="6bc02-139">Mozilla Firefox 10.0.2</span><span class="sxs-lookup"><span data-stu-id="6bc02-139">Mozilla Firefox 10.0.2</span></span>
- <span data-ttu-id="6bc02-140">Google Chrome 17.0.963.56m para Windows</span><span class="sxs-lookup"><span data-stu-id="6bc02-140">Google Chrome 17.0.963.56m for Windows</span></span>
- <span data-ttu-id="6bc02-141">Apple Safari 5.1.2 para Windows</span><span class="sxs-lookup"><span data-stu-id="6bc02-141">Apple Safari 5.1.2 for Windows</span></span>
- <span data-ttu-id="6bc02-142">Apple Safari 5.1.2 para Mac OS</span><span class="sxs-lookup"><span data-stu-id="6bc02-142">Apple Safari 5.1.2 for Mac OS</span></span>

### <a name="minimally-tested-mobile-devices-or-browsers"></a><span data-ttu-id="6bc02-143">Dispositivos móveis ou browsers testados minimamente</span><span class="sxs-lookup"><span data-stu-id="6bc02-143">Minimally-tested mobile devices or browsers</span></span>

- <span data-ttu-id="6bc02-144">Windows Phone 7 e 7.5</span><span class="sxs-lookup"><span data-stu-id="6bc02-144">Windows Phone 7 and 7.5</span></span>
- <span data-ttu-id="6bc02-145">Google Android WebKit 3.1 Browser Android 2.2.1 do buildship (Kernel 2.6)</span><span class="sxs-lookup"><span data-stu-id="6bc02-145">Google Android WebKit 3.1 Browser Android 2.2.1 (Kernel 2.6)</span></span>
- <span data-ttu-id="6bc02-146">Apple Safari para sistema operativo iPhone 5.0.1</span><span class="sxs-lookup"><span data-stu-id="6bc02-146">Apple Safari for iPhone operating system 5.0.1</span></span>
- <span data-ttu-id="6bc02-147">Apple Safari para sistema de operativo iPad 2 5.0.1</span><span class="sxs-lookup"><span data-stu-id="6bc02-147">Apple Safari for iPad 2 operating system 5.0.1</span></span>

### <a name="browser-requirements"></a><span data-ttu-id="6bc02-148">Requisitos de browsers</span><span class="sxs-lookup"><span data-stu-id="6bc02-148">Browser requirements</span></span>

<span data-ttu-id="6bc02-149">Para utilizar a consola baseada na web do Windows PowerShell Web Access, os browsers tem de fazer o seguinte.</span><span class="sxs-lookup"><span data-stu-id="6bc02-149">To use the Windows PowerShell Web Access web-based console, browsers must do the following.</span></span>

- <span data-ttu-id="6bc02-150">Permita cookies do site de gateway do Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="6bc02-150">Allow cookies from the Windows PowerShell Web Access gateway website.</span></span>
- <span data-ttu-id="6bc02-151">Ser capaz de abrir e ler páginas HTTPS.</span><span class="sxs-lookup"><span data-stu-id="6bc02-151">Be able to open and read HTTPS pages.</span></span>
- <span data-ttu-id="6bc02-152">Abrir e executar Web sites que utilizem JavaScript.</span><span class="sxs-lookup"><span data-stu-id="6bc02-152">Open and run websites that use JavaScript.</span></span>

## <a name="recommended-quick-deployment"></a><span data-ttu-id="6bc02-153">Implementação rápida recomendada</span><span class="sxs-lookup"><span data-stu-id="6bc02-153">Recommended quick deployment</span></span>

<span data-ttu-id="6bc02-154">Pode instalar o gateway do Windows PowerShell Web Access num servidor que está a executar o Windows Server 2012 R2 ou Windows Server 2012, utilizando qualquer um dos cmdlets do Windows PowerShell ou com a adicionar assistente funções e funcionalidades que é aberto a partir do Gestor de servidores.</span><span class="sxs-lookup"><span data-stu-id="6bc02-154">You can install the Windows PowerShell Web Access gateway on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using either Windows PowerShell cmdlets, or by using the Add Roles and Features Wizard that is opened from within Server Manager.</span></span> <span data-ttu-id="6bc02-155">Para instalação e configuração rápidas, utilize os cmdlets do Windows PowerShell, conforme descrito nesta secção.</span><span class="sxs-lookup"><span data-stu-id="6bc02-155">For quick installation and configuration, use Windows PowerShell cmdlets, as described in this section.</span></span>

1. [<span data-ttu-id="6bc02-156">Instalar o Windows PowerShell Web Access</span><span class="sxs-lookup"><span data-stu-id="6bc02-156">Install Windows PowerShell Web Access</span></span>](#install-Windows-powershell-web-access)
1. [<span data-ttu-id="6bc02-157">Configurar o Gateway</span><span class="sxs-lookup"><span data-stu-id="6bc02-157">Configure the Gateway</span></span>](#configure-the-gateway)
1. [<span data-ttu-id="6bc02-158">Configurar uma regra de autorização restrita</span><span class="sxs-lookup"><span data-stu-id="6bc02-158">Configure a restrictive authorization rule</span></span>](#configure-a-restrictive-authorization-rule)

### <a name="install-windows-powershell-web-access-using-powershell-cmdlets"></a><span data-ttu-id="6bc02-159">Instalar o Windows PowerShell Web Access com cmdlets do PowerShell</span><span class="sxs-lookup"><span data-stu-id="6bc02-159">Install Windows PowerShell Web Access using PowerShell cmdlets</span></span>

#### <a name="to-install-windows-powershell-web-access-by-using-windows-powershell-cmdlets"></a><span data-ttu-id="6bc02-160">Para instalar o Acesso Web Windows PowerShell utilizando cmdlets do Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6bc02-160">To install Windows PowerShell Web Access by using Windows PowerShell cmdlets</span></span>

1. <span data-ttu-id="6bc02-161">Efetue um dos seguintes procedimentos para abrir uma sessão do Windows PowerShell com direitos de utilizador elevados.</span><span class="sxs-lookup"><span data-stu-id="6bc02-161">Do one of the following to open a Windows PowerShell session with elevated user rights.</span></span>

   - <span data-ttu-id="6bc02-162">No ambiente de trabalho do Windows, com o botão direito **do Windows PowerShell** na barra de tarefas e, em seguida, clique em **Executar como administrador**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-162">On the Windows desktop, right-click **Windows PowerShell** on the taskbar, and then click **Run as Administrator**.</span></span>
   - <span data-ttu-id="6bc02-163">Sobre o Windows **começar** ecrã, clique com botão direito **Windows PowerShell**e, em seguida, clique em **executar como administrador**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-163">On the Windows **Start** screen, right-click **Windows PowerShell**, and then click **Run as Administrator**.</span></span>

   > [!NOTE]
   > <span data-ttu-id="6bc02-164">No Windows PowerShell 3.0 e 4.0, não é necessário para importar o módulo de cmdlet do Gestor de servidor para a sessão do Windows PowerShell antes de executar cmdlets que fazem parte do módulo.</span><span class="sxs-lookup"><span data-stu-id="6bc02-164">In Windows PowerShell 3.0 and 4.0, there is no need to import the Server Manager cmdlet module into the Windows PowerShell session before running cmdlets that are part of the module.</span></span> <span data-ttu-id="6bc02-165">Um módulo é importado automaticamente na primeira vez que executa um cmdlet que faz parte do módulo.</span><span class="sxs-lookup"><span data-stu-id="6bc02-165">A module is automatically imported the first time you run a cmdlet that is part of the module.</span></span>
   > <span data-ttu-id="6bc02-166">Além disso, os cmdlets do Windows PowerShell não diferenciam maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="6bc02-166">Also, Windows PowerShell cmdlets are not case-sensitive.</span></span>

1. <span data-ttu-id="6bc02-167">Escreva o seguinte e, em seguida, prima **Enter**, onde *computer_name* representa um computador remoto no qual pretende instalar o Windows PowerShell Web Access, se aplicável.</span><span class="sxs-lookup"><span data-stu-id="6bc02-167">Type the following, and then press **Enter**, where *computer_name* represents a remote computer on which you want to install Windows PowerShell Web Access, if applicable.</span></span> <span data-ttu-id="6bc02-168">O parâmetro `-Restart` reinicia automaticamente os servidores de destino, se necessário.</span><span class="sxs-lookup"><span data-stu-id="6bc02-168">The `-Restart` parameter automatically restarts destination servers if required.</span></span>

   `Install-WindowsFeature -Name WindowsPowerShellWebAccess -ComputerName <computer_name> -IncludeManagementTools -Restart`

   > [!NOTE]
   > <span data-ttu-id="6bc02-169">Instalar o Windows PowerShell Web Access, utilizando cmdlets do Windows PowerShell não adicionar ferramentas de gestão de servidor Web (IIS) por predefinição.</span><span class="sxs-lookup"><span data-stu-id="6bc02-169">Installing Windows PowerShell Web Access by using Windows PowerShell cmdlets does not add Web Server (IIS) management tools by default.</span></span> <span data-ttu-id="6bc02-170">Se pretende instalar as ferramentas de gestão no mesmo servidor que o gateway do Windows PowerShell Web Access, adicione o `-IncludeManagementTools` parâmetro para o comando de instalação (conforme indicado neste passo).</span><span class="sxs-lookup"><span data-stu-id="6bc02-170">If you want to install the management tools on the same server as the Windows PowerShell Web Access gateway, add the `-IncludeManagementTools` parameter to the installation command (as provided in this step).</span></span> <span data-ttu-id="6bc02-171">Se estiver a gerir o site do Windows PowerShell Web Access num computador remoto, instale o snap-in Gestor do IIS instalando [remoto servidor administração Toolsfor Windows 8.1](https://www.microsoft.com/en-us/download/details.aspx?id=39296) ou [administração remota do servidor Ferramentas para o Windows 8](https://www.microsoft.com/en-us/download/details.aspx?id=28972) no computador do qual pretende gerir o gateway.</span><span class="sxs-lookup"><span data-stu-id="6bc02-171">If you are managing the Windows PowerShell Web Access website from a remote computer, install the IIS Manager snap-in by installing [Remote Server Administration Toolsfor Windows 8.1](https://www.microsoft.com/en-us/download/details.aspx?id=39296) or [Remote Server Administration Tools for Windows 8](https://www.microsoft.com/en-us/download/details.aspx?id=28972) on the computer from which you want to manage the gateway.</span></span>

   <span data-ttu-id="6bc02-172">Para instalar funções e funcionalidades num VHD offline, tem de adicionar o parâmetro `-ComputerName` e o parâmetro `-VHD`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-172">To install roles and features on an offline VHD, you must add both the `-ComputerName` parameter and the `-VHD` parameter.</span></span> <span data-ttu-id="6bc02-173">O parâmetro `-ComputerName` contém o nome do servidor onde pretende montar o VHD, e o parâmetro `-VHD` contém o caminho para o ficheiro VHD no servidor especificado.</span><span class="sxs-lookup"><span data-stu-id="6bc02-173">The `-ComputerName` parameter contains the name of the server on which to mount the VHD, and the `-VHD` parameter contains the path to the VHD file on the specified server.</span></span>

   `Install-WindowsFeature -Name WindowsPowerShellWebAccess -VHD <path> -ComputerName <computer_name> -IncludeManagementTools -Restart`

1. <span data-ttu-id="6bc02-174">Quando a instalação estiver concluída, certifique-se de que o Windows PowerShell Web Access foi instalado nos servidores de destino ao executar o `Get-WindowsFeature` cmdlet num servidor de destino, numa consola do Windows PowerShell que foi aberta com direitos de utilizador de elevados.</span><span class="sxs-lookup"><span data-stu-id="6bc02-174">When installation is complete, verify that Windows PowerShell Web Access was installed on destination servers by running the `Get-WindowsFeature` cmdlet on a destination server, in a Windows PowerShell console that has been opened with elevated user rights.</span></span> <span data-ttu-id="6bc02-175">Também pode verificar que o Windows PowerShell Web Access foi instalado na consola do Gestor de servidor, ao selecionar um servidor de destino no **todos os servidores** página e, em seguida, visualizar os **funções e funcionalidades** mosaico para o servidor selecionado.</span><span class="sxs-lookup"><span data-stu-id="6bc02-175">You can also verify that Windows PowerShell Web Access was installed in the Server Manager console, by selecting a destination server on the **All Servers** page, and then viewing the **Roles and Features** tile for the selected server.</span></span> <span data-ttu-id="6bc02-176">Também pode ver o ficheiro Leia-me para o Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="6bc02-176">You can also view the readme file for Windows PowerShell Web Access.</span></span>

1. <span data-ttu-id="6bc02-177">Após a instalação do Windows PowerShell Web Access, lhe for pedido para rever o ficheiro Leia-me, que contém instruções de configuração básicas e necessárias para o gateway.</span><span class="sxs-lookup"><span data-stu-id="6bc02-177">After Windows PowerShell Web Access is installed, you are prompted to review the readme file, which contains basic, required setup instructions for the gateway.</span></span> <span data-ttu-id="6bc02-178">Estas instruções de configuração também estão na seção a seguir [configurar o Gateway](#configure-the-gateway).</span><span class="sxs-lookup"><span data-stu-id="6bc02-178">These setup instructions are also in the following section, [Configure the Gateway](#configure-the-gateway).</span></span> <span data-ttu-id="6bc02-179">O caminho para o arquivo Leiame é `C:\Windows\Web\PowerShellWebAccess\wwwroot\README.txt`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-179">The path to the readme file is `C:\Windows\Web\PowerShellWebAccess\wwwroot\README.txt`.</span></span>

### <a name="configure-the-gateway"></a><span data-ttu-id="6bc02-180">Configurar o Gateway</span><span class="sxs-lookup"><span data-stu-id="6bc02-180">Configure the Gateway</span></span>

<span data-ttu-id="6bc02-181">O **Install-PswaWebApplication** cmdlet é uma forma rápida de obter o Windows PowerShell Web Access configurado.</span><span class="sxs-lookup"><span data-stu-id="6bc02-181">The **Install-PswaWebApplication** cmdlet is a quick way to get Windows PowerShell Web Access configured.</span></span> <span data-ttu-id="6bc02-182">Embora possa adicionar o parâmetro `UseTestCertificate` ao cmdlet `Install-PswaWebApplication` para instalar um certificado SSL autoassinado para efeitos de teste, não é um procedimento seguro; para um ambiente de produção seguro, utilize sempre um certificado SSL válido assinado por uma autoridade de certificação (AC).</span><span class="sxs-lookup"><span data-stu-id="6bc02-182">Although you can add the `UseTestCertificate` parameter to the `Install-PswaWebApplication` cmdlet to install a self-signed SSL certificate for test purposes, this is not secure; for a secure production environment, always use a valid SSL certificate that has been signed by a certification authority (CA).</span></span> <span data-ttu-id="6bc02-183">Os administradores podem substituir o certificado de teste por um certificado assinado à sua escolha utilizando a consola do Gestor do IIS.</span><span class="sxs-lookup"><span data-stu-id="6bc02-183">Administrators can replace the test certificate with a signed certificate of their choice by using the IIS Manager console.</span></span>

<span data-ttu-id="6bc02-184">Pode concluir a configuração de aplicação web do Windows PowerShell Web Access executando o `Install-PswaWebApplication` cmdlet ou efetuando os passos de configuração baseado na GUI no Gestor do IIS.</span><span class="sxs-lookup"><span data-stu-id="6bc02-184">You can complete Windows PowerShell Web Access web application configuration either by running the `Install-PswaWebApplication` cmdlet or by performing GUI-based configuration steps in IIS Manager.</span></span>
<span data-ttu-id="6bc02-185">Por predefinição, o cmdlet instala a aplicação web, **pswa** (e um conjunto aplicacional para o mesmo, **pswa_pool**), no **Web Site predefinido** contentor, conforme mostrado no Gestor do IIS; se assim o desejar, pode instruir o cmdlet para alterar o contentor de sites predefinido do aplicativo web.</span><span class="sxs-lookup"><span data-stu-id="6bc02-185">By default, the cmdlet installs the web application, **pswa** (and an application pool for it, **pswa_pool**), in the **Default Web Site** container, as shown in IIS Manager; if desired, you can instruct the cmdlet to change the default site container of the web application.</span></span> <span data-ttu-id="6bc02-186">O Gestor do IIS oferece opções de configuração disponíveis para aplicações Web, como alterar o número de porta ou o certificado SSL (Secure Sockets Layer).</span><span class="sxs-lookup"><span data-stu-id="6bc02-186">IIS Manager offers configuration options that are available for web applications, such as changing the port number or the Secure Sockets Layer (SSL) certificate.</span></span>

> <span data-ttu-id="6bc02-187">**![Nota de segurança](images/securitynote.jpeg) nota de segurança** é altamente recomendável que os administradores configurem o gateway para utilizar um certificado válido assinado por uma AC.</span><span class="sxs-lookup"><span data-stu-id="6bc02-187">**![Security Note](images/securitynote.jpeg) Security Note** We strongly recommend that administrators configure the gateway to use a valid certificate that has been signed by a CA.</span></span>

#### <a name="to-configure-the-windows-powershell-web-access-gateway-with-a-test-certificate-by-using-install-pswawebapplication"></a><span data-ttu-id="6bc02-188">Para configurar o gateway do Acesso Web Windows PowerShell com um certificado de teste utilizando Install-PswaWebApplication</span><span class="sxs-lookup"><span data-stu-id="6bc02-188">To configure the Windows PowerShell Web Access gateway with a test certificate by using Install-PswaWebApplication</span></span>

1. <span data-ttu-id="6bc02-189">Efetue um dos seguintes procedimentos para abrir uma sessão do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6bc02-189">Do one of the following to open a Windows PowerShell session.</span></span>

   - <span data-ttu-id="6bc02-190">Na área de trabalho Windows, clique com botão direito **Windows PowerShell** na barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="6bc02-190">On the Windows desktop, right-click **Windows PowerShell** on the taskbar.</span></span>
   - <span data-ttu-id="6bc02-191">Sobre o Windows **começar** ecrã, clique em **Windows PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-191">On the Windows **Start** screen, click **Windows PowerShell**.</span></span>

2. <span data-ttu-id="6bc02-192">Escreva o seguinte e, em seguida, prima **Enter**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-192">Type the following, and then press **Enter**.</span></span>

   `Install-PswaWebApplication -UseTestCertificate`

   > <span data-ttu-id="6bc02-193">**![Nota de segurança](images/securitynote.jpeg) nota de segurança** o `UseTestCertificate` parâmetro só deve ser utilizado num ambiente de teste privado.</span><span class="sxs-lookup"><span data-stu-id="6bc02-193">**![Security Note](images/securitynote.jpeg) Security Note** The `UseTestCertificate` parameter should only be used in a private test environment.</span></span> <span data-ttu-id="6bc02-194">Para um ambiente de produção seguro, recomendamos que utilize um certificado válido assinado por uma AC.</span><span class="sxs-lookup"><span data-stu-id="6bc02-194">For a secure production environment, we recommend using a valid certificate that has been signed by a CA.</span></span>

   <span data-ttu-id="6bc02-195">Executar o cmdlet instala a aplicação web do Windows PowerShell Web Access dentro do contentor do IIS Default Web Site.</span><span class="sxs-lookup"><span data-stu-id="6bc02-195">Running the cmdlet installs the Windows PowerShell Web Access web application within the IIS Default Web Site container.</span></span> <span data-ttu-id="6bc02-196">O cmdlet cria a infraestrutura necessária para executar o Windows PowerShell Web Access no Web site predefinido, `https://<server_name>/pswa`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-196">The cmdlet creates the infrastructure required to run Windows PowerShell Web Access on the default website, `https://<server_name>/pswa`.</span></span> <span data-ttu-id="6bc02-197">Para instalar a aplicação Web num Web site diferentes, forneça o nome do Web site adicionando o parâmetro `WebSiteName`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-197">To install the web application in a different website, provide the website name by adding the `WebSiteName` parameter.</span></span> <span data-ttu-id="6bc02-198">Para alterar o nome da aplicação Web (a predefinição é `pswa`), adicione o parâmetro `WebApplicationName`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-198">To change the name of the web application (the default is `pswa`), add the `WebApplicationName` parameter.</span></span>

   <span data-ttu-id="6bc02-199">As definições seguintes são configuradas ao executar o cmdlet.</span><span class="sxs-lookup"><span data-stu-id="6bc02-199">The following settings are configured by running the cmdlet.</span></span> <span data-ttu-id="6bc02-200">Pode alterá-las manualmente na consola do Gestor do IIS, se pretender.</span><span class="sxs-lookup"><span data-stu-id="6bc02-200">You can change these manually in the IIS Manager console, if desired.</span></span>

   - <span data-ttu-id="6bc02-201">Path: /pswa</span><span class="sxs-lookup"><span data-stu-id="6bc02-201">Path: /pswa</span></span>
   - <span data-ttu-id="6bc02-202">ApplicationPool: pswa_pool</span><span class="sxs-lookup"><span data-stu-id="6bc02-202">ApplicationPool: pswa_pool</span></span>
   - <span data-ttu-id="6bc02-203">EnabledProtocols: http</span><span class="sxs-lookup"><span data-stu-id="6bc02-203">EnabledProtocols: http</span></span>
   - <span data-ttu-id="6bc02-204">PhysicalPath: `%*windir*%/Web/PowerShellWebAccess/wwwroot`</span><span class="sxs-lookup"><span data-stu-id="6bc02-204">PhysicalPath: `%*windir*%/Web/PowerShellWebAccess/wwwroot`</span></span>

   <span data-ttu-id="6bc02-205">**Exemplo**: `Install-PswaWebApplication -webApplicationName myWebApp -useTestCertificate`</span><span class="sxs-lookup"><span data-stu-id="6bc02-205">**Example**: `Install-PswaWebApplication -webApplicationName myWebApp -useTestCertificate`</span></span>

   <span data-ttu-id="6bc02-206">Neste exemplo, o Web site resultante para o Windows PowerShell Web Access é `https://<server_name>/myWebApp`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-206">In this example, the resulting website for Windows PowerShell Web Access is `https://<server_name>/myWebApp`.</span></span>

   > [!NOTE]
   > <span data-ttu-id="6bc02-207">Não é possível iniciar sessão até que tenha sido concedido acesso ao site aos utilizadores adicionando regras de autorização.</span><span class="sxs-lookup"><span data-stu-id="6bc02-207">You cannot sign in until users have been granted access to the website by adding authorization rules.</span></span> <span data-ttu-id="6bc02-208">Para obter mais informações, consulte [configurar uma regra de autorização restrita](#configure-a-restrictive-authorization-rule) e [regras de autorização e segurança recursos do Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span><span class="sxs-lookup"><span data-stu-id="6bc02-208">For more information, see [configure a restrictive authorization rule](#configure-a-restrictive-authorization-rule) and [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

#### <a name="to-configure-the-windows-powershell-web-access-gateway-with-a-genuine-certificate-by-using-install-pswawebapplication-and-iis-manager"></a><span data-ttu-id="6bc02-209">Para configurar o gateway do Acesso Web Windows PowerShell com um certificado genuíno utilizando Install-PswaWebApplication e o Gestor do IIS</span><span class="sxs-lookup"><span data-stu-id="6bc02-209">To configure the Windows PowerShell Web Access gateway with a genuine certificate by using Install-PswaWebApplication and IIS Manager</span></span>

1. <span data-ttu-id="6bc02-210">Efetue um dos seguintes procedimentos para abrir uma sessão do Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6bc02-210">Do one of the following to open a Windows PowerShell session.</span></span>

   - <span data-ttu-id="6bc02-211">Na área de trabalho Windows, clique com botão direito **Windows PowerShell** na barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="6bc02-211">On the Windows desktop, right-click **Windows PowerShell** on the taskbar.</span></span>
   - <span data-ttu-id="6bc02-212">Sobre o Windows **começar** ecrã, clique em **Windows PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-212">On the Windows **Start** screen, click **Windows PowerShell**.</span></span>

2. <span data-ttu-id="6bc02-213">Escreva o seguinte e, em seguida, prima **Enter**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-213">Type the following, and then press **Enter**.</span></span>

   `Install-PswaWebApplication`

   <span data-ttu-id="6bc02-214">As definições de gateway seguintes são configuradas ao executar o cmdlet.</span><span class="sxs-lookup"><span data-stu-id="6bc02-214">The following gateway settings are configured by running the cmdlet.</span></span> <span data-ttu-id="6bc02-215">Pode alterá-las manualmente na consola do Gestor do IIS, se pretender.</span><span class="sxs-lookup"><span data-stu-id="6bc02-215">You can change these manually in the IIS Manager console, if desired.</span></span> <span data-ttu-id="6bc02-216">Também pode especificar valores para os parâmetros `WebsiteName` e `WebApplicationName` do cmdlet `Install-PswaWebApplication`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-216">You can also specify values for the `WebsiteName` and `WebApplicationName` parameters of the `Install-PswaWebApplication` cmdlet.</span></span>

   - <span data-ttu-id="6bc02-217">Path: /pswa</span><span class="sxs-lookup"><span data-stu-id="6bc02-217">Path: /pswa</span></span>
   - <span data-ttu-id="6bc02-218">ApplicationPool: pswa_pool</span><span class="sxs-lookup"><span data-stu-id="6bc02-218">ApplicationPool: pswa_pool</span></span>
   - <span data-ttu-id="6bc02-219">EnabledProtocols: http</span><span class="sxs-lookup"><span data-stu-id="6bc02-219">EnabledProtocols: http</span></span>
   - <span data-ttu-id="6bc02-220">PhysicalPath: `%*windir*%/Web/PowerShellWebAccess/wwwroot`</span><span class="sxs-lookup"><span data-stu-id="6bc02-220">PhysicalPath: `%*windir*%/Web/PowerShellWebAccess/wwwroot`</span></span>

3. <span data-ttu-id="6bc02-221">Abra a consola do Gestor do IIS efetuando um dos procedimentos seguintes.</span><span class="sxs-lookup"><span data-stu-id="6bc02-221">Open the IIS Manager console by doing one of the following.</span></span>

   - <span data-ttu-id="6bc02-222">Na área de trabalho Windows, inicie o Gestor de servidor clicando **Gestor de servidor** na barra de tarefas do Windows.</span><span class="sxs-lookup"><span data-stu-id="6bc02-222">On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar.</span></span> <span data-ttu-id="6bc02-223">Sobre o **ferramentas** menu no Gestor de servidores, clique em **Gestor de serviços de informação Internet (IIS)**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-223">On the **Tools** menu in Server Manager, click **Internet Information Services (IIS) Manager**.</span></span>
   - <span data-ttu-id="6bc02-224">Sobre o Windows **começar** ecrã, clique em **Gestor de servidor**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-224">On the Windows **Start** screen, click **Server Manager**.</span></span>

4. <span data-ttu-id="6bc02-225">No painel de árvore do Gerenciador do IIS, expanda o nó para o servidor no qual o Windows PowerShell Web Access está instalado até as **Sites** pasta está visível.</span><span class="sxs-lookup"><span data-stu-id="6bc02-225">In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the **Sites** folder is visible.</span></span> <span data-ttu-id="6bc02-226">Expanda a **Sites** pasta.</span><span class="sxs-lookup"><span data-stu-id="6bc02-226">Expand the **Sites** folder.</span></span>

5. <span data-ttu-id="6bc02-227">Selecione o Web site no qual instalou a aplicação web do Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="6bc02-227">Select the website in which you have installed the Windows PowerShell Web Access web application.</span></span>
   <span data-ttu-id="6bc02-228">Na **ações** painel, clique em **enlaces**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-228">In the **Actions** pane, click **Bindings**.</span></span>

6. <span data-ttu-id="6bc02-229">Na **enlace de Site** caixa de diálogo, clique em **Add**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-229">In the **Site Binding** dialog box, click **Add**.</span></span>

7. <span data-ttu-id="6bc02-230">Na **Adicionar enlace de Site** caixa de diálogo a **tipo** campo, selecione **https**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-230">In the **Add Site Binding** dialog box, in the **Type** field, select **https**.</span></span>

8. <span data-ttu-id="6bc02-231">Na **certificado SSL** campo, selecione o certificado assinado no menu pendente.</span><span class="sxs-lookup"><span data-stu-id="6bc02-231">In the **SSL certificate** field, select your signed certificate from the drop-down menu.</span></span>
   <span data-ttu-id="6bc02-232">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-232">Click **OK**.</span></span> <span data-ttu-id="6bc02-233">Ver [para configurar um certificado SSL no Gestor do IIS](#to-configure-an-ssl-certificate-in-iis-Manager) neste tópico para obter mais informações sobre como obter um certificado.</span><span class="sxs-lookup"><span data-stu-id="6bc02-233">See [To configure an SSL certificate in IIS Manager](#to-configure-an-ssl-certificate-in-iis-Manager) in this topic for more information about how to obtain a certificate.</span></span>

   <span data-ttu-id="6bc02-234">A aplicação web do Windows PowerShell Web Access está agora configurada para utilizar o seu certificado SSL assinado.</span><span class="sxs-lookup"><span data-stu-id="6bc02-234">The Windows PowerShell Web Access web application is now configured to use your signed SSL certificate.</span></span>

   <span data-ttu-id="6bc02-235">Pode acessar o Windows PowerShell Web Access abrindo `https://<server_name>/pswa` numa janela do browser.</span><span class="sxs-lookup"><span data-stu-id="6bc02-235">You can access Windows PowerShell Web Access by opening `https://<server_name>/pswa` in a browser window.</span></span>

   > [!NOTE]
   > <span data-ttu-id="6bc02-236">Não é possível iniciar sessão até que tenha sido concedido acesso ao site aos utilizadores adicionando regras de autorização.</span><span class="sxs-lookup"><span data-stu-id="6bc02-236">You cannot sign in until users have been granted access to the website by adding authorization rules.</span></span> <span data-ttu-id="6bc02-237">Para obter mais informações, consulte [configurar uma regra de autorização restrita](#configure-a-restrictive-authorization-rule), neste tópico, e [regras de autorização e segurança recursos do Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span><span class="sxs-lookup"><span data-stu-id="6bc02-237">For more information, see [Configure a restrictive authorization rule](#configure-a-restrictive-authorization-rule), in this topic, and [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

### <a name="configure-a-restrictive-authorization-rule"></a><span data-ttu-id="6bc02-238">Configurar uma regra de autorização restrita</span><span class="sxs-lookup"><span data-stu-id="6bc02-238">Configure a restrictive authorization rule</span></span>

<span data-ttu-id="6bc02-239">Após instalação do Windows PowerShell Web Access e o gateway está configurado, os utilizadores podem abrir a página de início de sessão num browser, mas não consigo iniciar sessão até que o administrador do Windows PowerShell Web Access conceda explicitamente acesso de utilizadores.</span><span class="sxs-lookup"><span data-stu-id="6bc02-239">After Windows PowerShell Web Access is installed and the gateway is configured, users can open the sign-in page in a browser, but they cannot sign in until the Windows PowerShell Web Access administrator grants users access explicitly.</span></span> <span data-ttu-id="6bc02-240">Controlo de acesso do Windows PowerShell Web Access é gerido com o conjunto de cmdlets do Windows PowerShell descritos na tabela seguinte.</span><span class="sxs-lookup"><span data-stu-id="6bc02-240">Windows PowerShell Web Access access control is managed by using the set of Windows PowerShell cmdlets described in the following table.</span></span> <span data-ttu-id="6bc02-241">Não existe nenhuma GUI comparável para adicionar ou gerir regras de autorização.</span><span class="sxs-lookup"><span data-stu-id="6bc02-241">There is no comparable GUI for adding or managing authorization rules.</span></span> <span data-ttu-id="6bc02-242">Para obter mais informações sobre os cmdlets do Windows PowerShell Web Access, consulte os tópicos de referência do cmdlet [Cmdlets do Windows PowerShell Web Access](cmdlets/web-access-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="6bc02-242">For more detailed information about Windows PowerShell Web Access cmdlets, see the cmdlet reference topics, [Windows PowerShell Web Access Cmdlets](cmdlets/web-access-cmdlets.md).</span></span>

<span data-ttu-id="6bc02-243">Para obter mais detalhes sobre regras de autorização do Windows PowerShell Web Access e a segurança, consulte [regras de autorização e segurança recursos do Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span><span class="sxs-lookup"><span data-stu-id="6bc02-243">For more detail about Windows PowerShell Web Access authorization rules and security, see [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

#### <a name="to-add-a-restrictive-authorization-rule"></a><span data-ttu-id="6bc02-244">Para adicionar uma regra de autorização restrita</span><span class="sxs-lookup"><span data-stu-id="6bc02-244">To add a restrictive authorization rule</span></span>

1. <span data-ttu-id="6bc02-245">Efetue um dos seguintes procedimentos para abrir uma sessão do Windows PowerShell com direitos de utilizador elevados.</span><span class="sxs-lookup"><span data-stu-id="6bc02-245">Do one of the following to open a Windows PowerShell session with elevated user rights.</span></span>

   - <span data-ttu-id="6bc02-246">No ambiente de trabalho do Windows, com o botão direito **do Windows PowerShell** na barra de tarefas e, em seguida, clique em **Executar como administrador**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-246">On the Windows desktop, right-click **Windows PowerShell** on the taskbar, and then click **Run as Administrator**.</span></span>
   - <span data-ttu-id="6bc02-247">Sobre o Windows **começar** ecrã, clique com botão direito **Windows PowerShell**e, em seguida, clique em **executar como administrador**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-247">On the Windows **Start** screen, right-click **Windows PowerShell**, and then click **Run as Administrator**.</span></span>

2. <span data-ttu-id="6bc02-248">Passo opcional para restringir o acesso de utilizador utilizando configurações de sessão: Certifique-se de que as configurações de sessão que pretende utilizar nas suas regras já existem.</span><span class="sxs-lookup"><span data-stu-id="6bc02-248">Optional step for restricting user access by using session configurations: Verify that session configurations that you want to use in your rules already exist.</span></span> <span data-ttu-id="6bc02-249">Se ainda não tiver sido criados, utilize as instruções para a criação de configurações de sessão no [about_Session_Configuration_Files](/powershell/module/microsoft.powershell.core/about/about_session_configurations).</span><span class="sxs-lookup"><span data-stu-id="6bc02-249">If they have not yet been created, use instructions for creating session configurations in [about_Session_Configuration_Files](/powershell/module/microsoft.powershell.core/about/about_session_configurations).</span></span>

3. <span data-ttu-id="6bc02-250">Escreva o seguinte e, em seguida, prima **Enter**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-250">Type the following, and then press **Enter**.</span></span>

   `Add-PswaAuthorizationRule -UserName <domain\user | computer\user> -ComputerName <computer_name> -ConfigurationName <session_configuration_name>`

   <span data-ttu-id="6bc02-251">Esta regra de autorização permite um acesso de utilizador específico a um computador na rede à qual tenham acesso, com acesso a uma configuração específica de sessão que tem um âmbito ao scripting típico do utilizador e às necessidades de cmdlet.</span><span class="sxs-lookup"><span data-stu-id="6bc02-251">This authorization rule allows a specific user access to one computer on the network to which they typically have access, with access to a specific session configuration that is scoped to the user's typical scripting and cmdlet needs.</span></span>

   <span data-ttu-id="6bc02-252">No exemplo seguinte, é concedido o acesso a um utilizador com o nome `JSmith` no domínio `Contoso` para gerir o computador `Contoso_214` e utilizar uma configuração de sessão com o nome `NewAdminsOnly`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-252">In the following example, a user named `JSmith` in the `Contoso` domain is granted access to manage the computer `Contoso_214`, and use a session configuration named `NewAdminsOnly`.</span></span>

   `Add-PswaAuthorizationRule -UserName Contoso\JSmith -ComputerName Contoso_214 -ConfigurationName NewAdminsOnly`

4. <span data-ttu-id="6bc02-253">Certifique-se de que a regra foi criada através da execução do `Get-PswaAuthorizationRule` cmdlet, ou `Test-PswaAuthorizationRule -UserName <domain\user> -ComputerName <computer-name>`</span><span class="sxs-lookup"><span data-stu-id="6bc02-253">Verify that the rule has been created by running either the `Get-PswaAuthorizationRule` cmdlet, or `Test-PswaAuthorizationRule -UserName <domain\user> -ComputerName <computer-name>`</span></span>

   <span data-ttu-id="6bc02-254">Por exemplo, `Test-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-254">For example, `Test-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214`.</span></span>

<span data-ttu-id="6bc02-255">Depois de ter configurado uma regra de autorização, está pronto para os utilizadores autorizados iniciar sessão na consola baseada na web e começar a utilizar o Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="6bc02-255">After you have configured an authorization rule, you are ready for authorized users to sign in to the web-based console and begin using Windows PowerShell Web Access.</span></span>

## <a name="custom-deployment"></a><span data-ttu-id="6bc02-256">Implementação personalizada</span><span class="sxs-lookup"><span data-stu-id="6bc02-256">Custom deployment</span></span>

<span data-ttu-id="6bc02-257">Pode instalar o gateway do Windows PowerShell Web Access num servidor que está a executar o Windows Server 2012 R2 ou Windows Server 2012, utilizando a adicionar assistente funções e funcionalidades no Gestor de servidores.</span><span class="sxs-lookup"><span data-stu-id="6bc02-257">You can install the Windows PowerShell Web Access gateway on a server that is running Windows Server 2012 R2 or Windows Server 2012 by using the Add Roles and Features Wizard in Server Manager.</span></span>
<span data-ttu-id="6bc02-258">Após a instalação do Windows PowerShell Web Access, pode personalizar a configuração do gateway no Gerenciador do IIS.</span><span class="sxs-lookup"><span data-stu-id="6bc02-258">After Windows PowerShell Web Access is installed, you can customize the configuration of the gateway in IIS Manager.</span></span>

### <a name="install-windows-powershell-web-access-using-the-add-roles-and-features-wizard"></a><span data-ttu-id="6bc02-259">Instalar o Windows PowerShell Web Access com o Assistente de funcionalidades e para adicionar funções</span><span class="sxs-lookup"><span data-stu-id="6bc02-259">Install Windows PowerShell Web Access using the Add Roles and Features Wizard</span></span>

1. <span data-ttu-id="6bc02-260">Se o Gestor de servidor já estiver aberto, avance para o passo seguinte.</span><span class="sxs-lookup"><span data-stu-id="6bc02-260">If Server Manager is already open, go on to the next step.</span></span> <span data-ttu-id="6bc02-261">Se o Gestor de servidor não esteja ainda aberto, abra-o efetuando um dos seguintes procedimentos.</span><span class="sxs-lookup"><span data-stu-id="6bc02-261">If Server Manager is not already open, open it by doing one of the following.</span></span>

   - <span data-ttu-id="6bc02-262">Na área de trabalho Windows, inicie o Gestor de servidor clicando **Gestor de servidor** na barra de tarefas do Windows.</span><span class="sxs-lookup"><span data-stu-id="6bc02-262">On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar.</span></span>
   - <span data-ttu-id="6bc02-263">Sobre o Windows **começar** ecrã, clique em **Gestor de servidor**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-263">On the Windows **Start** screen, click **Server Manager**.</span></span>

2. <span data-ttu-id="6bc02-264">Sobre o **Manage** menu, clique em **para adicionar funções e funcionalidades**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-264">On the **Manage** menu, click **Add Roles and Features**.</span></span>

3. <span data-ttu-id="6bc02-265">Sobre o **selecionar tipo de instalação** , selecione **instalação baseada em funções ou baseada em recursos**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-265">On the **Select installation type** page, select **Role-based or feature-based installation**.</span></span>
   <span data-ttu-id="6bc02-266">Clique em **Seguinte**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-266">Click **Next**.</span></span>

4. <span data-ttu-id="6bc02-267">Sobre o **selecionar servidor de destino** página, selecione um servidor no agrupamento de servidores ou selecione um VHD offline.</span><span class="sxs-lookup"><span data-stu-id="6bc02-267">On the **Select destination server** page, select a server from the server pool, or select an offline VHD.</span></span> <span data-ttu-id="6bc02-268">Para selecionar um VHD offline como servidor de destino, primeiro selecione o servidor em que pretende montar o VHD e, em seguida, selecione o ficheiro VHD.</span><span class="sxs-lookup"><span data-stu-id="6bc02-268">To select an offline VHD as your destination server, first select the server on which to mount the VHD, and then select the VHD file.</span></span> <span data-ttu-id="6bc02-269">Para obter informações sobre como adicionar servidores ao agrupamento de servidores, consulte a ajuda do Gestor de servidores.</span><span class="sxs-lookup"><span data-stu-id="6bc02-269">For information about how to add servers to your server pool, see the Server Manager Help.</span></span> <span data-ttu-id="6bc02-270">Depois de selecionar o servidor de destino, clique em **seguinte**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-270">After you have selected the destination server, click **Next**.</span></span>

5. <span data-ttu-id="6bc02-271">Sobre o **selecionar funcionalidades** página do assistente, expanda **Windows PowerShell**e, em seguida, selecione **Windows PowerShell Web Access**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-271">On the **Select features** page of the wizard, expand **Windows PowerShell**, and then select **Windows PowerShell Web Access**.</span></span>

6. <span data-ttu-id="6bc02-272">Tenha em atenção que lhe é pedido para adicionar funcionalidades necessárias, como o .NET Framework 4.5 e serviços de função do Servidor Web (IIS).</span><span class="sxs-lookup"><span data-stu-id="6bc02-272">Note that you are prompted to add required features, such as .NET Framework 4.5, and role services of Web Server (IIS).</span></span> <span data-ttu-id="6bc02-273">Adicione as funcionalidades necessárias e continue.</span><span class="sxs-lookup"><span data-stu-id="6bc02-273">Add required features and continue.</span></span>

   > [!NOTE]
   > <span data-ttu-id="6bc02-274">Também é instalar o Windows PowerShell Web Access, utilizando o Assistente de funcionalidades de adicionar funções e instala o servidor Web (IIS), incluindo o snap-in Gestor do IIS.</span><span class="sxs-lookup"><span data-stu-id="6bc02-274">Installing Windows PowerShell Web Access by using the Add Roles and Features Wizard also installs Web Server (IIS), including the IIS Manager snap-in.</span></span> <span data-ttu-id="6bc02-275">O snap-in e outras ferramentas de gestão do IIS são instaladas por predefinição se utilizar o Assistente Adicionar funções e funcionalidades.</span><span class="sxs-lookup"><span data-stu-id="6bc02-275">The snap-in and other IIS management tools are installed by default if you use Add Roles and Features Wizard.</span></span> <span data-ttu-id="6bc02-276">Se instalar o Windows PowerShell Web Access, utilizando cmdlets do Windows PowerShell, conforme descrito no procedimento seguinte, as ferramentas de gestão não são adicionadas por predefinição.</span><span class="sxs-lookup"><span data-stu-id="6bc02-276">If you install Windows PowerShell Web Access by using Windows PowerShell cmdlets as described in the following procedure, management tools are not added by default.</span></span>

7. <span data-ttu-id="6bc02-277">Sobre o **confirmar seleções de instalação** página, se os ficheiros de funcionalidade para Windows PowerShell Web Access não são armazenadas no servidor de destino que selecionou no passo 4, clique em **Especifica um caminho de origem alternativo**e forneça o caminho para os ficheiros de funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="6bc02-277">On the **Confirm installation selections** page, if the feature files for Windows PowerShell Web Access are not stored on the destination server that you selected in step 4, click **Specify an alternate source path**, and provide the path to the feature files.</span></span> <span data-ttu-id="6bc02-278">Caso contrário, clique em **instalar**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-278">Otherwise, click **Install**.</span></span>

8. <span data-ttu-id="6bc02-279">Depois de clicar em **instale**, o **progresso da instalação** página apresenta o progresso da instalação, os resultados e mensagens, tais como avisos, falhas ou passos de configuração de pós-instalação necessário para o Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="6bc02-279">After you click **Install**, the **Installation progress** page displays installation progress, results, and messages such as warnings, failures, or post-installation configuration steps that are required for Windows PowerShell Web Access.</span></span> <span data-ttu-id="6bc02-280">Após a instalação do Windows PowerShell Web Access, lhe for pedido para rever o ficheiro Leia-me, que contém instruções de configuração básicas e necessárias para o gateway.</span><span class="sxs-lookup"><span data-stu-id="6bc02-280">After Windows PowerShell Web Access is installed, you are prompted to review the readme file, which contains basic, required setup instructions for the gateway.</span></span> <span data-ttu-id="6bc02-281">Estas instruções também estão incluídas neste tópico.</span><span class="sxs-lookup"><span data-stu-id="6bc02-281">These instructions are also included in this topic.</span></span> <span data-ttu-id="6bc02-282">O caminho para o arquivo Leiame é `C:\Windows\Web\PowerShellWebAccess\wwwroot\README.txt`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-282">The path to the readme file is `C:\Windows\Web\PowerShellWebAccess\wwwroot\README.txt`.</span></span>

### <a name="configure-the-gateway"></a><span data-ttu-id="6bc02-283">Configurar o gateway</span><span class="sxs-lookup"><span data-stu-id="6bc02-283">Configure the gateway</span></span>

<span data-ttu-id="6bc02-284">As instruções nesta secção destinam-se instalar a aplicação web do Windows PowerShell Web Access num subdiretório e não no diretório de raiz do seu Web site.</span><span class="sxs-lookup"><span data-stu-id="6bc02-284">Instructions in this section are for installing the Windows PowerShell Web Access web application in a subdirectory and not in the root directory of your website.</span></span> <span data-ttu-id="6bc02-285">Este procedimento é o equivalente baseado na GUI das ações efetuadas pelo cmdlet `Install-PswaWebApplication`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-285">This procedure is the GUI-based equivalent of the actions performed by the `Install-PswaWebApplication` cmdlet.</span></span> <span data-ttu-id="6bc02-286">Esta secção também inclui instruções sobre como utilizar o Gestor de IIS para configurar o gateway do Windows PowerShell Web Access como um Web site de raiz.</span><span class="sxs-lookup"><span data-stu-id="6bc02-286">This section also includes instructions for how to use IIS Manager to configure the Windows PowerShell Web Access gateway as a root website.</span></span>

#### <a name="to-use-iis-manager-to-configure-the-gateway-in-an-existing-website"></a><span data-ttu-id="6bc02-287">Para utilizar o Gestor do IIS para configurar o gateway num Web site existente</span><span class="sxs-lookup"><span data-stu-id="6bc02-287">To use IIS Manager to configure the gateway in an existing website</span></span>

1. <span data-ttu-id="6bc02-288">Abra a consola do Gestor do IIS efetuando um dos procedimentos seguintes.</span><span class="sxs-lookup"><span data-stu-id="6bc02-288">Open the IIS Manager console by doing one of the following.</span></span>

   - <span data-ttu-id="6bc02-289">Na área de trabalho Windows, inicie o Gestor de servidor clicando **Gestor de servidor** na barra de tarefas do Windows.</span><span class="sxs-lookup"><span data-stu-id="6bc02-289">On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar.</span></span> <span data-ttu-id="6bc02-290">Sobre o **ferramentas** menu no Gestor de servidores, clique em **Gestor de serviços de informação Internet (IIS)**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-290">On the **Tools** menu in Server Manager, click **Internet Information Services (IIS) Manager**.</span></span>
   - <span data-ttu-id="6bc02-291">Sobre o Windows **começar** ecrã, escreva qualquer parte do nome **Gestor de serviços de informação Internet (IIS)**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-291">On the Windows **Start** screen, type any part of the name **Internet Information Services (IIS) Manager**.</span></span> <span data-ttu-id="6bc02-292">Clique no atalho será apresentado no **aplicações** resultados.</span><span class="sxs-lookup"><span data-stu-id="6bc02-292">Click the shortcut when it is displayed in the **Apps** results.</span></span>

2. <span data-ttu-id="6bc02-293">Crie um novo conjunto aplicacional para o Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="6bc02-293">Create a new application pool for Windows PowerShell Web Access.</span></span> <span data-ttu-id="6bc02-294">Expanda o nó do servidor de gateway no painel de árvore do Gerenciador do IIS, selecione **Pools de aplicativos**e clique em **adicionar conjunto aplicacional** no **ações** painel.</span><span class="sxs-lookup"><span data-stu-id="6bc02-294">Expand the node of the gateway server in the IIS Manager tree pane, select **Application Pools**, and click **Add Application Pool** in the **Actions** pane.</span></span>

3. <span data-ttu-id="6bc02-295">Adicionar um novo conjunto aplicacional com o nome **pswa_pool**, ou forneça outro nome.</span><span class="sxs-lookup"><span data-stu-id="6bc02-295">Add a new application pool with the name **pswa_pool**, or provide another name.</span></span> <span data-ttu-id="6bc02-296">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-296">Click **OK**.</span></span>

4. <span data-ttu-id="6bc02-297">No painel de árvore do Gerenciador do IIS, expanda o nó para o servidor no qual o Windows PowerShell Web Access está instalado até as **Sites** pasta está visível.</span><span class="sxs-lookup"><span data-stu-id="6bc02-297">In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the **Sites** folder is visible.</span></span> <span data-ttu-id="6bc02-298">Selecione o **Sites** pasta.</span><span class="sxs-lookup"><span data-stu-id="6bc02-298">Select the **Sites** folder.</span></span>

5. <span data-ttu-id="6bc02-299">Com o botão direito do Web site (por exemplo, **Web Site predefinido**) para que gostaria de adicionar o site do Windows PowerShell Web Access e, em seguida, clique em **Adicionar aplicação**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-299">Right-click the website (for example, **Default Web Site**) to which you would like to add the Windows PowerShell Web Access website, and then click **Add Application**.</span></span>

6. <span data-ttu-id="6bc02-300">Na **Alias** campo, escreva pswa ou forneça outro alias.</span><span class="sxs-lookup"><span data-stu-id="6bc02-300">In the **Alias** field, type pswa, or provide another alias.</span></span> <span data-ttu-id="6bc02-301">O alias torna-se o nome de diretório virtual.</span><span class="sxs-lookup"><span data-stu-id="6bc02-301">The alias becomes the virtual directory name.</span></span> <span data-ttu-id="6bc02-302">Por exemplo, **pswa** no URL seguinte representa o alias especificado neste passo: `https://<server-name>/pswa`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-302">For example, **pswa** in the following URL represents the alias specified in this step: `https://<server-name>/pswa`.</span></span>

7. <span data-ttu-id="6bc02-303">Na **conjunto aplicacional** campo, selecione o conjunto aplicacional que criou no passo 3.</span><span class="sxs-lookup"><span data-stu-id="6bc02-303">In the **Application pool** field, select the application pool that you created in step 3.</span></span>

8. <span data-ttu-id="6bc02-304">Na **caminho físico** campo, navegue para a localização do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="6bc02-304">In the **Physical path** field, browse for the location of the application.</span></span> <span data-ttu-id="6bc02-305">Pode utilizar a localização predefinida, `%windir%/Web/PowerShellWebAccess/wwwroot`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-305">You can use the default location, `%windir%/Web/PowerShellWebAccess/wwwroot`.</span></span> <span data-ttu-id="6bc02-306">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-306">Click **OK**.</span></span>

9. <span data-ttu-id="6bc02-307">Siga os passos no procedimento [para configurar um certificado SSL no Gestor de IIS](#to-configure-an-ssl-certificate-in-iis-Manager) neste tópico.</span><span class="sxs-lookup"><span data-stu-id="6bc02-307">Follow the steps in the procedure [To configure an SSL certificate in IIS manager](#to-configure-an-ssl-certificate-in-iis-Manager) in this topic.</span></span>

10. <span data-ttu-id="6bc02-308">![](images/SecurityNote.jpeg) Passo opcional de segurança:</span><span class="sxs-lookup"><span data-stu-id="6bc02-308">![](images/SecurityNote.jpeg) Optional security step:</span></span>

    <span data-ttu-id="6bc02-309">Com o site selecionado no painel de árvore, faça duplo clique em **definições de SSL** no painel de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="6bc02-309">With the website selected in the tree pane, double-click **SSL Settings** in the content pane.</span></span>
    <span data-ttu-id="6bc02-310">Selecione **exigir SSL**e, em seguida, no **ações** painel, clique em **aplicar**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-310">Select **Require SSL**, and then in the **Actions** pane, click **Apply**.</span></span> <span data-ttu-id="6bc02-311">Opcionalmente, na **definições de SSL** painel, pode exigir que os utilizadores a ligar ao site do Windows PowerShell Web Access têm certificados de cliente.</span><span class="sxs-lookup"><span data-stu-id="6bc02-311">Optionally, in the **SSL Settings** pane, you can require that users connecting to the Windows PowerShell Web Access website have client certificates.</span></span> <span data-ttu-id="6bc02-312">Os certificados de cliente ajudam a verificar a identidade de um utilizador do dispositivo cliente.</span><span class="sxs-lookup"><span data-stu-id="6bc02-312">Client certificates help to verify the identity of a client device user.</span></span> <span data-ttu-id="6bc02-313">Para obter mais informações sobre como os certificados de cliente podem aumentar a segurança do Windows PowerShell Web Access, consulte [regras de autorização e segurança recursos do Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md) neste guia.</span><span class="sxs-lookup"><span data-stu-id="6bc02-313">For more information about how requiring client certificates can increase the security of Windows PowerShell Web Access, see [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md) in this guide.</span></span>

11. <span data-ttu-id="6bc02-314">Abra uma sessão de browser num dispositivo cliente.</span><span class="sxs-lookup"><span data-stu-id="6bc02-314">Open a browser session on a client device.</span></span> <span data-ttu-id="6bc02-315">Para obter mais informações sobre dispositivos e browsers suportados, consulte [Browser e de dispositivo do cliente suportar](#browser-and-client-device-support) neste tópico.</span><span class="sxs-lookup"><span data-stu-id="6bc02-315">For more information about supported browsers and devices, see [Browser and client device support](#browser-and-client-device-support) in this topic.</span></span>

12. <span data-ttu-id="6bc02-316">Abra o novo Web site do Windows PowerShell Web Access **https://\<*nome do servidor gateway*\>/pswa**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-316">Open the new Windows PowerShell Web Access website, **https://\<*gateway-server-name*\>/pswa**.</span></span>

    <span data-ttu-id="6bc02-317">O browser deve exibir a consola início de sessão página do Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="6bc02-317">The browser should display the Windows PowerShell Web Access console sign-in page.</span></span>

    > [!NOTE]
    > <span data-ttu-id="6bc02-318">Não é possível iniciar sessão até que tenha sido concedido acesso ao site aos utilizadores adicionando regras de autorização.</span><span class="sxs-lookup"><span data-stu-id="6bc02-318">You cannot sign in until users have been granted access to the website by adding authorization rules.</span></span> <span data-ttu-id="6bc02-319">Para obter mais informações, consulte [configurar uma regra de autorização restrita](#configure-a-restrictive-authorization-rule), neste tópico, e [regras de autorização e segurança recursos do Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span><span class="sxs-lookup"><span data-stu-id="6bc02-319">For more information, see [Configure a restrictive authorization rule](#configure-a-restrictive-authorization-rule), in this topic, and [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

13. <span data-ttu-id="6bc02-320">Numa sessão do Windows PowerShell que foi aberta com direitos de utilizador elevados (executar como administrador), execute o script seguinte, no qual *nome_conjunto_aplicacional* representa o nome do conjunto aplicacional que criou no passo 3, Para conceder o conjunto aplicacional direitos de acesso ao ficheiro de autorização.</span><span class="sxs-lookup"><span data-stu-id="6bc02-320">In a Windows PowerShell session that has been opened with elevated user rights (Run as Administrator), run the following script, in which *application_pool_name* represents the name of the application pool that you created in step 3, to give the application pool access rights to the authorization file.</span></span>

    ```powershell
    $applicationPoolName = "<application_pool_name>"
    $authorizationFile = "C:\windows\web\powershellwebaccess\data\AuthorizationRules.xml"
    c:\windows\system32\icacls.exe $authorizationFile /grant ('"' + "IIS AppPool\$applicationPoolName" + '":R') > $null
    ```

    <span data-ttu-id="6bc02-321">Para ver os direitos de acesso existentes no ficheiro de autorização, execute o seguinte comando:</span><span class="sxs-lookup"><span data-stu-id="6bc02-321">To view existing access rights on the authorization file, run the following command:</span></span>

    ```powershell
    c:\windows\system32\icacls.exe $authorizationFile
    ```

#### <a name="to-use-iis-manager-to-configure-the-gateway-as-a-root-website-with-a-test-certificate"></a><span data-ttu-id="6bc02-322">Para utilizar o Gestor do IIS para configurar o gateway como um Web site de raiz com um certificado de teste</span><span class="sxs-lookup"><span data-stu-id="6bc02-322">To use IIS Manager to configure the gateway as a root website with a test certificate</span></span>

1. <span data-ttu-id="6bc02-323">Abra a consola do Gestor do IIS efetuando um dos procedimentos seguintes.</span><span class="sxs-lookup"><span data-stu-id="6bc02-323">Open the IIS Manager console by doing one of the following.</span></span>

   - <span data-ttu-id="6bc02-324">Na área de trabalho Windows, inicie o Gestor de servidor clicando **Gestor de servidor** na barra de tarefas do Windows.</span><span class="sxs-lookup"><span data-stu-id="6bc02-324">On the Windows desktop, start Server Manager by clicking **Server Manager** in the Windows taskbar.</span></span> <span data-ttu-id="6bc02-325">Sobre o **ferramentas** menu no Gestor de servidores, clique em **Gestor de serviços de informação Internet (IIS)**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-325">On the **Tools** menu in Server Manager, click **Internet Information Services (IIS) Manager**.</span></span>
   - <span data-ttu-id="6bc02-326">Sobre o Windows **começar** ecrã, escreva qualquer parte do nome **Gestor de serviços de informação Internet (IIS)**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-326">On the Windows **Start** screen, type any part of the name **Internet Information Services (IIS) Manager**.</span></span> <span data-ttu-id="6bc02-327">Clique no atalho será apresentado no **aplicações** resultados.</span><span class="sxs-lookup"><span data-stu-id="6bc02-327">Click the shortcut when it is displayed in the **Apps** results.</span></span>

1. <span data-ttu-id="6bc02-328">No painel de árvore do Gerenciador do IIS, expanda o nó para o servidor no qual o Windows PowerShell Web Access está instalado até as **Sites** pasta está visível.</span><span class="sxs-lookup"><span data-stu-id="6bc02-328">In the IIS Manager tree pane, expand the node for the server on which Windows PowerShell Web Access is installed until the **Sites** folder is visible.</span></span> <span data-ttu-id="6bc02-329">Selecione o **Sites** pasta.</span><span class="sxs-lookup"><span data-stu-id="6bc02-329">Select the **Sites** folder.</span></span>

1. <span data-ttu-id="6bc02-330">Na **ações** painel, clique em **adicionar Web site**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-330">In the **Actions** pane, click **Add Website**.</span></span>

1. <span data-ttu-id="6bc02-331">Escreva um nome para o Web site, tal como **Windows PowerShell Web Access**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-331">Type a name for the website, such as **Windows PowerShell Web Access**.</span></span>

1. <span data-ttu-id="6bc02-332">É criado automaticamente um conjunto aplicacional para o novo Web site.</span><span class="sxs-lookup"><span data-stu-id="6bc02-332">An application pool is automatically created for the new website.</span></span> <span data-ttu-id="6bc02-333">Para utilizar um conjunto aplicacional diferente, clique em **selecione** para selecionar um conjunto aplicacional para associar o novo Web site.</span><span class="sxs-lookup"><span data-stu-id="6bc02-333">To use a different application pool, click **Select** to select an application pool to associate with the new website.</span></span> <span data-ttu-id="6bc02-334">Selecione o conjunto aplicacional alternativo na **selecionar conjunto aplicacional** caixa de diálogo e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-334">Select the alternate application pool in the **Select Application Pool** dialog box, and then click **OK**.</span></span>

1. <span data-ttu-id="6bc02-335">Na **caminho físico** texto caixa, navegue até %*windir*% / Web/PowerShellWebAccess/wwwroot.</span><span class="sxs-lookup"><span data-stu-id="6bc02-335">In the **Physical path** text box, navigate to %*windir*%/Web/PowerShellWebAccess/wwwroot.</span></span>

1. <span data-ttu-id="6bc02-336">Na **tipo** campo a **enlace** área, selecione **https**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-336">In the **Type** field of the **Binding** area, select **https**.</span></span>

1. <span data-ttu-id="6bc02-337">Atribua um número de porta ao Web site que ainda não esteja a ser utilizado por outro site ou aplicação.</span><span class="sxs-lookup"><span data-stu-id="6bc02-337">Assign a port number to the website that is not already in use by another site or application.</span></span>
   <span data-ttu-id="6bc02-338">Para localizar portas abertas, pode executar o **netstat** comando numa janela de linha de comando.</span><span class="sxs-lookup"><span data-stu-id="6bc02-338">To locate open ports, you can run the **netstat** command in a Command Prompt window.</span></span> <span data-ttu-id="6bc02-339">O número de porta predefinido é 443.</span><span class="sxs-lookup"><span data-stu-id="6bc02-339">The default port number is 443.</span></span>

   <span data-ttu-id="6bc02-340">Altere a porta predefinida se outro Web site já estiver a utilizar a 443 ou se tiver outros motivos de segurança para alterar o número de porta.</span><span class="sxs-lookup"><span data-stu-id="6bc02-340">Change the default port if another website is already using 443, or if you have other security reasons for changing the port number.</span></span> <span data-ttu-id="6bc02-341">Se outro Web site que está a executar no seu servidor de gateway estiver a utilizar a porta selecionada, um aviso é apresentado quando clica **OK** no **adicionar Web site** caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="6bc02-341">If another website that is running on your gateway server is using your selected port, a warning is displayed when you click **OK** in the **Add Website** dialog box.</span></span> <span data-ttu-id="6bc02-342">Tem de utilizar uma porta não utilizada para executar o Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="6bc02-342">You must use an unused port to run Windows PowerShell Web Access.</span></span>

1. <span data-ttu-id="6bc02-343">Opcionalmente, se for necessário para a sua organização, especifique um nome de anfitrião que faça sentido para sua organização e utilizadores, tal como **`www.contoso.com`**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-343">Optionally, if needed for your organization, specify a host name that makes sense to your organization and users, such as **`www.contoso.com`**.</span></span> <span data-ttu-id="6bc02-344">Clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-344">Click **OK**.</span></span>

1. <span data-ttu-id="6bc02-345">Para um ambiente de produção mais seguro, recomendamos vivamente que forneça um certificado válido assinado por uma AC.</span><span class="sxs-lookup"><span data-stu-id="6bc02-345">For a more secure production environment, we strongly recommend providing a valid certificate that has been signed by a CA.</span></span> <span data-ttu-id="6bc02-346">Tem de fornecer um certificado SSL, uma vez que os utilizadores só podem ligar para o Windows PowerShell Web Access por meio de um Web site HTTPS.</span><span class="sxs-lookup"><span data-stu-id="6bc02-346">You must provide an SSL certificate, because users can only connect to Windows PowerShell Web Access through an HTTPS website.</span></span> <span data-ttu-id="6bc02-347">Ver [para configurar um certificado SSL no Gestor de IIS](#to-configure-an-ssl-certificate-in-iis-Manager) neste tópico para obter mais informações sobre como obter um certificado.</span><span class="sxs-lookup"><span data-stu-id="6bc02-347">See [To configure an SSL certificate in IIS manager](#to-configure-an-ssl-certificate-in-iis-Manager) in this topic for more information about how to obtain a certificate.</span></span>

1. <span data-ttu-id="6bc02-348">Clique em **OK** para fechar a **adicionar Web site** caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="6bc02-348">Click **OK** to close the **Add Website** dialog box.</span></span>

1. <span data-ttu-id="6bc02-349">Numa sessão do Windows PowerShell que foi aberta com direitos de utilizador elevados (executar como administrador), execute o script seguinte, no qual _nome_conjunto_aplicacional_ representa o nome do conjunto aplicacional que criou no passo 4, Para conceder o conjunto aplicacional direitos de acesso ao ficheiro de autorização.</span><span class="sxs-lookup"><span data-stu-id="6bc02-349">In a Windows PowerShell session that has been opened with elevated user rights (Run as Administrator), run the following script, in which _application_pool_name_ represents the name of the application pool that you created in step 4, to give the application pool access rights to the authorization file.</span></span>

   ```powershell
   $applicationPoolName = "<application_pool_name>"
   $authorizationFile = "C:\windows\web\powershellwebaccess\data\AuthorizationRules.xml"
   c:\windows\system32\icacls.exe $authorizationFile /grant ('"' + "IIS AppPool\$applicationPoolName" + '":R') > $null
   ```

   <span data-ttu-id="6bc02-350">Para ver os direitos de acesso existentes no ficheiro de autorização, execute o seguinte comando:</span><span class="sxs-lookup"><span data-stu-id="6bc02-350">To view existing access rights on the authorization file, run the following command:</span></span>

   ```powershell
   c:\windows\system32\icacls.exe $authorizationFile
   ```

1. <span data-ttu-id="6bc02-351">Com o novo site selecionado no painel de árvore do Gestor de IIS, clique em **começar** no **ações** painel para iniciar o Web site.</span><span class="sxs-lookup"><span data-stu-id="6bc02-351">With the new website selected in the IIS Manager tree pane, click **Start** in the **Actions** pane to start the website.</span></span>

1. <span data-ttu-id="6bc02-352">Abra uma sessão de browser num dispositivo cliente.</span><span class="sxs-lookup"><span data-stu-id="6bc02-352">Open a browser session on a client device.</span></span> <span data-ttu-id="6bc02-353">Para obter mais informações sobre dispositivos e browsers suportados, consulte [Browser e de dispositivo do cliente suportar](#browser-and-client-device-support) neste documento.</span><span class="sxs-lookup"><span data-stu-id="6bc02-353">For more information about supported browsers and devices, see [Browser and client device support](#browser-and-client-device-support) in this document.</span></span>

1. <span data-ttu-id="6bc02-354">Abra o novo site do Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="6bc02-354">Open the new Windows PowerShell Web Access website.</span></span>

   <span data-ttu-id="6bc02-355">Uma vez que o Web site de raiz aponta para a pasta do Windows PowerShell Web Access, o browser deverá apresentar a página de início de sessão do Windows PowerShell Web Access, quando abre `https://<gateway_server_name>`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-355">Because the root website points to the Windows PowerShell Web Access folder, the browser should display the Windows PowerShell Web Access sign-in page when you open `https://<gateway_server_name>`.</span></span> <span data-ttu-id="6bc02-356">Não é preciso adicionar **/pswa** para o URL.</span><span class="sxs-lookup"><span data-stu-id="6bc02-356">You should not need to add **/pswa** to the URL.</span></span>

   > [!NOTE]
   > <span data-ttu-id="6bc02-357">Não é possível iniciar sessão até que tenha sido concedido acesso ao site aos utilizadores adicionando regras de autorização.</span><span class="sxs-lookup"><span data-stu-id="6bc02-357">You cannot sign in until users have been granted access to the website by adding authorization rules.</span></span> <span data-ttu-id="6bc02-358">Para obter mais informações, consulte [configurar uma regra de autorização restrita](#configure-a-restrictive-authorization-rule), neste tópico, e [regras de autorização e segurança recursos do Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span><span class="sxs-lookup"><span data-stu-id="6bc02-358">For more information, see [Configure a restrictive authorization rule](#configure-a-restrictive-authorization-rule), in this topic, and [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

### <a name="configuring-a-restrictive-authorization-rule"></a><span data-ttu-id="6bc02-359">Configurar uma regra de autorização restrita</span><span class="sxs-lookup"><span data-stu-id="6bc02-359">Configuring a restrictive authorization rule</span></span>

<span data-ttu-id="6bc02-360">Após instalação do Windows PowerShell Web Access e o gateway está configurado, os utilizadores podem abrir a página de início de sessão num browser, mas não consigo iniciar sessão até que o administrador do Windows PowerShell Web Access conceda explicitamente acesso de utilizadores.</span><span class="sxs-lookup"><span data-stu-id="6bc02-360">After Windows PowerShell Web Access is installed and the gateway is configured, users can open the sign-in page in a browser, but they cannot sign in until the Windows PowerShell Web Access administrator grants users access explicitly.</span></span> <span data-ttu-id="6bc02-361">Controlo de acesso do Windows PowerShell Web Access é gerido com o conjunto de cmdlets do Windows PowerShell descritos na tabela seguinte.</span><span class="sxs-lookup"><span data-stu-id="6bc02-361">Windows PowerShell Web Access access control is managed by using the set of Windows PowerShell cmdlets described in the following table.</span></span> <span data-ttu-id="6bc02-362">Não existe nenhuma GUI comparável para adicionar ou gerir regras de autorização.</span><span class="sxs-lookup"><span data-stu-id="6bc02-362">There is no comparable GUI for adding or managing authorization rules.</span></span> <span data-ttu-id="6bc02-363">Para obter mais informações sobre os cmdlets do Windows PowerShell Web Access, consulte os tópicos de referência do cmdlet [Cmdlets do Windows PowerShell Web Access](cmdlets/web-access-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="6bc02-363">For more detailed information about Windows PowerShell Web Access cmdlets, see the cmdlet reference topics, [Windows PowerShell Web Access Cmdlets](cmdlets/web-access-cmdlets.md).</span></span>

<span data-ttu-id="6bc02-364">Para obter mais detalhes sobre regras de autorização do Windows PowerShell Web Access e a segurança, consulte [regras de autorização e segurança recursos do Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span><span class="sxs-lookup"><span data-stu-id="6bc02-364">For more detail about Windows PowerShell Web Access authorization rules and security, see [Authorization Rules and Security Features of Windows PowerShell Web Access](authorization-rules-and-security-features-of-windows-powershell-web-access.md).</span></span>

#### <a name="adding-a-restrictive-authorization-rule"></a><span data-ttu-id="6bc02-365">Adicionar uma regra de autorização restrita</span><span class="sxs-lookup"><span data-stu-id="6bc02-365">Adding a restrictive authorization rule</span></span>

1. <span data-ttu-id="6bc02-366">Efetue um dos seguintes procedimentos para abrir uma sessão do Windows PowerShell com direitos de utilizador elevados.</span><span class="sxs-lookup"><span data-stu-id="6bc02-366">Do one of the following to open a Windows PowerShell session with elevated user rights.</span></span>

   - <span data-ttu-id="6bc02-367">No ambiente de trabalho do Windows, com o botão direito **do Windows PowerShell** na barra de tarefas e, em seguida, clique em **Executar como administrador**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-367">On the Windows desktop, right-click **Windows PowerShell** on the taskbar, and then click **Run as Administrator**.</span></span>
   - <span data-ttu-id="6bc02-368">Sobre o Windows **começar** ecrã, clique com botão direito **Windows PowerShell**e, em seguida, clique em **executar como administrador**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-368">On the Windows **Start** screen, right-click **Windows PowerShell**, and then click **Run as Administrator**.</span></span>

1. ![Nota de segurança](images/SecurityNote.jpeg) <span data-ttu-id="6bc02-370">Passo opcional para restringir o acesso de utilizador utilizando configurações de sessão:</span><span class="sxs-lookup"><span data-stu-id="6bc02-370">Optional step for restricting user access by using session configurations:</span></span>

   <span data-ttu-id="6bc02-371">Certifique-se de que as configurações de sessão que pretende utilizar nas suas regras já existem.</span><span class="sxs-lookup"><span data-stu-id="6bc02-371">Verify that session configurations that you want to use in your rules already exist.</span></span> <span data-ttu-id="6bc02-372">Se ainda não tiver sido criados, utilize as instruções para a criação de configurações de sessão no [about_Session_Configuration_Files](/powershell/module/microsoft.powershell.core/about/about_session_configurations).</span><span class="sxs-lookup"><span data-stu-id="6bc02-372">If they have not yet been created, use instructions for creating session configurations in [about_Session_Configuration_Files](/powershell/module/microsoft.powershell.core/about/about_session_configurations).</span></span>

1. <span data-ttu-id="6bc02-373">Escreva o seguinte e, em seguida, prima **Enter**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-373">Type the following, and then press **Enter**.</span></span>

   `Add-PswaAuthorizationRule -UserName <domain\user | computer\user> -ComputerName <computer_name> -ConfigurationName <session_configuration_name>`

   <span data-ttu-id="6bc02-374">Esta regra de autorização permite um acesso de utilizador específico a um computador na rede para os quais normalmente tenham acesso, com acesso a uma configuração específica de sessão que tem um âmbito para o utilizador '™ necessidades de criação de scripts e o cmdlet típicas no s.</span><span class="sxs-lookup"><span data-stu-id="6bc02-374">This authorization rule allows a specific user access to one computer on the network to which they typically have access, with access to a specific session configuration that is scoped to the user'™s typical scripting and cmdlet needs.</span></span>

   <span data-ttu-id="6bc02-375">No exemplo seguinte, é concedido o acesso a um utilizador com o nome `JSmith` no domínio `Contoso` para gerir o computador `Contoso_214` e utilizar uma configuração de sessão com o nome `NewAdminsOnly`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-375">In the following example, a user named `JSmith` in the `Contoso` domain is granted access to manage the computer `Contoso_214`, and use a session configuration named `NewAdminsOnly`.</span></span>

   `Add-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214 -ConfigurationName NewAdminsOnly`

1. <span data-ttu-id="6bc02-376">Certifique-se de que a regra foi criada através da execução de `Get-PswaAuthorizationRule` cmdlet, ou `Test-PswaAuthorizationRule -UserName '<domain\user>' -ComputerName <computer-name>`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-376">Verify that the rule has been created by running either the `Get-PswaAuthorizationRule` cmdlet, or `Test-PswaAuthorizationRule -UserName '<domain\user>' -ComputerName <computer-name>`.</span></span>

   <span data-ttu-id="6bc02-377">Por exemplo, `Test-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-377">For example, `Test-PswaAuthorizationRule -UserName 'Contoso\JSmith' -ComputerName Contoso_214`.</span></span>

   <span data-ttu-id="6bc02-378">Depois de ter configurado uma regra de autorização, está pronto para os utilizadores autorizados iniciar sessão na consola baseada na web e começar a utilizar o Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="6bc02-378">After you have configured an authorization rule, you are ready for authorized users to sign in to the web-based console and begin using Windows PowerShell Web Access.</span></span>

## <a name="configure-a-genuine-certificate"></a><span data-ttu-id="6bc02-379">Configurar um certificado genuíno</span><span class="sxs-lookup"><span data-stu-id="6bc02-379">Configure a genuine certificate</span></span>

<span data-ttu-id="6bc02-380">Num ambiente de produção seguro, utilize sempre um certificado SSL válido assinado por uma autoridade de certificação (AC).</span><span class="sxs-lookup"><span data-stu-id="6bc02-380">For a secure production environment, always use a valid SSL certificate that has been signed by a certification authority (CA).</span></span> <span data-ttu-id="6bc02-381">O procedimento nesta secção descreve como obter e aplicar um certificado SSL válido a partir de uma AC.</span><span class="sxs-lookup"><span data-stu-id="6bc02-381">The procedure in this section describes how to obtain and apply a valid SSL certificate from a CA.</span></span>

### <a name="to-configure-an-ssl-certificate-in-iis-manager"></a><span data-ttu-id="6bc02-382">Para configurar um certificado SSL no Gestor do IIS</span><span class="sxs-lookup"><span data-stu-id="6bc02-382">To configure an SSL certificate in IIS Manager</span></span>

1. <span data-ttu-id="6bc02-383">No painel de árvore do Gerenciador do IIS, selecione o servidor no qual está instalado o Windows PowerShell Web Access.</span><span class="sxs-lookup"><span data-stu-id="6bc02-383">In the IIS Manager tree pane, select the server on which Windows PowerShell Web Access is installed.</span></span>

1. <span data-ttu-id="6bc02-384">No painel de conteúdo, faça duplo clique **certificados de servidor**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-384">In the content pane, double click **Server Certificates**.</span></span>

1. <span data-ttu-id="6bc02-385">Na **ações** painel, efetue um dos seguintes procedimentos.</span><span class="sxs-lookup"><span data-stu-id="6bc02-385">In the **Actions** pane, do one of the following.</span></span> <span data-ttu-id="6bc02-386">Para obter mais informações sobre como configurar certificados de servidor no IIS, consulte [configurar certificados de servidor no IIS 7](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc732230(v=ws.10)).</span><span class="sxs-lookup"><span data-stu-id="6bc02-386">For more information about configuring server certificates in IIS, see [Configuring Server Certificates in IIS 7](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc732230(v=ws.10)).</span></span>

   - <span data-ttu-id="6bc02-387">Clique em **importar** para importar um certificado válido existente a partir de uma localização na sua rede.</span><span class="sxs-lookup"><span data-stu-id="6bc02-387">Click **Import** to import an existing, valid certificate from a location on your network.</span></span>
   - <span data-ttu-id="6bc02-388">Clique em **criar pedido de certificado** para pedir um certificado a partir de uma AC, tal como [VeriSign](http://www.verisign.com/), [Thawte](https://www.thawte.com/), ou [GeoTrust](https://www.geotrust.com/).</span><span class="sxs-lookup"><span data-stu-id="6bc02-388">Click **Create Certificate Request** to request a certificate from a CA such as [VeriSign](http://www.verisign.com/), [Thawte](https://www.thawte.com/), or [GeoTrust](https://www.geotrust.com/).</span></span> <span data-ttu-id="6bc02-389">O nome comum do certificado tem de corresponder ao cabeçalho do anfitrião no pedido.</span><span class="sxs-lookup"><span data-stu-id="6bc02-389">The certificate's common name must match the host header in the request.</span></span>

     <span data-ttu-id="6bc02-390">Por exemplo, se o browser cliente pedir `http://www.contoso.com/`, em seguida, o nome comum também tem de ser `http://www.contoso.com/`.</span><span class="sxs-lookup"><span data-stu-id="6bc02-390">For example, if the client browser requests `http://www.contoso.com/`, then the common name must also be `http://www.contoso.com/`.</span></span> <span data-ttu-id="6bc02-391">Esta é a opção mais segura e recomendada para fornecer o gateway do Windows PowerShell Web Access com um certificado.</span><span class="sxs-lookup"><span data-stu-id="6bc02-391">This is the most secure and recommended option for providing the Windows PowerShell Web Access gateway with a certificate.</span></span>

   - <span data-ttu-id="6bc02-392">Clique em **criar um certificado autoassinado** para criar um certificado que pode utilizar imediatamente e ser assinado mais tarde por uma AC se assim o desejar.</span><span class="sxs-lookup"><span data-stu-id="6bc02-392">Click **Create a Self-Signed Certificate** to create a certificate that you can use immediately, and have signed later by a CA if desired.</span></span> <span data-ttu-id="6bc02-393">Especifique um nome amigável para o certificado autoassinado, tal como **Windows PowerShell Web Access**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-393">Specify a friendly name for the self-signed certificate, such as **Windows PowerShell Web Access**.</span></span> <span data-ttu-id="6bc02-394">Esta opção não é considerada segura e é recomendada apenas para um ambiente de teste privado.</span><span class="sxs-lookup"><span data-stu-id="6bc02-394">This option is not considered secure, and is recommended only for a private test environment.</span></span>

1. <span data-ttu-id="6bc02-395">Depois de criar ou obter um certificado, selecione o Web site ao qual o certificado é aplicado (por exemplo, **Web Site predefinido**) no Gerenciador do IIS painel de árvore e, em seguida, clique em **enlaces** no **Ações** painel.</span><span class="sxs-lookup"><span data-stu-id="6bc02-395">After creating or obtaining a certificate, select the website to which the certificate is applied (for example, **Default Web Site**) in the IIS Manager tree pane, and then click **Bindings** in the **Actions** pane.</span></span>

1. <span data-ttu-id="6bc02-396">Na **Adicionar enlace de Site** caixa de diálogo caixa, adicione um **https** de enlace para o site, se um não estiver em exibição.</span><span class="sxs-lookup"><span data-stu-id="6bc02-396">In the **Add Site Binding** dialog box, add an **https** binding for the site, if one is not already displayed.</span></span> <span data-ttu-id="6bc02-397">Se não estiver a utilizar um certificado autoassinado, especifique o nome de anfitrião a partir do passo 3 deste procedimento.</span><span class="sxs-lookup"><span data-stu-id="6bc02-397">If you are not using a self-signed certificate, specify the host name from step 3 of this procedure.</span></span> <span data-ttu-id="6bc02-398">Se estiver a utilizar um certificado autoassinado, este passo não é necessário.</span><span class="sxs-lookup"><span data-stu-id="6bc02-398">If you are using a self-signed certificate, this step is not required.</span></span>

1. <span data-ttu-id="6bc02-399">Selecione o certificado obtido ou criado no passo 3 deste procedimento e, em seguida, clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="6bc02-399">Select the certificate that you obtained or created in step 3 of this procedure, and then click **OK**.</span></span>

## <a name="using-the-web-based-windows-powershell-console"></a><span data-ttu-id="6bc02-400">Utilizar a consola do Windows PowerShell baseada na Web</span><span class="sxs-lookup"><span data-stu-id="6bc02-400">Using the web-based Windows PowerShell console</span></span>

<span data-ttu-id="6bc02-401">Após instalação do Windows PowerShell Web Access e a configuração do gateway está concluída conforme descrito neste tópico, está pronta a utilizar a consola do Windows PowerShell baseada na web.</span><span class="sxs-lookup"><span data-stu-id="6bc02-401">After Windows PowerShell Web Access is installed and the gateway configuration is finished as described in this topic, the Windows PowerShell web-based console is ready to use.</span></span> <span data-ttu-id="6bc02-402">Para obter mais informações sobre como obter a utilizar na consola baseada na web, consulte [utilizar a consola do PowerShell baseada na Web do Windows](use-the-web-based-windows-powershell-console.md).</span><span class="sxs-lookup"><span data-stu-id="6bc02-402">For more information about getting started in the web-based console, see [Use the Web-based Windows PowerShell Console](use-the-web-based-windows-powershell-console.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="6bc02-403">Consulte Também</span><span class="sxs-lookup"><span data-stu-id="6bc02-403">See Also</span></span>

<span data-ttu-id="6bc02-404">[Serviços de informação Internet (IIS) 7.0 documentação](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753433(v=ws.10))</span><span class="sxs-lookup"><span data-stu-id="6bc02-404">[Internet Information Services (IIS) 7.0 Documentation](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753433(v=ws.10))</span></span>

<span data-ttu-id="6bc02-405">[Ajuda do IIS Manager 7.0](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc732664(v=ws.11))</span><span class="sxs-lookup"><span data-stu-id="6bc02-405">[IIS Manager 7.0 Help](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc732664(v=ws.11))</span></span>

<span data-ttu-id="6bc02-406">[Configurar a segurança do servidor Web (IIS 7)](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731278(v=ws.10))</span><span class="sxs-lookup"><span data-stu-id="6bc02-406">[Configure Web Server Security (IIS 7)](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731278(v=ws.10))</span></span>

<span data-ttu-id="6bc02-407">[Recursos de implantação de IPsec](/previous-versions/windows/it-pro/windows-server-2003/cc776369(v=ws.10))</span><span class="sxs-lookup"><span data-stu-id="6bc02-407">[IPsec Deployment Resources](/previous-versions/windows/it-pro/windows-server-2003/cc776369(v=ws.10))</span></span>
