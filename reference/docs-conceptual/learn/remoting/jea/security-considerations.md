---
ms.date: 07/10/2019
keywords: Jea, PowerShell, segurança
title: Considerações de segurança do JEA
ms.openlocfilehash: befc24fec368c4f6d60477daf63bf17e9431133e
ms.sourcegitcommit: e894ed833cef57967cdaf002f8c883f66864e836
ms.translationtype: MT
ms.contentlocale: pt-PT
ms.lasthandoff: 08/25/2019
ms.locfileid: "70017910"
---
# <a name="jea-security-considerations"></a><span data-ttu-id="c8e6e-103">Considerações de segurança do JEA</span><span class="sxs-lookup"><span data-stu-id="c8e6e-103">JEA Security Considerations</span></span>

<span data-ttu-id="c8e6e-104">O JEA ajuda a melhorar sua postura de segurança, reduzindo o número de administradores permanentes em seus computadores.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-104">JEA helps you improve your security posture by reducing the number of permanent administrators on your machines.</span></span> <span data-ttu-id="c8e6e-105">O JEA usa uma configuração de sessão do PowerShell para criar um novo ponto de entrada para os usuários gerenciarem o sistema.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-105">JEA uses a PowerShell session configuration to create a new entry point for users to manage the system.</span></span> <span data-ttu-id="c8e6e-106">Os usuários que precisam de acesso elevado, mas não ilimitado, ao computador para realizar tarefas administrativas podem receber acesso ao ponto de extremidade JEA.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-106">Users who need elevated, but not unlimited, access to the machine to do administrative tasks can be granted access to the JEA endpoint.</span></span> <span data-ttu-id="c8e6e-107">Como o JEA permite que esses usuários executem comandos de administrador sem ter acesso de administrador completo, você pode remover esses usuários de grupos de segurança altamente privilegiados.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-107">Since JEA allows these users to run admin commands without having full admin access, you can then remove those users from highly privileged security groups.</span></span>

## <a name="run-as-account"></a><span data-ttu-id="c8e6e-108">Conta Executar como</span><span class="sxs-lookup"><span data-stu-id="c8e6e-108">Run-As account</span></span>

<span data-ttu-id="c8e6e-109">Cada ponto de extremidade JEA tem uma conta **Executar como** designada.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-109">Each JEA endpoint has a designated **run-as** account.</span></span> <span data-ttu-id="c8e6e-110">Essa é a conta sob a qual as ações do usuário que está se conectando são executadas.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-110">This is the account under which the connecting user's actions are executed.</span></span> <span data-ttu-id="c8e6e-111">Essa conta é configurável no [arquivo de configuração de sessão](session-configurations.md)e a conta escolhida tem uma influência significativa sobre a segurança de seu ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-111">This account is configurable in the [session configuration file](session-configurations.md), and the account you choose has a significant bearing on the security of your endpoint.</span></span>

<span data-ttu-id="c8e6e-112">As **contas virtuais** são a maneira recomendada de configurar a conta **Executar como** .</span><span class="sxs-lookup"><span data-stu-id="c8e6e-112">**Virtual accounts** are the recommended way of configuring the **run-as** account.</span></span> <span data-ttu-id="c8e6e-113">As contas virtuais são contas locais temporárias única que são criadas para o usuário que está se conectando para uso durante a sua sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-113">Virtual accounts are one-time, temporary local accounts that are created for the connecting user to use during the duration of their JEA session.</span></span> <span data-ttu-id="c8e6e-114">Assim que sua sessão é encerrada, a conta virtual é destruída e não pode mais ser usada.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-114">As soon as their session is terminated, the virtual account is destroyed and can't be used anymore.</span></span> <span data-ttu-id="c8e6e-115">O usuário que está se conectando não conhece as credenciais da conta virtual.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-115">The connecting user doesn't know the credentials for the virtual account.</span></span> <span data-ttu-id="c8e6e-116">A conta virtual não pode ser usada para acessar o sistema por meio de outros meios como Área de Trabalho Remota ou um ponto de extremidade do PowerShell irrestrito.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-116">The virtual account can't be used to access the system via other means like Remote Desktop or an unconstrained PowerShell endpoint.</span></span>

<span data-ttu-id="c8e6e-117">Por padrão, as contas virtuais pertencem ao grupo local de **Administradores** no computador.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-117">By default, virtual accounts belong to the local **Administrators** group on the machine.</span></span> <span data-ttu-id="c8e6e-118">Isso concede a eles direitos totais para gerenciar qualquer coisa no sistema, mas não há direitos para gerenciar recursos na rede.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-118">This gives them full rights to manage anything on the system, but no rights to manage resources on the network.</span></span>
<span data-ttu-id="c8e6e-119">Ao autenticar com outros computadores, o contexto do usuário é o da conta do computador local, não a conta virtual.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-119">When authenticating with other machines, the user context is that of the local computer account, not the virtual account.</span></span>

<span data-ttu-id="c8e6e-120">Os controladores de domínio são um caso especial, pois não há um grupo local de **Administradores** .</span><span class="sxs-lookup"><span data-stu-id="c8e6e-120">Domain controllers are a special case since there isn't a local **Administrators** group.</span></span> <span data-ttu-id="c8e6e-121">Em vez disso, as contas virtuais pertencem a **Administradores de domínio** e podem gerenciar os serviços de diretório no controlador de domínio.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-121">Instead, virtual accounts belong to **Domain Admins** and can manage the directory services on the domain controller.</span></span> <span data-ttu-id="c8e6e-122">A identidade do domínio ainda é restrita para uso no controlador de domínio em que a sessão JEA foi instanciada.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-122">The domain identity is still restricted for use on the domain controller where the JEA session was instantiated.</span></span> <span data-ttu-id="c8e6e-123">Qualquer acesso à rede parece vir do objeto de computador do controlador de domínio.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-123">Any network access appears to come from the domain controller computer object instead.</span></span>

<span data-ttu-id="c8e6e-124">Em ambos os casos, você pode definir explicitamente a quais grupos de segurança a conta virtual pertence.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-124">In both cases, you may explicitly define which security groups the virtual account belongs to.</span></span> <span data-ttu-id="c8e6e-125">Essa é uma boa prática quando a tarefa pode ser feita sem privilégios locais ou de administrador de domínio.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-125">This is a good practice when the task can be done without local or domain admin privileges.</span></span> <span data-ttu-id="c8e6e-126">Se você já tiver um grupo de segurança definido para seus administradores, conceda a associação de conta virtual a esse grupo.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-126">If you already have a security group defined for your admins, grant the virtual account membership to that group.</span></span> <span data-ttu-id="c8e6e-127">A associação ao grupo de contas virtuais é limitada a grupos de segurança locais em servidores de estação de trabalho e membros.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-127">Virtual account group membership is limited to local security groups on workstation and member servers.</span></span> <span data-ttu-id="c8e6e-128">Em controladores de domínio, as contas virtuais devem ser membros de grupos de segurança de domínio.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-128">On domain controllers, virtual accounts must be members of domain security groups.</span></span>
<span data-ttu-id="c8e6e-129">Depois que a conta virtual tiver sido adicionada a um ou mais grupos de segurança, ela não pertencerá mais aos grupos padrão (administradores locais ou de domínio).</span><span class="sxs-lookup"><span data-stu-id="c8e6e-129">Once the virtual account has been added to one or more security groups, it no longer belongs to the default groups (local or domain admins).</span></span>

<span data-ttu-id="c8e6e-130">A tabela a seguir resume as possíveis opções de configuração e as permissões resultantes para contas virtuais:</span><span class="sxs-lookup"><span data-stu-id="c8e6e-130">The following table summarizes the possible configuration options and resulting permissions for virtual accounts:</span></span>

|        <span data-ttu-id="c8e6e-131">Tipo de computador</span><span class="sxs-lookup"><span data-stu-id="c8e6e-131">Computer type</span></span>         | <span data-ttu-id="c8e6e-132">Configuração do grupo de contas virtuais</span><span class="sxs-lookup"><span data-stu-id="c8e6e-132">Virtual account group configuration</span></span> |                   <span data-ttu-id="c8e6e-133">Contexto de usuário local</span><span class="sxs-lookup"><span data-stu-id="c8e6e-133">Local user context</span></span>                    | <span data-ttu-id="c8e6e-134">Contexto de usuário de rede</span><span class="sxs-lookup"><span data-stu-id="c8e6e-134">Network user context</span></span> |
| ---------------------------- | ----------------------------------- | ------------------------------------------------------- | -------------------- |
| <span data-ttu-id="c8e6e-135">Controlador de domínio</span><span class="sxs-lookup"><span data-stu-id="c8e6e-135">Domain controller</span></span>            | <span data-ttu-id="c8e6e-136">Predefinido</span><span class="sxs-lookup"><span data-stu-id="c8e6e-136">Default</span></span>                             | <span data-ttu-id="c8e6e-137">Usuário de domínio, membro de '*domínio*\Domain admins '</span><span class="sxs-lookup"><span data-stu-id="c8e6e-137">Domain user, member of '*DOMAIN*\Domain Admins'</span></span>         | <span data-ttu-id="c8e6e-138">Conta de computador</span><span class="sxs-lookup"><span data-stu-id="c8e6e-138">Computer account</span></span>     |
| <span data-ttu-id="c8e6e-139">Controlador de domínio</span><span class="sxs-lookup"><span data-stu-id="c8e6e-139">Domain controller</span></span>            | <span data-ttu-id="c8e6e-140">Grupos de domínio A e B</span><span class="sxs-lookup"><span data-stu-id="c8e6e-140">Domain groups A and B</span></span>               | <span data-ttu-id="c8e6e-141">Usuário de domínio, membro de '*domínio*\a ', '*domínio*\b '</span><span class="sxs-lookup"><span data-stu-id="c8e6e-141">Domain user, member of '*DOMAIN*\A', '*DOMAIN*\B'</span></span>       | <span data-ttu-id="c8e6e-142">Conta de computador</span><span class="sxs-lookup"><span data-stu-id="c8e6e-142">Computer account</span></span>     |
| <span data-ttu-id="c8e6e-143">Servidor membro ou estação de trabalho</span><span class="sxs-lookup"><span data-stu-id="c8e6e-143">Member server or workstation</span></span> | <span data-ttu-id="c8e6e-144">Predefinido</span><span class="sxs-lookup"><span data-stu-id="c8e6e-144">Default</span></span>                             | <span data-ttu-id="c8e6e-145">Usuário local, membro de '*BuiltIn*\Administrators '</span><span class="sxs-lookup"><span data-stu-id="c8e6e-145">Local user, member of '*BUILTIN*\Administrators'</span></span>        | <span data-ttu-id="c8e6e-146">Conta de computador</span><span class="sxs-lookup"><span data-stu-id="c8e6e-146">Computer account</span></span>     |
| <span data-ttu-id="c8e6e-147">Servidor membro ou estação de trabalho</span><span class="sxs-lookup"><span data-stu-id="c8e6e-147">Member server or workstation</span></span> | <span data-ttu-id="c8e6e-148">Grupos locais C e D</span><span class="sxs-lookup"><span data-stu-id="c8e6e-148">Local groups C and D</span></span>                | <span data-ttu-id="c8e6e-149">Usuário local, membro de '*computador*\c ' e '*computador*\d '</span><span class="sxs-lookup"><span data-stu-id="c8e6e-149">Local user, member of '*COMPUTER*\C' and '*COMPUTER*\D'</span></span> | <span data-ttu-id="c8e6e-150">Conta de computador</span><span class="sxs-lookup"><span data-stu-id="c8e6e-150">Computer account</span></span>     |

<span data-ttu-id="c8e6e-151">Ao examinar os eventos de auditoria de segurança e os logs de eventos do aplicativo, você verá que cada sessão de usuário do JEA tem uma conta virtual exclusiva.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-151">When you look at security audit events and application event logs, you see that each JEA user session has a unique virtual account.</span></span> <span data-ttu-id="c8e6e-152">Essa conta exclusiva ajuda a rastrear ações do usuário em um ponto de extremidade JEA de volta para o usuário original que executou o comando.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-152">This unique account helps you track user actions in a JEA endpoint back to the original user who ran the command.</span></span> <span data-ttu-id="c8e6e-153">Nomes de conta virtual seguem o `WinRM Virtual Users\WinRM_VA_<ACCOUNTNUMBER>_<DOMAIN>_<sAMAccountName>` formato por exemplo, se o usuário **Alice** no domínio **contoso** reinicia um serviço em um ponto de extremidade Jea, o nome de usuário associado a qualquer evento `WinRM Virtual Users\WinRM_VA_1_contoso_alice`do Gerenciador de controle de serviço seria.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-153">Virtual account names follow the format `WinRM Virtual Users\WinRM_VA_<ACCOUNTNUMBER>_<DOMAIN>_<sAMAccountName>` For example, if user **Alice** in domain **Contoso** restarts a service in a JEA endpoint, the username associated with any service control manager events would be `WinRM Virtual Users\WinRM_VA_1_contoso_alice`.</span></span>

<span data-ttu-id="c8e6e-154">**As contas de serviço gerenciado por grupo (gMSAs)** são úteis quando um servidor membro precisa ter acesso aos recursos de rede na sessão Jea.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-154">**Group-managed service accounts (gMSAs)** are useful when a member server needs to have access to network resources in the JEA session.</span></span> <span data-ttu-id="c8e6e-155">Por exemplo, quando um ponto de extremidade JEA é usado para controlar o acesso a um serviço de API REST hospedado em um computador diferente.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-155">For example, when a JEA endpoint is used to control access to a REST API service hosted on a different machine.</span></span> <span data-ttu-id="c8e6e-156">É fácil escrever funções para invocar as APIs REST, mas você precisa de uma identidade de rede para autenticar com a API.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-156">It's easy to write functions to invoke the REST APIs, but you need a network identity to authenticate with the API.</span></span> <span data-ttu-id="c8e6e-157">O uso de uma conta de serviço gerenciado por grupo torna o segundo salto possível, mantendo o controle sobre quais computadores podem usar a conta.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-157">Using a group-managed service account makes the second hop possible while maintaining control over which computers can use the account.</span></span> <span data-ttu-id="c8e6e-158">As permissões efetivas do gMSA são definidas pelos grupos de segurança (local ou domínio) aos quais a conta gMSA pertence.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-158">The effective permissions of the gMSA are defined by the security groups (local or domain) to which the gMSA account belongs.</span></span>

<span data-ttu-id="c8e6e-159">Quando um ponto de extremidade JEA é configurado para usar um gMSA, as ações de todos os usuários do JEA parecem vir do mesmo gMSA.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-159">When a JEA endpoint is configured to use a gMSA, the actions of all JEA users appear to come from the same gMSA.</span></span> <span data-ttu-id="c8e6e-160">A única maneira de rastrear ações de volta para um usuário específico é identificar o conjunto de comandos executados em uma transcrição de sessão do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-160">The only way to trace actions back to a specific user is to identify the set of commands run in a PowerShell session transcript.</span></span>

<span data-ttu-id="c8e6e-161">**As credenciais pass-thru** são usadas quando você não especifica uma conta **Executar como** .</span><span class="sxs-lookup"><span data-stu-id="c8e6e-161">**Pass-thru credentials** are used when you don't specify a **run-as** account.</span></span> <span data-ttu-id="c8e6e-162">O PowerShell usa a credencial do usuário que está se conectando para executar comandos no servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-162">PowerShell uses the connecting user's credential to run commands on the remote server.</span></span> <span data-ttu-id="c8e6e-163">Isso exige que você conceda ao usuário que está se conectando acesso direto a grupos de gerenciamento privilegiado.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-163">This requires you to grant the connecting user direct access to privileged management groups.</span></span> <span data-ttu-id="c8e6e-164">Essa configuração **não** é recomendada para Jea.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-164">This configuration is **not** recommended for JEA.</span></span> <span data-ttu-id="c8e6e-165">Se o usuário que está se conectando já tiver privilégios de administrador, ele poderá evitar JEA e gerenciar o sistema por meio de outros meios não restringidos.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-165">If the connecting user already has admin privileges, they can avoid JEA and manage the system via other, unconstrained means.</span></span> <span data-ttu-id="c8e6e-166">Para obter mais informações, consulte a seção abaixo sobre como o [Jea não protege contra administradores](#jea-doesnt-protect-against-admins).</span><span class="sxs-lookup"><span data-stu-id="c8e6e-166">For more information, see the section below on how [JEA doesn't protect against admins](#jea-doesnt-protect-against-admins).</span></span>

<span data-ttu-id="c8e6e-167">As **contas Executar como padrão** permitem que você especifique qualquer conta de usuário na qual a sessão inteira do PowerShell seja executada.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-167">**Standard run-as accounts** allow you to specify any user account under which the entire PowerShell session runs.</span></span> <span data-ttu-id="c8e6e-168">As configurações de sessão **que usam contas Executar como** fixas `-RunAsCredential` (com o parâmetro) não reconhecem o Jea.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-168">Session configurations using fixed **run-as** accounts (with the `-RunAsCredential` parameter) aren't JEA-aware.</span></span> <span data-ttu-id="c8e6e-169">As definições de função não funcionam mais conforme o esperado.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-169">Role definitions no longer function as expected.</span></span> <span data-ttu-id="c8e6e-170">Cada usuário autorizado a acessar o ponto de extremidade recebe a mesma função.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-170">Every user authorized to access the endpoint is assigned the same role.</span></span>

<span data-ttu-id="c8e6e-171">Você não deve usar um **RunAsCredential** em um ponto de extremidade Jea porque é difícil rastrear ações de volta para usuários específicos e não tem suporte para mapear usuários para funções.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-171">You shouldn't use a **RunAsCredential** on a JEA endpoint because it's difficult to trace actions back to specific users and lacks support for mapping users to roles.</span></span>

## <a name="winrm-endpoint-acl"></a><span data-ttu-id="c8e6e-172">ACL de ponto de extremidade WinRM</span><span class="sxs-lookup"><span data-stu-id="c8e6e-172">WinRM Endpoint ACL</span></span>

<span data-ttu-id="c8e6e-173">Assim como acontece com os pontos de extremidade de comunicação remota do PowerShell, cada JEA Endpoint tem uma lista de controle de acesso (ACL) separada que controla quem pode autenticar com o ponto de extremidade JEA.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-173">As with regular PowerShell remoting endpoints, each JEA endpoint has a separate access control list (ACL) that controls who can authenticate with the JEA endpoint.</span></span> <span data-ttu-id="c8e6e-174">Se estiverem configurados incorretamente, os usuários confiáveis não poderão acessar o ponto de extremidade JEA e os usuários não confiáveis poderão ter acesso.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-174">If improperly configured, trusted users may not be able to access the JEA endpoint and untrusted users may have access.</span></span> <span data-ttu-id="c8e6e-175">A ACL do WinRM não afeta o mapeamento de usuários para as funções JEA.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-175">The WinRM ACL doesn't affect the mapping of users to JEA roles.</span></span> <span data-ttu-id="c8e6e-176">O mapeamento é controlado pelo campo **RoleDefinitions** no arquivo de configuração de sessão usado para registrar o ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-176">Mapping is controlled by the **RoleDefinitions** field in the session configuration file used to register the endpoint.</span></span>

<span data-ttu-id="c8e6e-177">Por padrão, quando um ponto de extremidade JEA tem vários recursos de função, a ACL do WinRM é configurada para permitir o acesso a todos os usuários mapeados.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-177">By default, when a JEA endpoint has multiple role capabilities, the WinRM ACL is configured to allow access to all mapped users.</span></span> <span data-ttu-id="c8e6e-178">Por exemplo, uma sessão Jea configurada usando os comandos a seguir concede `CONTOSO\JEA_Lev1` acesso `CONTOSO\JEA_Lev2`completo ao e ao.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-178">For example, a JEA session configured using the following commands grants full access to `CONTOSO\JEA_Lev1` and `CONTOSO\JEA_Lev2`.</span></span>

```powershell
$roles = @{ 'CONTOSO\JEA_Lev1' = 'Lev1Role'; 'CONTOSO\JEA_Lev2' = 'Lev2Role' }
New-PSSessionConfigurationFile -Path '.\jea.pssc' -SessionType RestrictedRemoteServer -RoleDefinitions $roles -RunAsVirtualAccount
Register-PSSessionConfiguration -Path '.\jea.pssc' -Name 'MyJEAEndpoint'
```

<span data-ttu-id="c8e6e-179">Você pode auditar permissões de usuário com o cmdlet [Get-PSSessionConfiguration](/powershell/module/microsoft.powershell.core/get-pssessionconfiguration) .</span><span class="sxs-lookup"><span data-stu-id="c8e6e-179">You can audit user permissions with the [Get-PSSessionConfiguration](/powershell/module/microsoft.powershell.core/get-pssessionconfiguration) cmdlet.</span></span>

```powershell
Get-PSSessionConfiguration -Name 'MyJEAEndpoint' | Select-Object Permission
```

```Output
Permission
----------
CONTOSO\JEA_Lev1 AccessAllowed
CONTOSO\JEA_Lev2 AccessAllowed
```

<span data-ttu-id="c8e6e-180">Para alterar quais usuários têm acesso, execute `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` um prompt interativo ou `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` para atualizar as permissões.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-180">To change which users have access, run either `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -ShowSecurityDescriptorUI` for an interactive prompt or `Set-PSSessionConfiguration -Name 'MyJEAEndpoint' -SecurityDescriptorSddl <SDDL string>` to update the permissions.</span></span> <span data-ttu-id="c8e6e-181">Os usuários precisam de pelo menos direitos de invocação para acessar o ponto de extremidade Jea.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-181">Users need at least *Invoke* rights to access the JEA endpoint.</span></span>

<span data-ttu-id="c8e6e-182">É possível criar um ponto de extremidade JEA que não mapeie uma função definida para cada usuário que tenha acesso.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-182">It's possible to create a JEA endpoint that doesn't map a defined role to every user that has access.</span></span> <span data-ttu-id="c8e6e-183">Esses usuários podem iniciar uma sessão JEA, mas só têm acesso aos cmdlets padrão.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-183">These users can start a JEA session, but only have access to the default cmdlets.</span></span> <span data-ttu-id="c8e6e-184">Você pode auditar permissões de usuário em um ponto de `Get-PSSessionCapability`extremidade Jea executando.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-184">You can audit user permissions in a JEA endpoint by running `Get-PSSessionCapability`.</span></span> <span data-ttu-id="c8e6e-185">Para obter mais informações, consulte [auditoria e relatórios em Jea](audit-and-report.md).</span><span class="sxs-lookup"><span data-stu-id="c8e6e-185">For more information, see [Auditing and Reporting on JEA](audit-and-report.md).</span></span>

## <a name="least-privilege-roles"></a><span data-ttu-id="c8e6e-186">Funções de privilégios mínimos</span><span class="sxs-lookup"><span data-stu-id="c8e6e-186">Least privilege roles</span></span>

<span data-ttu-id="c8e6e-187">Ao criar funções JEA, é importante lembrar que as contas de serviço gerenciadas por grupos e virtuais em execução nos bastidores podem ter acesso irrestrito ao computador local.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-187">When designing JEA roles, it's important to remember that the virtual and group-managed service accounts running behind the scenes can have unrestricted access to the local machine.</span></span> <span data-ttu-id="c8e6e-188">Os recursos de função JEA ajudam a limitar os comandos e os aplicativos que podem ser executados nesse contexto privilegiado.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-188">JEA role capabilities help limit the commands and applications that can be run in that privileged context.</span></span>
<span data-ttu-id="c8e6e-189">Funções criadas incorretamente podem permitir comandos perigosos que podem permitir que um usuário interrompa os limites do JEA ou obtenha acesso a informações confidenciais.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-189">Improperly designed roles can allow dangerous commands that may permit a user to break out of the JEA boundaries or obtain access to sensitive information.</span></span>

<span data-ttu-id="c8e6e-190">Por exemplo, considere a seguinte entrada de capacidade de função:</span><span class="sxs-lookup"><span data-stu-id="c8e6e-190">For example, consider the following role capability entry:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\*-Process'
}
```

<span data-ttu-id="c8e6e-191">Essa capacidade de função permite que os usuários executem qualquer cmdlet do PowerShell com o **processo** substantivo do módulo **Microsoft. PowerShell. Management** .</span><span class="sxs-lookup"><span data-stu-id="c8e6e-191">This role capability allows users to run any PowerShell cmdlet with the noun **Process** from the **Microsoft.PowerShell.Management** module.</span></span> <span data-ttu-id="c8e6e-192">Os usuários podem precisar acessar cmdlets como `Get-Process` para ver quais aplicativos estão sendo executados no sistema e `Stop-Process` para eliminar aplicativos que não estão respondendo.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-192">Users may need to access cmdlets like `Get-Process` to see what applications are running on the system and `Stop-Process` to kill applications that aren't responding.</span></span> <span data-ttu-id="c8e6e-193">No entanto, essa entrada `Start-Process`também permite, que pode ser usada para iniciar um programa arbitrário com permissões totais de administrador.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-193">However, this entry also allows `Start-Process`, which can be used to start up an arbitrary program with full administrator permissions.</span></span> <span data-ttu-id="c8e6e-194">O programa não precisa ser instalado localmente no sistema.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-194">The program doesn't need to be installed locally on the system.</span></span> <span data-ttu-id="c8e6e-195">Um usuário conectado pode iniciar um programa de um compartilhamento de arquivos que dá aos privilégios de administrador local do usuário, executa malware e muito mais.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-195">A connected user could start a program from a file share that gives the user local admin privileges, runs malware, and more.</span></span>

<span data-ttu-id="c8e6e-196">Uma versão mais segura desse mesmo recurso de função teria a seguinte aparência:</span><span class="sxs-lookup"><span data-stu-id="c8e6e-196">A more secure version of this same role capability would look like:</span></span>

```powershell
@{
    VisibleCmdlets = 'Microsoft.PowerShell.Management\Get-Process', 'Microsoft.PowerShell.Management\Stop-Process'
}
```

<span data-ttu-id="c8e6e-197">Evite usar curingas em recursos de função.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-197">Avoid using wildcards in role capabilities.</span></span> <span data-ttu-id="c8e6e-198">Certifique-se de [auditar regularmente as permissões de usuário efetivas](audit-and-report.md#check-effective-rights-for-a-specific-user) para entender quais comandos são acessíveis ao usuário.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-198">Be sure to regularly [audit effective user permissions](audit-and-report.md#check-effective-rights-for-a-specific-user) to understand which commands are accessible to the user.</span></span>

## <a name="jea-doesnt-protect-against-admins"></a><span data-ttu-id="c8e6e-199">O JEA não protege contra administradores</span><span class="sxs-lookup"><span data-stu-id="c8e6e-199">JEA doesn't protect against admins</span></span>

<span data-ttu-id="c8e6e-200">Um dos principais princípios do JEA é que ele permite que não-administradores realizem algumas tarefas de administração.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-200">One of the core principles of JEA is that it allows non-admins to do some admin tasks.</span></span> <span data-ttu-id="c8e6e-201">O JEA não protege contra usuários que já têm privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-201">JEA doesn't protect against users who already have administrator privileges.</span></span> <span data-ttu-id="c8e6e-202">Os usuários que pertencem a **Administradores de domínio**, **Administradores**locais ou outros grupos altamente privilegiados podem burlar as proteções do Jea por meio de outros meios.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-202">Users who belong **Domain Admins**, local **Administrators**, or other highly privileged groups can circumvent JEA's protections via another means.</span></span> <span data-ttu-id="c8e6e-203">Por exemplo, eles podiam entrar com o RDP, usar consoles do MMC remotos ou conectar-se a pontos de extremidade do PowerShell não restringidos.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-203">For example, they could sign in with RDP, use remote MMC consoles, or connect to unconstrained PowerShell endpoints.</span></span> <span data-ttu-id="c8e6e-204">Além disso, os administradores locais em um sistema podem modificar as configurações de JEA para permitir usuários adicionais ou alterar uma capacidade de função para estender o escopo do que um usuário pode fazer em sua sessão JEA.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-204">Also, local admins on a system can modify JEA configurations to allow additional users or change a role capability to extend the scope of what a user can do in their JEA session.</span></span> <span data-ttu-id="c8e6e-205">É importante avaliar as permissões estendidas de seus usuários do JEA para ver se há outras maneiras de obter acesso privilegiado ao sistema.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-205">It's important to evaluate your JEA users' extended permissions to see if there are other ways to gain privileged access to the system.</span></span>

<span data-ttu-id="c8e6e-206">Uma prática comum é usar o JEA para manutenção regular do dia a dia e ter uma solução de gerenciamento de acesso privilegiado just-in-time que permite que os usuários se tornem temporariamente administradores locais em situações de emergência.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-206">A common practice is to use JEA for regular day-to-day maintenance and have a just-in-time, privileged access management solution that allows users to temporarily become local admins in emergency situations.</span></span> <span data-ttu-id="c8e6e-207">Isso ajuda a garantir que os usuários não sejam administradores permanentes no sistema, mas podem obter esses direitos se, e somente quando, eles concluírem um fluxo de trabalho que documenta o uso dessas permissões.</span><span class="sxs-lookup"><span data-stu-id="c8e6e-207">This helps ensure users aren't permanent admins on the system, but can get those rights if, and only when, they complete a workflow that documents their use of those permissions.</span></span>
